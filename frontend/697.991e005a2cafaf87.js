"use strict";(self.webpackChunksuluhi_admin_frontend=self.webpackChunksuluhi_admin_frontend||[]).push([[697],{697:(et,Z,s)=>{s.r(Z),s.d(Z,{LoansModule:()=>tt});var c=s(6895),d=s(8869),r=s(4006),h=s(4333),T=s(1213),v=s(8796),t=s(4650),C=s(2340),b=s(529);let A=(()=>{class n{constructor(e){this.http=e,this.apiUrl=`${C.N.apiUrl}loans`}createLoan(e){return this.http.post(this.apiUrl,e)}getLoan(e){return this.http.get(`${this.apiUrl}/${e}`)}updateLoan(e,o){return this.http.put(`${this.apiUrl}/${e}`,o)}deleteLoan(e){return this.http.delete(`${this.apiUrl}/${e}`)}getAllLoans(e,o,a){const l={currentPage:e,pageSize:o,...a};return this.http.get(this.apiUrl,{params:l})}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(b.eN))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var q=s(583),L=s(8057);function U(n,i){if(1&n&&(t.ynx(0),t.TgZ(1,"div",30),t._UZ(2,"app-error-occured",31),t.qZA(),t.BQk()),2&n){const e=t.oxw();t.xp6(2),t.Q6J("errorMessage",e.errorMessage)}}function I(n,i){if(1&n&&(t.ynx(0),t.TgZ(1,"ng-option",35),t._uU(2),t.qZA(),t.BQk()),2&n){const e=i.$implicit;t.xp6(1),t.Q6J("value",e._id),t.xp6(1),t.AsE(" ",e.firstName," ",e.lastName," ")}}function y(n,i){if(1&n&&(t.ynx(0),t.TgZ(1,"ng-select",32)(2,"ng-option",33),t._uU(3,"Search Customer"),t.qZA(),t.YNc(4,I,3,3,"ng-container",34),t.qZA(),t.BQk()),2&n){const e=t.oxw(2);t.xp6(4),t.Q6J("ngForOf",e.clients.results)}}function F(n,i){1&n&&(t.TgZ(0,"div",36),t._uU(1," Customer is required. "),t.qZA())}function E(n,i){if(1&n&&(t.ynx(0),t.TgZ(1,"div",6)(2,"div"),t.YNc(3,y,5,1,"ng-container",0),t.qZA(),t.YNc(4,F,2,0,"div",16),t.qZA(),t.BQk()),2&n){const e=t.oxw();let o;t.xp6(3),t.Q6J("ngIf",e.clients&&e.clients.results.length),t.xp6(1),t.Q6J("ngIf",(null==(o=e.loanForm.get("customerid"))?null:o.invalid)&&(null==(o=e.loanForm.get("customerid"))?null:o.touched))}}function N(n,i){1&n&&(t.TgZ(0,"div",36),t._uU(1," Loan Provider is required. "),t.qZA())}function D(n,i){if(1&n&&(t.ynx(0),t.TgZ(1,"div",6),t._UZ(2,"input",37),t.YNc(3,N,2,0,"div",16),t.qZA(),t.BQk()),2&n){const e=t.oxw();let o;t.xp6(3),t.Q6J("ngIf",(null==(o=e.loanForm.get("recipient"))?null:o.invalid)&&(null==(o=e.loanForm.get("recipient"))?null:o.touched))}}function k(n,i){1&n&&(t.TgZ(0,"div",36),t._uU(1," Amount is required. "),t.qZA())}function J(n,i){1&n&&(t.TgZ(0,"div",36),t._uU(1," Interest Rate is required. "),t.qZA())}function Q(n,i){1&n&&(t.TgZ(0,"div",36),t._uU(1," Company Name is required. "),t.qZA())}function Y(n,i){1&n&&(t.TgZ(0,"div",36),t._uU(1," Department is required. "),t.qZA())}function M(n,i){1&n&&(t.TgZ(0,"div",36),t._uU(1," Description is required. "),t.qZA())}function S(n,i){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"button",38),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.deleteLoan())}),t._uU(2,"Delete Loan"),t.qZA(),t.TgZ(3,"button",39),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.updateLoan())}),t._uU(4,"Edit Loan"),t.qZA(),t.BQk()}if(2&n){const e=t.oxw();t.xp6(3),t.Q6J("disabled",e.loanForm.invalid)}}function O(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"button",40),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.addLoan())}),t._uU(1,"Add Loan"),t.qZA()}if(2&n){const e=t.oxw();t.Q6J("disabled",e.loanForm.invalid)}}let x=(()=>{class n{constructor(e,o,a,l,u){this.formBuilder=e,this.router=o,this.loanService=a,this.clientService=l,this.route=u,this.title="Add Loan",this.submiting=!1,this.loading=!1,this.loadingclients=!1}ngOnInit(){this.loadClients({}),this.loanForm=this.formBuilder.group({customerid:["",r.kI.required],recipient:["",r.kI.required],amount:["",r.kI.required],interestRate:["",r.kI.required],customerordirect:["customer"],startDate:[""],endDate:[""],loanstatus:["approved"],description:[""]}),this.loanId=this.route.snapshot.paramMap.get("id"),this.loanId?(this.title="Edit Loans",this.getLoan(this.loanId),this.loanForm.get("customerordirect")?.disable()):this.checkIfCustomer()}getLoan(e){this.loading=!0,this.loanService.getLoan(e).subscribe({next:o=>{const a=new Date(o.startDate).toISOString().substring(0,10),l=new Date(o.endDate).toISOString().substring(0,10);o.startDate=a,o.endDate=l,this.loanForm.patchValue(o),this.checkIfCustomer()},error:o=>{this.errorMessage=o,this.loading=!1},complete:()=>{this.loading=!1}})}addLoan(){this.loanForm.valid&&(this.submiting=!0,this.loanService.createLoan(this.loanForm.value).subscribe({next:o=>{this.loanForm.reset(),this.router.navigate(["/accounts/loans"])},error:o=>{this.errorMessage=o,this.submiting=!1},complete:()=>{this.submiting=!1}}))}updateLoan(){const e=this.loanForm.value;this.submiting=!0,this.loanService.updateLoan(this.loanId,e).subscribe({next:o=>{this.router.navigate(["/accounts/loans"])},error:o=>{this.errorMessage=o,this.submiting=!1},complete:()=>{this.submiting=!1}})}deleteLoan(){this.submiting=!0,this.loanService.deleteLoan(this.loanId).subscribe({next:e=>{this.router.navigate(["/accounts/loans"])},error:e=>{this.errorMessage=e,this.submiting=!1},complete:()=>{this.submiting=!1}})}loadClients(e){this.loadingclients=!0,this.clientService.getAllClientSuppliers(1,100,e).subscribe({next:o=>{this.clients=o},error:o=>{this.errorMessage=o,this.loadingclients=!1},complete:()=>{this.loadingclients=!1}})}checkIfCustomer(){const e=this.loanForm.get("customerordirect")?.value;"customer"===e?(this.loanForm.removeControl("recipient"),this.loanForm.addControl("customerid",this.formBuilder.control("",r.kI.required))):"recipient"===e&&(this.loanForm.removeControl("customerid"),this.loanForm.addControl("recipient",this.formBuilder.control("",r.kI.required)))}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(r.qu),t.Y36(d.F0),t.Y36(A),t.Y36(q.y),t.Y36(d.gz))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-add-edit-loans"]],decls:67,vars:12,consts:[[4,"ngIf"],[1,"my-4",3,"formGroup"],[1,"d-flex"],[1,"flex-grow-1"],[1,"fw-normal"],["routerLink","/accounts/loans",1,"btn","btn-outline-secondary","btn-sm"],[1,"mb-3"],[1,"form-check","form-check-inline"],["type","radio","formControlName","customerordirect","id","inlineRadio3","value","customer",1,"form-check-input",3,"change"],["for","inlineRadio3",1,"form-check-label"],["type","radio","formControlName","customerordirect","id","inlineRadio5","value","recipient",1,"form-check-input",3,"change"],["for","inlineRadio5",1,"form-check-label"],[1,"row"],[1,"col-lg-6"],["for","title",1,"form-label"],["type","number","id","title","formControlName","amount","placeholder","Enter Amount",1,"form-control"],["class","sul-error",4,"ngIf"],["type","number","id","title","formControlName","interestRate","placeholder","Enter Interest Rate",1,"form-control"],["type","date","id","title","formControlName","startDate",1,"form-control"],["type","date","id","title","formControlName","endDate",1,"form-control"],["for","projectlink",1,"form-label"],["aria-label","Default select example","formControlName","loanstatus",1,"form-select"],["value","pending"],["value","approved"],["value","rejected"],["value","paid"],["for","description",1,"form-label"],["id","description","formControlName","description","placeholder","Enter Description",1,"form-control"],[4,"ngIf","ngIfElse"],["adding",""],[1,"py-3"],[3,"errorMessage"],["formControlName","customerid"],["value","","disabled",""],[4,"ngFor","ngForOf"],[3,"value"],[1,"sul-error"],["type","text","id","title","formControlName","recipient","placeholder","Enter Loan Provider",1,"form-control"],["type","submit",1,"btn","btn-danger","btn-sm","me-2",3,"click"],["type","submit",1,"btn","btn-primary","btn-sm",3,"disabled","click"],["type","submit",1,"btn","btn-success","btn-sm",3,"disabled","click"]],template:function(e,o){if(1&e&&(t.TgZ(0,"div"),t.YNc(1,U,3,1,"ng-container",0),t.TgZ(2,"form",1)(3,"div",2)(4,"div",3)(5,"h2",4),t._uU(6),t.qZA()(),t.TgZ(7,"div")(8,"button",5),t._uU(9," List Loans"),t.qZA()()(),t.TgZ(10,"div",6)(11,"div",7)(12,"input",8),t.NdJ("change",function(){return o.checkIfCustomer()}),t.qZA(),t.TgZ(13,"label",9),t._uU(14,"Customer"),t.qZA()(),t.TgZ(15,"div",7)(16,"input",10),t.NdJ("change",function(){return o.checkIfCustomer()}),t.qZA(),t.TgZ(17,"label",11),t._uU(18,"Provider"),t.qZA()()(),t.YNc(19,E,5,2,"ng-container",0),t.YNc(20,D,4,1,"ng-container",0),t.TgZ(21,"div",12)(22,"div",13)(23,"div",6)(24,"label",14),t._uU(25,"Amount"),t.qZA(),t._UZ(26,"input",15),t.YNc(27,k,2,0,"div",16),t.qZA()(),t.TgZ(28,"div",13)(29,"div",6)(30,"label",14),t._uU(31,"Interest Rate"),t.qZA(),t._UZ(32,"input",17),t.YNc(33,J,2,0,"div",16),t.qZA()()(),t.TgZ(34,"div",12)(35,"div",13)(36,"div",6)(37,"label",14),t._uU(38,"Issue Date"),t.qZA(),t._UZ(39,"input",18),t.YNc(40,Q,2,0,"div",16),t.qZA()(),t.TgZ(41,"div",13)(42,"div",6)(43,"label",14),t._uU(44,"Due Date"),t.qZA(),t._UZ(45,"input",19),t.YNc(46,Y,2,0,"div",16),t.qZA()()(),t.TgZ(47,"div",6)(48,"label",20),t._uU(49,"Loan Status"),t.qZA(),t.TgZ(50,"select",21)(51,"option",22),t._uU(52,"Pending"),t.qZA(),t.TgZ(53,"option",23),t._uU(54,"Approved"),t.qZA(),t.TgZ(55,"option",24),t._uU(56,"Rejected"),t.qZA(),t.TgZ(57,"option",25),t._uU(58,"Paid"),t.qZA()()(),t.TgZ(59,"div",6)(60,"label",26),t._uU(61,"Description"),t.qZA(),t._UZ(62,"textarea",27),t.YNc(63,M,2,0,"div",16),t.qZA(),t.YNc(64,S,5,1,"ng-container",28),t.YNc(65,O,2,1,"ng-template",null,29,t.W1O),t.qZA()()),2&e){const a=t.MAs(66);let l,u,m,p,g,_,f;t.xp6(1),t.Q6J("ngIf",o.errorMessage),t.xp6(1),t.Q6J("formGroup",o.loanForm),t.xp6(4),t.Oqu(o.title),t.xp6(13),t.Q6J("ngIf","customer"===(null==(l=o.loanForm.get("customerordirect"))?null:l.value)),t.xp6(1),t.Q6J("ngIf","recipient"===(null==(u=o.loanForm.get("customerordirect"))?null:u.value)),t.xp6(7),t.Q6J("ngIf",(null==(m=o.loanForm.get("amount"))?null:m.invalid)&&(null==(m=o.loanForm.get("amount"))?null:m.touched)),t.xp6(6),t.Q6J("ngIf",(null==(p=o.loanForm.get("interestRate"))?null:p.invalid)&&(null==(p=o.loanForm.get("interestRate"))?null:p.touched)),t.xp6(7),t.Q6J("ngIf",(null==(g=o.loanForm.get("startDate"))?null:g.invalid)&&(null==(g=o.loanForm.get("startDate"))?null:g.touched)),t.xp6(6),t.Q6J("ngIf",(null==(_=o.loanForm.get("endDate"))?null:_.invalid)&&(null==(_=o.loanForm.get("endDate"))?null:_.touched)),t.xp6(17),t.Q6J("ngIf",(null==(f=o.loanForm.get("description"))?null:f.invalid)&&(null==(f=o.loanForm.get("description"))?null:f.touched)),t.xp6(1),t.Q6J("ngIf",o.loanId)("ngIfElse",a)}},dependencies:[c.sg,c.O5,r._Y,r.YN,r.Kr,r.Fj,r.wV,r.EJ,r._,r.JJ,r.JL,r.sg,r.u,L.A,v.w9,v.jq,d.rH]}),n})();var w=s(7997),B=s(5511),P=s(295);function R(n,i){1&n&&(t.ynx(0),t.TgZ(1,"div",8),t._UZ(2,"app-sul-loader"),t.qZA(),t.BQk())}function j(n,i){if(1&n&&(t.ynx(0),t.TgZ(1,"div",8),t._UZ(2,"app-error-occured",10),t.qZA(),t.BQk()),2&n){const e=t.oxw(2);t.xp6(2),t.Q6J("errorMessage",e.errorMessage)}}const $=function(n){return["edit",n]};function z(n,i){if(1&n&&(t.ynx(0),t.TgZ(1,"tr",18)(2,"td"),t._uU(3),t.qZA(),t.TgZ(4,"td"),t._uU(5),t.ALo(6,"currency"),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.qZA(),t.TgZ(9,"td"),t._uU(10),t.ALo(11,"date"),t.qZA(),t.TgZ(12,"td"),t._uU(13),t.ALo(14,"date"),t.qZA(),t.TgZ(15,"td",19),t._uU(16),t.qZA()(),t.BQk()),2&n){const e=i.$implicit,o=i.index;t.xp6(1),t.Q6J("routerLink",t.VKq(14,$,e._id)),t.xp6(2),t.Oqu(o+1),t.xp6(2),t.Oqu(t.xi3(6,7,e.amount,"ksh. ")),t.xp6(3),t.hij("",e.interestRate,"% "),t.xp6(2),t.Oqu(t.lcZ(11,10,e.startDate)),t.xp6(3),t.Oqu(t.lcZ(14,12,e.endDate)),t.xp6(3),t.Oqu(e.loanstatus)}}const G=function(n,i,e){return{itemsPerPage:n,currentPage:i,totalItems:e}};function H(n,i){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",12)(2,"table",13)(3,"thead",14)(4,"tr")(5,"th"),t._uU(6,"#"),t.qZA(),t.TgZ(7,"th"),t._uU(8,"Amount"),t.qZA(),t.TgZ(9,"th"),t._uU(10,"Interest Rate"),t.qZA(),t.TgZ(11,"th"),t._uU(12,"Issue Date"),t.qZA(),t.TgZ(13,"th"),t._uU(14,"Due Date"),t.qZA(),t.TgZ(15,"th"),t._uU(16,"Status"),t.qZA()()(),t.TgZ(17,"tbody"),t.YNc(18,z,17,16,"ng-container",15),t.ALo(19,"paginate"),t.qZA()()(),t.TgZ(20,"div",16)(21,"pagination-controls",17),t.NdJ("pageChange",function(a){t.CHM(e);const l=t.oxw(3);return t.KtG(l.onPageChange(a))}),t.qZA()(),t.BQk()}if(2&n){const e=t.oxw(3);t.xp6(18),t.Q6J("ngForOf",t.xi3(19,1,e.loans.results,t.kEZ(4,G,e.loans.pageSize,e.currentPage,e.loans.totalItems)))}}function K(n,i){1&n&&t._UZ(0,"app-no-data-found",20),2&n&&t.Q6J("dataLabel","Loan")}function X(n,i){if(1&n&&(t.YNc(0,H,22,8,"ng-container",6),t.YNc(1,K,1,1,"ng-template",null,11,t.W1O)),2&n){const e=t.MAs(2),o=t.oxw(2);t.Q6J("ngIf",o.loans&&o.loans.results.length)("ngIfElse",e)}}function W(n,i){if(1&n&&(t.YNc(0,j,3,1,"ng-container",6),t.YNc(1,X,3,2,"ng-template",null,9,t.W1O)),2&n){const e=t.MAs(2),o=t.oxw();t.Q6J("ngIf",o.errorMessage)("ngIfElse",e)}}const V=[{path:"",component:(()=>{class n{constructor(e){this.loanService=e,this.loading=!0,this.currentPage=1,this.pageSize=10,this.options=[{name:"Issue Date",formname:"startDate",type:"date"},{name:"Due Date",formname:"endDate",type:"date"},{name:"Amount",formname:"amount",type:"number"},{name:"Status",formname:"loanstatus",type:"select",selectoptions:[{val:"pending",name:"Pending"},{val:"approved",name:"Approved"},{val:"rejected",name:"Rejected"}]}]}ngOnInit(){this.loadTasks({})}loadTasks(e){this.loading=!0,this.loanService.getAllLoans(this.currentPage,this.pageSize,e).subscribe({next:o=>{this.loans=o},error:o=>{this.errorMessage=o,this.loading=!1},complete:()=>{this.loading=!1}})}searchFunction(e){this.loadTasks(e)}onPageChange(e){this.currentPage=e,this.loadTasks({})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(A))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-list-loans"]],decls:13,vars:3,consts:[[1,"py-4"],[1,"d-flex"],[1,"flex-grow-1"],[1,"text-secondary","fw-normal","mb-1"],[3,"searchOptions","searchEmit"],["routerLink","/accounts/loans/add",1,"btn","btn-outline-primary","btn-sm"],[4,"ngIf","ngIfElse"],["loadedContent",""],[1,"py-3"],["noError",""],[3,"errorMessage"],["nodata",""],[1,"table-responsive"],[1,"table","table-bordered","table-striped","text-nowrap"],[1,"thead"],[4,"ngFor","ngForOf"],[1,"d-flex","justify-content-end","pt-3"],[1,"my-pagination",3,"pageChange"],[1,"cursor-pointer",3,"routerLink"],[1,"text-capitalize"],[3,"dataLabel"]],template:function(e,o){if(1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2",3),t._uU(4,"Loans"),t.qZA()(),t.ynx(5),t.TgZ(6,"app-search-tab",4),t.NdJ("searchEmit",function(l){return o.searchFunction(l)}),t.qZA(),t.BQk(),t.TgZ(7,"div")(8,"button",5),t._uU(9," Add Loan"),t.qZA()()(),t.YNc(10,R,3,0,"ng-container",6),t.YNc(11,W,3,2,"ng-template",null,7,t.W1O),t.qZA()),2&e){const a=t.MAs(12);t.xp6(6),t.Q6J("searchOptions",o.options),t.xp6(4),t.Q6J("ngIf",o.loading)("ngIfElse",a)}},dependencies:[c.sg,c.O5,w.S,B.i,L.A,P.O,h.LS,d.rH,c.H9,c.uU,h._s]}),n})()},{path:"add",component:x},{path:"edit/:id",component:x},{path:"view/:id",component:(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-details-loan"]],decls:2,vars:0,template:function(e,o){1&e&&(t.TgZ(0,"p"),t._uU(1,"details-loan works!"),t.qZA())}}),n})()},{path:"**",redirectTo:"",pathMatch:"full"}];let tt=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[c.ez,r.u5,r.UX,T.C,h.JX,v.A0,d.Bz.forChild(V)]}),n})()}}]);
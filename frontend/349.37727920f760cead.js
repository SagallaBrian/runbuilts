"use strict";(self.webpackChunkbiz_ke_frontend=self.webpackChunkbiz_ke_frontend||[]).push([[349],{349:(V,g,r)=>{r.r(g),r.d(g,{BranchModule:()=>W});var d=r(9808),c=r(1083),t=r(5e3),h=r(2340),v=r(520);let u=(()=>{class n{constructor(e){this.http=e}addBranch(e){return this.http.post(h.N.apiUrl+"branches/",e)}updateBranch(e,a){return this.http.put(h.N.apiUrl+"branches/"+a,e)}delBranch(e){return this.http.delete(h.N.apiUrl+"branches/"+e)}getBranch(e){return this.http.get(h.N.apiUrl+"branches/"+e)}getBranches(e){return this.http.get(h.N.apiUrl+"branches/",{params:e})}getCounties(e){return this.http.get(h.N.apiUrl+"county/",{params:e})}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(v.eN))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var B=r(1990),x=r(4701),A=r(9550);function T(n,o){if(1&n&&(t.TgZ(0,"div",5),t._uU(1),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.hij(" ",e.errorMessage," ")}}const C=function(n){return["edit/",n]};function U(n,o){if(1&n&&(t.TgZ(0,"tr",13)(1,"td",14),t._uU(2),t.qZA(),t.TgZ(3,"td",14),t._uU(4),t.qZA(),t.TgZ(5,"td",14),t._uU(6),t.qZA(),t.TgZ(7,"td",14),t._uU(8),t.qZA(),t.TgZ(9,"td",14),t._uU(10),t.ALo(11,"county"),t.qZA(),t.TgZ(12,"td",14),t._uU(13),t.qZA(),t.TgZ(14,"td",14),t._uU(15),t.qZA(),t.TgZ(16,"td",14),t._uU(17),t.qZA(),t.TgZ(18,"td",14),t._uU(19),t.qZA(),t.TgZ(20,"td",14),t._uU(21),t.qZA()()),2&n){const e=o.$implicit,a=o.index;t.Q6J("routerLink",t.VKq(13,C,e.id)),t.xp6(2),t.Oqu(a+1),t.xp6(2),t.hij("",e.companyname," "),t.xp6(2),t.hij("",e.name," "),t.xp6(2),t.Oqu(e.code),t.xp6(2),t.Oqu(t.lcZ(11,11,e.location)),t.xp6(3),t.Oqu(e.admin),t.xp6(2),t.Oqu(e.phone),t.xp6(2),t.Oqu(e.email),t.xp6(2),t.Oqu(e.branchaddress),t.xp6(2),t.Oqu(e.details)}}function N(n,o){if(1&n&&(t.ynx(0),t.YNc(1,U,22,15,"tr",12),t.BQk()),2&n){const e=t.oxw(2);t.xp6(1),t.Q6J("ngForOf",e.branches)}}function S(n,o){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",6)(2,"table",7)(3,"tbody")(4,"tr",8)(5,"th",9),t._uU(6,"#"),t.qZA(),t.TgZ(7,"th",9),t._uU(8,"Company Name"),t.qZA(),t.TgZ(9,"th",9),t._uU(10,"Branch Name"),t.qZA(),t.TgZ(11,"th",9),t._uU(12,"Branch Code"),t.qZA(),t.TgZ(13,"th",9),t._uU(14,"Location"),t.qZA(),t.TgZ(15,"th",9),t._uU(16,"Contact Person"),t.qZA(),t.TgZ(17,"th",9),t._uU(18,"Phone"),t.qZA(),t.TgZ(19,"th",9),t._uU(20,"Email"),t.qZA(),t.TgZ(21,"th",9),t._uU(22,"Address"),t.qZA(),t.TgZ(23,"th",9),t._uU(24,"Description"),t.qZA()(),t.YNc(25,N,2,1,"ng-container",10),t.qZA()()(),t.TgZ(26,"app-paginator",11),t.NdJ("newItemEvent",function(s){return t.CHM(e),t.oxw().paginatedCall(s)}),t.qZA(),t.BQk()}if(2&n){const e=t.oxw();t.xp6(25),t.Q6J("ngIf",e.branches),t.xp6(1),t.Q6J("datafromdb",e.paginator)}}function q(n,o){if(1&n&&(t.TgZ(0,"div",16),t._uU(1),t.qZA()),2&n){const e=t.oxw(2);t.xp6(1),t.hij(" ",e.loadmessage," ")}}function y(n,o){if(1&n&&t.YNc(0,q,2,1,"div",15),2&n){const e=t.oxw();t.Q6J("ngIf",e.loading)}}let I=(()=>{class n{constructor(e,a){this.payServ=e,this.router=a,this.loading=!0,this.loadmessage="loading ...",this.ifSearched=!1,this.paginator={page:1,pageSize:1},this.options=[{searchName:"Branch Name",searchParam:"name"},{searchName:"Branch Code",searchParam:"code"},{searchName:"Admin Name",searchParam:"admin"},{searchName:"Admin Email",searchParam:"email"},{searchName:"Admin Phone",searchParam:"phone"}],this.labels={listname:"Branches List",addBtname:"Add Branch",searchPlaceholder:"Search Branch"}}ngOnInit(){this.loadBranches()}loadBranches(){this.payServ.getBranches(this.paginator).subscribe({next:e=>this.handleResp(e),error:e=>this.errorHandle(e)})}handleResp(e){this.loading=!1,this.branches=e.results,this.ifSearched||(this.brancheStore=e),this.setPaginator(e)}errorHandle(e){this.loading=!1,this.errorMessage=e}paginatedCall(e){this.ifSearched=!1,this.setPaginator(this.brancheStore),this.paginator.page=e.page,this.loadBranches()}searchFunction(e){this.setPaginator(this.brancheStore),this.errorMessage=null,this.ifSearched=!0,this.branches=this.brancheStore.results,this.paginator[e.searchParam]=e.searchValue,this.branches=this.branches.filter(a=>{var s;let l=(null===(s=a[e.searchParam])||void 0===s?void 0:s.toString())||"";return new RegExp(e.searchValue,"i").test(l)}),0==this.branches.length&&(this.paginator.page=1,this.loading=!0,this.loadmessage="Performing a Wider Search",this.loadBranches())}closeSearchFunction(){this.branches=this.brancheStore.results,this.errorMessage=null,this.setPaginator(this.brancheStore)}setPaginator(e){this.paginator={page:1,pageSize:10},this.paginator.page=e.currentPage,this.paginator.totalItems=e.totalItems,this.paginator.pageSize=e.pageSize}navigateAdd(){this.router.navigate(["/compadmin/branch/add"])}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(u),t.Y36(c.F0))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-list-branches"]],decls:6,vars:6,consts:[[1,"container-fluid","py-3"],[3,"labels","searchoptions","backenddata","searchEmit","closeEmit","navigateEmit"],["class","alert alert-danger my-3",4,"ngIf"],[4,"ngIf","ngIfElse"],["nodata",""],[1,"alert","alert-danger","my-3"],[1,"table-responsive"],[1,"table","table-striped","table-hover","table-bordered","text-nowrap"],[1,"blhead","rounded"],[1,"text-light"],[4,"ngIf"],[3,"datafromdb","newItemEvent"],["class","cursor",3,"routerLink",4,"ngFor","ngForOf"],[1,"cursor",3,"routerLink"],[1,"tpad"],["class","alert alert-warning text-danger my-3",4,"ngIf"],[1,"alert","alert-warning","text-danger","my-3"]],template:function(e,a){if(1&e&&(t.TgZ(0,"div",0)(1,"app-search-tab",1),t.NdJ("searchEmit",function(l){return a.searchFunction(l)})("closeEmit",function(){return a.closeSearchFunction()})("navigateEmit",function(){return a.navigateAdd()}),t.qZA(),t.YNc(2,T,2,1,"div",2),t.YNc(3,S,27,2,"ng-container",3),t.YNc(4,y,1,1,"ng-template",null,4,t.W1O),t.qZA()),2&e){const s=t.MAs(5);t.xp6(1),t.Q6J("labels",a.labels)("searchoptions",a.options)("backenddata",a.branches),t.xp6(1),t.Q6J("ngIf",a.errorMessage),t.xp6(1),t.Q6J("ngIf",a.branches&&!a.loading&&!a.errorMessage)("ngIfElse",s)}},directives:[B.O,d.O5,d.sg,c.rH,x.J],pipes:[A.e],styles:[""]}),n})();var i=r(3075),E=r(5906),M=r(3034),f=r(7261),m=r(7322),b=r(7531),p=r(4376),_=r(7423);function F(n,o){if(1&n&&(t.TgZ(0,"div",23),t._uU(1),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.hij(" ",e.errorMessage," ")}}function J(n,o){if(1&n&&(t.ynx(0),t.TgZ(1,"ng-option",26),t._uU(2),t.qZA(),t.BQk()),2&n){const e=o.$implicit;t.xp6(1),t.Q6J("value",1*e.code),t.xp6(1),t.hij(" ",e.name.toUpperCase()," ")}}function Q(n,o){if(1&n&&(t.ynx(0),t.TgZ(1,"ng-option",24),t._uU(2,"Please Select County"),t.qZA(),t.YNc(3,J,3,2,"ng-container",25),t.BQk()),2&n){const e=t.oxw();t.xp6(3),t.Q6J("ngForOf",e.counties)}}function L(n,o){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"button",27),t.NdJ("click",function(){return t.CHM(e),t.oxw().delBranch()}),t._uU(2,"Delete"),t.qZA(),t.TgZ(3,"button",28),t.NdJ("click",function(){return t.CHM(e),t.oxw().editBranch()}),t._uU(4,"Save Changes "),t.qZA(),t.BQk()}if(2&n){const e=t.oxw();t.xp6(1),t.Q6J("disabled",e.errorMessage||e.loading),t.xp6(2),t.Q6J("disabled",e.branchForm.invalid||e.branchForm.pristine)}}function P(n,o){1&n&&(t.ynx(0),t._UZ(1,"i",31),t.TgZ(2,"span",32),t._uU(3,"Loading..."),t.qZA(),t.BQk())}function Y(n,o){1&n&&t._uU(0," Add Branch ")}function k(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"button",29),t.NdJ("click",function(){return t.CHM(e),t.oxw().addBranch()}),t.YNc(1,P,4,0,"ng-container",21),t.YNc(2,Y,1,0,"ng-template",null,30,t.W1O),t.qZA()}if(2&n){const e=t.MAs(3),a=t.oxw();t.Q6J("disabled",a.branchForm.invalid||a.errorMessage||a.loading),t.xp6(1),t.Q6J("ngIf",a.loading)("ngIfElse",e)}}let Z=(()=>{class n{constructor(e,a,s,l,K){this.brnchFb=e,this.router=a,this.snakBar=s,this.brnServ=l,this.route=K,this.matcher=new E.n,this.loading=!1,this.branchForm=this.brnchFb.group({code:["",i.kI.required],name:["",i.kI.required],location:["",i.kI.required],branchaddress:["",i.kI.required],admin:["",i.kI.required],phone:["",[i.kI.required,(0,M.t)()]],email:["",[i.kI.required,i.kI.email]],details:[""]})}ngOnInit(){this.loadCounties(),this.branchid=this.route.snapshot.paramMap.get("id"),this.branchid&&this.loadBranch(),this.branchForm.valueChanges.subscribe(()=>{this.errorMessage=!1})}loadCounties(){this.brnServ.getCounties({page:1,pageSize:1e4}).subscribe({next:e=>this.counties=e.results,error:e=>this.errorHandle(e)})}loadBranch(){this.loading=!0,this.brnServ.getBranch(this.branchid).subscribe({next:e=>this.respPay(e),error:e=>this.errorHandle(e)})}addBranch(){this.loading=!0,this.brnServ.addBranch(this.branchForm.value).subscribe({next:a=>this.handleResp(a),error:a=>this.errorHandle(a)})}editBranch(){this.loading=!0,this.brnServ.updateBranch(this.branchForm.value,this.branchid).subscribe({next:a=>this.handleResp(a),error:a=>this.errorHandle(a)})}delBranch(){this.loading=!0,this.brnServ.delBranch(this.branchid).subscribe({next:e=>this.handleResp(e),error:e=>this.errorHandle(e)})}openSnakBar(e,a){this.snakBar.open(e,a,{duration:2500})}respPay(e){this.loading=!1,this.branchForm.patchValue({code:e.code,name:e.name,location:e.location,branchaddress:e.branchaddress,admin:e.admin,phone:e.phone,email:e.email,details:e.details})}handleResp(e){this.loading=!1,this.openSnakBar(e.message,"Dismiss"),this.router.navigate(["/compadmin/branch"])}errorHandle(e){this.loading=!1,this.errorMessage=e}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(i.qu),t.Y36(c.F0),t.Y36(f.ux),t.Y36(u),t.Y36(c.gz))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-add-edit-branch"]],decls:52,vars:11,consts:[[1,"d-lg-flex","text-secondary","py-2"],[1,"flex-grow-1"],["type","button","routerLink","/compadmin/branch",1,"btn","btn-outline-success","btn-sm"],["aria-hidden","true",1,"fa","fa-chevron-left"],[3,"formGroup"],["class","alert alert-danger my-3",4,"ngIf"],[1,"row","pt-3"],[1,"col-lg-6"],["appearance","outline",1,"w-100"],["matInput","","placeholder","Branch Name","formControlName","name",3,"errorStateMatcher"],["matInput","","placeholder","Branch Code","formControlName","code",3,"errorStateMatcher"],[1,"row"],[1,"col-lg-6","pt-1"],["formControlName","location"],[4,"ngIf"],["matInput","","placeholder","Enter Branch Adderess","formControlName","branchaddress",3,"errorStateMatcher"],[1,"col-lg-12"],["matInput","","placeholder","Enter Contact Name","formControlName","admin",3,"errorStateMatcher"],["matInput","","placeholder","Phone Number","formControlName","phone",3,"errorStateMatcher"],["matInput","","placeholder","Enter Email","formControlName","email",3,"errorStateMatcher"],["matInput","","formControlName","details"],[4,"ngIf","ngIfElse"],["noBranch",""],[1,"alert","alert-danger","my-3"],["value","","disabled",""],[4,"ngFor","ngForOf"],[3,"value"],["type","button","mat-flat-button","","color","warn",1,"me-2",3,"disabled","click"],["type","button","mat-flat-button","","color","primary",3,"disabled","click"],["mat-flat-button","","color","primary","type","button",1,"me-3",3,"disabled","click"],["notload",""],[1,"fa","fa-spinner","fa-spin","fa-1x","me-2"],[1,""]],template:function(e,a){if(1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"button",2),t._UZ(3,"i",3),t._uU(4," Back "),t.qZA()()(),t.TgZ(5,"form",4),t.YNc(6,F,2,1,"div",5),t.TgZ(7,"div",6)(8,"div",7)(9,"mat-form-field",8)(10,"mat-label"),t._uU(11,"Branch Name"),t.qZA(),t._UZ(12,"input",9),t.qZA()(),t.TgZ(13,"div",7)(14,"mat-form-field",8)(15,"mat-label"),t._uU(16,"Branch Code"),t.qZA(),t._UZ(17,"input",10),t.qZA()()(),t.TgZ(18,"div",11)(19,"div",12)(20,"ng-select",13),t.YNc(21,Q,4,1,"ng-container",14),t.qZA()(),t.TgZ(22,"div",7)(23,"mat-form-field",8)(24,"mat-label"),t._uU(25,"Branch Address"),t.qZA(),t._UZ(26,"input",15),t.qZA()()(),t.TgZ(27,"div",11)(28,"div",16)(29,"mat-form-field",8)(30,"mat-label"),t._uU(31,"Contact Name"),t.qZA(),t._UZ(32,"input",17),t.qZA()(),t.TgZ(33,"div",7)(34,"mat-form-field",8)(35,"mat-label"),t._uU(36,"Phone Number"),t.qZA(),t._UZ(37,"input",18),t.qZA()(),t.TgZ(38,"div",7)(39,"mat-form-field",8)(40,"mat-label"),t._uU(41,"Email"),t.qZA(),t._UZ(42,"input",19),t.qZA()()(),t.TgZ(43,"div",11)(44,"div",16)(45,"mat-form-field",8)(46,"mat-label"),t._uU(47,"Branch Description"),t.qZA(),t._UZ(48,"textarea",20),t.qZA()()(),t.YNc(49,L,5,2,"ng-container",21),t.YNc(50,k,4,3,"ng-template",null,22,t.W1O),t.qZA()),2&e){const s=t.MAs(51);t.xp6(5),t.Q6J("formGroup",a.branchForm),t.xp6(1),t.Q6J("ngIf",a.errorMessage),t.xp6(6),t.Q6J("errorStateMatcher",a.matcher),t.xp6(5),t.Q6J("errorStateMatcher",a.matcher),t.xp6(4),t.Q6J("ngIf",a.counties),t.xp6(5),t.Q6J("errorStateMatcher",a.matcher),t.xp6(6),t.Q6J("errorStateMatcher",a.matcher),t.xp6(5),t.Q6J("errorStateMatcher",a.matcher),t.xp6(5),t.Q6J("errorStateMatcher",a.matcher),t.xp6(7),t.Q6J("ngIf",a.branchid)("ngIfElse",s)}},directives:[c.rH,i._Y,i.JL,i.sg,d.O5,m.KE,m.hX,b.Nt,i.Fj,i.JJ,i.u,p.w9,p.jq,d.sg,_.lW],styles:[".mat-form-field-flex>.mat-form-field-infix{padding:.5em 0!important}  .mat-form-field-label-wrapper{top:-1.4em}  .mat-form-field-appearance-outline.mat-form-field-can-float.mat-form-field-should-float .mat-form-field-label{transform:translateY(-1.1em) scale(.75);width:133.33333%}"]}),n})();var O=r(508),H=r(6856),w=r(5245),z=r(4107),j=r(6186),D=r(4586),R=r(9744);const X=[{path:"",component:I},{path:"add",component:Z},{path:"edit/:id",component:Z}];let W=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[d.ez,j.K,i.UX,p.A0,i.u5,f.ZX,m.lN,z.LD,b.c,w.Ps,_.ot,O.XK,H.FA,D.D,R.F,c.Bz.forChild(X)]]}),n})()}}]);
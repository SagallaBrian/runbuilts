"use strict";(self.webpackChunksuluhi_admin_frontend=self.webpackChunksuluhi_admin_frontend||[]).push([[683],{2683:(Qe,Z,m)=>{m.r(Z),m.d(Z,{DirectPaymentModule:()=>Ie});var s=m(6895),d=m(8869),c=m(4006),y=m(8796),v=m(4333),b=m(1213),e=m(4650),f=m(1863),x=m(7997),A=m(5511),h=m(8057),C=m(295);function U(n,o){1&n&&(e.ynx(0),e.TgZ(1,"div",8),e._UZ(2,"app-sul-loader"),e.qZA(),e.BQk())}function N(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"div",8),e._UZ(2,"app-error-occured",10),e.qZA(),e.BQk()),2&n){const t=e.oxw(2);e.xp6(2),e.Q6J("errorMessage",t.errorMessage)}}const I=function(n){return["view",n]},Q=function(n){return["edit",n]};function k(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"tr",18)(2,"td"),e._uU(3),e.qZA(),e.TgZ(4,"td"),e._uU(5),e.qZA(),e.TgZ(6,"td"),e._uU(7),e.ALo(8,"date"),e.qZA(),e.TgZ(9,"td"),e._uU(10),e.qZA(),e.TgZ(11,"td",19),e._uU(12),e.qZA(),e.TgZ(13,"td")(14,"button",20),e._uU(15,"Edit"),e.qZA()()(),e.BQk()),2&n){const t=o.$implicit,i=o.index;e.xp6(1),e.Q6J("routerLink",e.VKq(9,I,t._id)),e.xp6(2),e.Oqu(i+1),e.xp6(2),e.Oqu(t.uniqueNumber),e.xp6(2),e.Oqu(e.lcZ(8,7,t.paymentdate)),e.xp6(3),e.Oqu(t.transactioncode),e.xp6(2),e.Oqu(t.modeofpay),e.xp6(2),e.Q6J("routerLink",e.VKq(11,Q,t._id))}}const E=function(n,o,t){return{itemsPerPage:n,currentPage:o,totalItems:t}};function F(n,o){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",12)(2,"table",13)(3,"thead",14)(4,"tr")(5,"th"),e._uU(6,"#"),e.qZA(),e.TgZ(7,"th"),e._uU(8,"Payment No"),e.qZA(),e.TgZ(9,"th"),e._uU(10,"Payment Date"),e.qZA(),e.TgZ(11,"th"),e._uU(12,"Transaction Code"),e.qZA(),e.TgZ(13,"th"),e._uU(14,"Mode of Pay"),e.qZA(),e._UZ(15,"th"),e.qZA()(),e.TgZ(16,"tbody"),e.YNc(17,k,16,13,"ng-container",15),e.ALo(18,"paginate"),e.qZA()()(),e.TgZ(19,"div",16)(20,"pagination-controls",17),e.NdJ("pageChange",function(a){e.CHM(t);const r=e.oxw(3);return e.KtG(r.onPageChange(a))}),e.qZA()(),e.BQk()}if(2&n){const t=e.oxw(3);e.xp6(17),e.Q6J("ngForOf",e.xi3(18,1,t.payments.results,e.kEZ(4,E,t.payments.pageSize,t.currentPage,t.payments.totalItems)))}}function J(n,o){1&n&&e._UZ(0,"app-no-data-found",21),2&n&&e.Q6J("dataLabel","Payment")}function O(n,o){if(1&n&&(e.YNc(0,F,21,8,"ng-container",6),e.YNc(1,J,1,1,"ng-template",null,11,e.W1O)),2&n){const t=e.MAs(2),i=e.oxw(2);e.Q6J("ngIf",i.payments&&i.payments.results.length)("ngIfElse",t)}}function Y(n,o){if(1&n&&(e.YNc(0,N,3,1,"ng-container",6),e.YNc(1,O,3,2,"ng-template",null,9,e.W1O)),2&n){const t=e.MAs(2),i=e.oxw();e.Q6J("ngIf",i.errorMessage)("ngIfElse",t)}}let w=(()=>{class n{constructor(t){this.paymentService=t,this.loading=!0,this.currentPage=1,this.pageSize=10,this.options=[{name:"Payment No",formname:"uniqueNumber",type:"text"},{name:"Payment Date",formname:"paymentdate",type:"date"},{name:"Transaction Code",formname:"transactioncode",type:"text"},{name:"Mode Of Pay",formname:"modeofpay",type:"select",selectoptions:[{val:"mpesa",name:"Mpesa"},{val:"cash",name:"Cash"},{val:"bank_deposit",name:"Bank Deposit"},{val:"cheque",name:"Cheque"},{val:"paypal",name:"Paypal"}]}]}ngOnInit(){this.loadPayments({typeofpay:"payment"})}loadPayments(t){this.loading=!0,this.paymentService.getAllPayments(this.currentPage,this.pageSize,t).subscribe({next:i=>{this.payments=i},error:i=>{this.errorMessage=i,this.loading=!1},complete:()=>{this.loading=!1}})}searchFunction(t){const i={...t,typeofpay:"payment"};this.loadPayments(i)}onPageChange(t){this.currentPage=t,this.loadPayments({typeofpay:"payment"})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(f.t))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-list-payment"]],decls:13,vars:3,consts:[[1,"py-4"],[1,"d-flex"],[1,"flex-grow-1"],[1,"text-secondary","fw-normal","mb-1"],[3,"searchOptions","searchEmit"],["routerLink","/accounts/payments/add",1,"btn","btn-outline-primary","btn-sm"],[4,"ngIf","ngIfElse"],["loadedContent",""],[1,"py-3"],["noError",""],[3,"errorMessage"],["nodata",""],[1,"table-responsive"],[1,"table","table-bordered","table-striped","text-nowrap"],[1,"thead"],[4,"ngFor","ngForOf"],[1,"d-flex","justify-content-end","pt-3"],[1,"my-pagination",3,"pageChange"],[1,"cursor-pointer",3,"routerLink"],[1,"text-capitalize"],[1,"edit-btn",3,"routerLink"],[3,"dataLabel"]],template:function(t,i){if(1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2",3),e._uU(4,"Payments (Expense)"),e.qZA()(),e.ynx(5),e.TgZ(6,"app-search-tab",4),e.NdJ("searchEmit",function(r){return i.searchFunction(r)}),e.qZA(),e.BQk(),e.TgZ(7,"div")(8,"button",5),e._uU(9," Add Payment"),e.qZA()()(),e.YNc(10,U,3,0,"ng-container",6),e.YNc(11,Y,3,2,"ng-template",null,7,e.W1O),e.qZA()),2&t){const a=e.MAs(12);e.xp6(6),e.Q6J("searchOptions",i.options),e.xp6(4),e.Q6J("ngIf",i.loading)("ngIfElse",a)}},dependencies:[s.sg,s.O5,x.S,A.i,h.A,C.O,v.LS,d.rH,s.uU,v._s]}),n})();var S=m(583),M=m(8364);function L(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"div",35),e._UZ(2,"app-error-occured",36),e.qZA(),e.BQk()),2&n){const t=e.oxw();e.xp6(2),e.Q6J("errorMessage",t.errorMessage)}}function D(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"button",37),e._uU(2," Print Payment "),e.qZA(),e.BQk()),2&n){const t=e.oxw();e.xp6(1),e.MGl("routerLink","/accounts/payments/view/",t.paymentId,"")}}function B(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"ng-option",41),e._uU(2),e.qZA(),e.BQk()),2&n){const t=o.$implicit;e.xp6(1),e.Q6J("value",t._id),e.xp6(1),e.AsE(" ",t.firstName," ",t.lastName," ")}}function j(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"ng-select",38)(2,"ng-option",39),e._uU(3,"Search Customer"),e.qZA(),e.YNc(4,B,3,3,"ng-container",40),e.qZA(),e.BQk()),2&n){const t=e.oxw(2);e.xp6(4),e.Q6J("ngForOf",t.clients.results)}}function G(n,o){1&n&&(e.TgZ(0,"div",42),e._uU(1," Customer is required. "),e.qZA())}function R(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"div",6)(2,"div"),e.YNc(3,j,5,1,"ng-container",0),e.qZA(),e.YNc(4,G,2,0,"div",18),e.qZA(),e.BQk()),2&n){const t=e.oxw();let i;e.xp6(3),e.Q6J("ngIf",t.clients&&t.clients.results.length),e.xp6(1),e.Q6J("ngIf",(null==(i=t.paymentForm.get("customerid"))?null:i.invalid)&&(null==(i=t.paymentForm.get("customerid"))?null:i.touched))}}function K(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"ng-option",41),e._uU(2),e.qZA(),e.BQk()),2&n){const t=o.$implicit;e.xp6(1),e.Q6J("value",t._id),e.xp6(1),e.hij(" ",t.uniqueNumber," ")}}function H(n,o){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"ng-select",43),e.NdJ("change",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.onSelectInvoice())}),e.TgZ(2,"ng-option",39),e._uU(3,"Search Lso/Lpo"),e.qZA(),e.YNc(4,K,3,2,"ng-container",40),e.qZA(),e.BQk()}if(2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("readonly",t.paymentId),e.xp6(3),e.Q6J("ngForOf",t.invoices.results)}}function z(n,o){1&n&&(e.TgZ(0,"div",42),e._uU(1," Invoice required. "),e.qZA())}function W(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"div",6)(2,"div"),e.YNc(3,H,5,2,"ng-container",0),e.qZA(),e.YNc(4,z,2,0,"div",18),e.qZA(),e.BQk()),2&n){const t=e.oxw();let i;e.xp6(3),e.Q6J("ngIf",t.invoices&&t.invoices.results.length),e.xp6(1),e.Q6J("ngIf",(null==(i=t.paymentForm.get("invoicelsoid"))?null:i.invalid)&&(null==(i=t.paymentForm.get("invoicelsoid"))?null:i.touched))}}function X(n,o){1&n&&(e.TgZ(0,"div",42),e._uU(1," Supplier is required. "),e.qZA())}function $(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"div",6),e._UZ(2,"input",44),e.YNc(3,X,2,0,"div",18),e.qZA(),e.BQk()),2&n){const t=e.oxw();let i;e.xp6(3),e.Q6J("ngIf",(null==(i=t.paymentForm.get("recipient"))?null:i.invalid)&&(null==(i=t.paymentForm.get("recipient"))?null:i.touched))}}function V(n,o){1&n&&(e.TgZ(0,"div",42),e._uU(1," Payment Date is required. "),e.qZA())}function ee(n,o){1&n&&(e.TgZ(0,"div",42),e._uU(1," Transaction code is required. "),e.qZA())}function te(n,o){1&n&&(e.TgZ(0,"div",42),e._uU(1," Description is required. "),e.qZA())}function ne(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",49)(1,"div",50)(2,"div",2)(3,"div",3)(4,"h4",51),e._uU(5),e.qZA()(),e.TgZ(6,"div")(7,"button",52),e.NdJ("click",function(){const r=e.CHM(t).index,l=e.oxw(2);return e.KtG(l.deleteService(r))}),e._uU(8,"Remove"),e.qZA()()(),e.TgZ(9,"div",53)(10,"div",14)(11,"div",15)(12,"div",6)(13,"label",54),e._uU(14,"Name"),e.qZA(),e._UZ(15,"input",55),e.qZA()(),e.TgZ(16,"div",15)(17,"div",6)(18,"label",56),e._uU(19,"Price"),e.qZA(),e._UZ(20,"input",57),e.qZA()()()()()()}if(2&n){const t=o.index,i=e.oxw(2);let a,r,l;e.xp6(5),e.hij("Service ",t+1,""),e.xp6(2),e.Q6J("disabled","invoice"===(null==(a=i.paymentForm.get("customeorinvoice"))?null:a.value)),e.xp6(2),e.Q6J("formGroupName",t),e.xp6(6),e.Q6J("readOnly","invoice"===(null==(r=i.paymentForm.get("customeorinvoice"))?null:r.value)),e.xp6(5),e.Q6J("readOnly","invoice"===(null==(l=i.paymentForm.get("customeorinvoice"))?null:l.value))}}function ie(n,o){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",45),e.YNc(2,ne,21,5,"div",46),e.TgZ(3,"div",47)(4,"button",48),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.addService())}),e._uU(5,"Add Service"),e.qZA()()(),e.BQk()}if(2&n){const t=e.oxw();let i;e.xp6(2),e.Q6J("ngForOf",t.serviceArr.controls),e.xp6(2),e.Q6J("disabled","invoice"===(null==(i=t.paymentForm.get("customeorinvoice"))?null:i.value))}}function oe(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",49)(1,"div",50)(2,"div",2)(3,"div",3)(4,"h4",51),e._uU(5),e.qZA()(),e.TgZ(6,"div")(7,"button",52),e.NdJ("click",function(){const r=e.CHM(t).index,l=e.oxw(2);return e.KtG(l.deleteProduct(r))}),e._uU(8,"Remove"),e.qZA()()(),e.TgZ(9,"div",53)(10,"div",14)(11,"div",59)(12,"div",6)(13,"label",54),e._uU(14,"Name"),e.qZA(),e._UZ(15,"input",60),e.qZA()(),e.TgZ(16,"div",59)(17,"div",6)(18,"label",56),e._uU(19,"Unit Price"),e.qZA(),e._UZ(20,"input",61),e.qZA()(),e.TgZ(21,"div",59)(22,"div",6)(23,"label",56),e._uU(24,"Number of ITems"),e.qZA(),e._UZ(25,"input",62),e.qZA()()()()()()}if(2&n){const t=o.index,i=e.oxw(2);let a,r,l,p;e.xp6(5),e.hij("Product ",t+1,""),e.xp6(2),e.Q6J("disabled","invoice"===(null==(a=i.paymentForm.get("customeorinvoice"))?null:a.value)),e.xp6(2),e.Q6J("formGroupName",t),e.xp6(6),e.Q6J("readOnly","invoice"===(null==(r=i.paymentForm.get("customeorinvoice"))?null:r.value)),e.xp6(5),e.Q6J("readOnly","invoice"===(null==(l=i.paymentForm.get("customeorinvoice"))?null:l.value)),e.xp6(5),e.Q6J("readOnly","invoice"===(null==(p=i.paymentForm.get("customeorinvoice"))?null:p.value))}}function ae(n,o){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",58),e.YNc(2,oe,26,6,"div",46),e.TgZ(3,"div",47)(4,"button",48),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.addProduct())}),e._uU(5,"Add Product"),e.qZA()()(),e.BQk()}if(2&n){const t=e.oxw();let i;e.xp6(2),e.Q6J("ngForOf",t.productsArr.controls),e.xp6(2),e.Q6J("disabled","invoice"===(null==(i=t.paymentForm.get("customeorinvoice"))?null:i.value))}}function re(n,o){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",63),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.deletePayment())}),e._uU(2,"Delete Payment"),e.qZA(),e.TgZ(3,"button",64),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.updatePayment())}),e._uU(4," Edit Payment "),e.qZA(),e.BQk()}if(2&n){const t=e.oxw();e.xp6(3),e.Q6J("disabled",t.paymentForm.invalid)}}function ce(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"button",65),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.addPayment())}),e._uU(1," Add Payment "),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("disabled",t.paymentForm.invalid)}}let T=(()=>{class n{constructor(t,i,a,r,l,p){this.formBuilder=t,this.router=i,this.receiptService=a,this.clientService=r,this.invoiceService=l,this.route=p,this.title="Add Payment",this.today=(new Date).toISOString().substring(0,10),this.submiting=!1,this.loading=!1,this.loadingclients=!1,this.loadinginvoice=!1}ngOnInit(){this.loadClients({}),this.loadInvoices({type:"lsolpo"}),this.paymentForm=this.formBuilder.group({customerid:[""],invoicelsoid:[""],recipient:[""],modeofpay:["mpesa",c.kI.required],typeofpay:["payment"],transactioncode:[""],paymentdate:[this.today],description:[""],customeorinvoice:["customer"],serviceorproduct:["service"],products:this.formBuilder.array([]),service:this.formBuilder.array([])}),this.paymentId=this.route.snapshot.paramMap.get("id"),this.paymentId?(this.title="Edit Payment",this.getReceipt(this.paymentId),this.paymentForm.get("serviceorproduct")?.disable(),this.paymentForm.get("customeorinvoice")?.disable()):this.addService()}checkIfprdServ(){const t=this.paymentForm.get("serviceorproduct")?.value;this.serviceArr.clear(),this.productsArr.clear(),"service"===t&&this.addService(),"product"===t&&this.addProduct()}checkIfnvc(){const t=this.paymentForm.get("customeorinvoice")?.value;this.serviceArr.clear(),this.productsArr.clear(),"customer"===t?(this.paymentForm.removeControl("invoicelsoid"),this.paymentForm.removeControl("recipient"),this.paymentForm.addControl("customerid",this.formBuilder.control("",c.kI.required)),this.paymentForm.get("serviceorproduct")?.enable()):"invoice"===t?(this.paymentForm.removeControl("customerid"),this.paymentForm.removeControl("recipient"),this.paymentForm.addControl("invoicelsoid",this.formBuilder.control("",c.kI.required)),this.paymentForm.get("serviceorproduct")?.disable()):"recipient"===t&&(this.paymentForm.removeControl("customerid"),this.paymentForm.removeControl("invoicelsoid"),this.paymentForm.addControl("recipient",this.formBuilder.control("",c.kI.required)),this.paymentForm.get("serviceorproduct")?.enable())}getReceipt(t){this.loading=!0,this.receiptService.getPayment(t).subscribe({next:i=>{const a=new Date(i.paymentdate).toISOString().substring(0,10);i.paymentdate=a,this.paymentForm.patchValue(i),i.products.forEach(r=>{const l=this.formBuilder.group({name:[r.name,c.kI.required],noOfitems:[r.noOfitems,c.kI.required],unitprice:[r.unitprice,c.kI.required],_id:[r._id]});this.productsArr.push(l)}),i.service.forEach(r=>{const l=this.formBuilder.group({name:[r.name,c.kI.required],price:[r.price,c.kI.required],_id:[r._id]});this.serviceArr.push(l)})},error:i=>{this.errorMessage=i,this.loading=!1},complete:()=>{this.loading=!1}})}get productsArr(){return this.paymentForm.get("products")}addProduct(){const t=this.formBuilder.group({name:["",c.kI.required],noOfitems:["",c.kI.required],unitprice:["",c.kI.required]});this.productsArr.push(t)}deleteProduct(t){this.productsArr.removeAt(t)}get serviceArr(){return this.paymentForm.get("service")}addService(){const t=this.formBuilder.group({name:["",c.kI.required],price:["",c.kI.required]});this.serviceArr.push(t)}deleteService(t){this.serviceArr.removeAt(t)}addPayment(){if(this.paymentForm.valid){this.submiting=!0;const t=this.paymentForm.value;t.serviceorproduct=this.paymentForm.get("serviceorproduct")?.value,""===t.customerid&&delete t.customerid,""===t.invoicelsoid&&delete t.invoicelsoid,this.receiptService.createPayment(t).subscribe({next:i=>{this.paymentForm.reset(),this.router.navigate(["/accounts/payments"])},error:i=>{this.errorMessage=i,this.submiting=!1},complete:()=>{this.submiting=!1}})}}updatePayment(){const t=this.paymentForm.value;t.serviceorproduct=this.paymentForm.get("serviceorproduct")?.value,""===t.customerid&&delete t.customerid,""===t.invoicelsoid&&delete t.invoicelsoid,this.submiting=!0,this.receiptService.updatePayment(this.paymentId,t).subscribe({next:i=>{this.router.navigate(["/accounts/payments"])},error:i=>{this.errorMessage=i,this.submiting=!1},complete:()=>{this.submiting=!1}})}deletePayment(){this.submiting=!0,this.receiptService.deletePayment(this.paymentId).subscribe({next:t=>{this.router.navigate(["/accounts/payments"])},error:t=>{this.errorMessage=t,this.submiting=!1},complete:()=>{this.submiting=!1}})}loadClients(t){this.loadingclients=!0,this.clientService.getAllClientSuppliers(1,100,t).subscribe({next:i=>{this.clients=i},error:i=>{this.errorMessage=i,this.loadingclients=!1},complete:()=>{this.loadingclients=!1}})}loadInvoices(t){this.loadinginvoice=!0,this.invoiceService.getAllInvoicelsos(1,100,t).subscribe({next:i=>{this.invoices=i},error:i=>{this.errorMessage=i,this.loadinginvoice=!1},complete:()=>{this.loadinginvoice=!1}})}onSelectInvoice(){this.serviceArr.clear(),this.productsArr.clear();const t=this.paymentForm.get("invoicelsoid")?.value,i=this.invoices.results.find(a=>a._id===t);i&&i.serviceorproduct&&(this.paymentForm.get("serviceorproduct")?.setValue(i.serviceorproduct),i.products.forEach(a=>{const r=this.formBuilder.group({name:[a.name,c.kI.required],noOfitems:[a.noOfitems,c.kI.required],unitprice:[a.unitprice,c.kI.required],_id:[a._id]});this.productsArr.push(r)}),i.service.forEach(a=>{const r=this.formBuilder.group({name:[a.name,c.kI.required],price:[a.price,c.kI.required],_id:[a._id]});this.serviceArr.push(r)}))}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(c.qu),e.Y36(d.F0),e.Y36(f.t),e.Y36(S.y),e.Y36(M.v),e.Y36(d.gz))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-add-edit-payment"]],decls:73,vars:14,consts:[[4,"ngIf"],[1,"my-4",3,"formGroup"],[1,"d-flex"],[1,"flex-grow-1"],[1,"fw-normal"],["routerLink","/accounts/payments",1,"btn","btn-outline-secondary","btn-sm"],[1,"mb-3"],[1,"form-check","form-check-inline"],["type","radio","formControlName","customeorinvoice","id","inlineRadio3","value","customer",1,"form-check-input",3,"change"],["for","inlineRadio3",1,"form-check-label"],["type","radio","formControlName","customeorinvoice","id","inlineRadio4","value","invoice",1,"form-check-input",3,"change"],["for","inlineRadio4",1,"form-check-label"],["type","radio","formControlName","customeorinvoice","id","inlineRadio5","value","recipient",1,"form-check-input",3,"change"],["for","inlineRadio5",1,"form-check-label"],[1,"row"],[1,"col-lg-6"],["for","title",1,"form-label"],["type","date","id","title","formControlName","paymentdate",1,"form-control"],["class","sul-error",4,"ngIf"],["type","text","id","title","formControlName","transactioncode","placeholder","Enter Transaction code",1,"form-control"],["for","projectlink",1,"form-label"],["aria-label","Default select example","formControlName","modeofpay",1,"form-select"],["value","mpesa"],["value","cash"],["value","bank_deposit"],["value","cheque"],["value","paypal"],["for","description",1,"form-label"],["id","description","formControlName","description","placeholder","Enter Description",1,"form-control"],["type","radio","formControlName","serviceorproduct","id","inlineRadio1","value","service",1,"form-check-input",3,"change"],["for","inlineRadio1",1,"form-check-label"],["type","radio","formControlName","serviceorproduct","id","inlineRadio2","value","product",1,"form-check-input",3,"change"],["for","inlineRadio2",1,"form-check-label"],[4,"ngIf","ngIfElse"],["adding",""],[1,"py-3"],[3,"errorMessage"],[1,"btn","btn-outline-success","btn-sm","ms-2",3,"routerLink"],["formControlName","customerid"],["value","","disabled",""],[4,"ngFor","ngForOf"],[3,"value"],[1,"sul-error"],["formControlName","invoicelsoid",3,"readonly","change"],["type","text","id","title","formControlName","recipient","placeholder","Enter Supplier",1,"form-control"],["formArrayName","service"],["class","card my-3",4,"ngFor","ngForOf"],[1,"text-end"],["type","button",1,"btn","btn-success","btn-sm","mt-3",3,"disabled","click"],[1,"card","my-3"],[1,"card-body"],[1,"card-title"],[1,"btn","btn-danger","btn-sm",3,"disabled","click"],[3,"formGroupName"],["for","titl",1,"form-label"],["type","text","id","titl","formControlName","name","placeholder","Enter Service Provided",1,"form-control",3,"readOnly"],["for","pric",1,"form-label"],["type","number","id","pric","formControlName","price","placeholder","Enter Price",1,"form-control",3,"readOnly"],["formArrayName","products"],[1,"col-lg-4"],["type","text","id","titl","formControlName","name","placeholder","Enter Product Name",1,"form-control",3,"readOnly"],["type","number","id","pric","formControlName","unitprice","placeholder","Enter Unit Price",1,"form-control",3,"readOnly"],["type","number","id","pric","formControlName","noOfitems","placeholder","Enter Number of Items",1,"form-control",3,"readOnly"],["type","submit",1,"btn","btn-danger","btn-sm","me-2",3,"click"],["type","submit",1,"btn","btn-primary","btn-sm",3,"disabled","click"],["type","submit",1,"btn","btn-success","btn-sm",3,"disabled","click"]],template:function(t,i){if(1&t&&(e.TgZ(0,"div"),e.YNc(1,L,3,1,"ng-container",0),e.TgZ(2,"form",1)(3,"div",2)(4,"div",3)(5,"h2",4),e._uU(6),e.qZA()(),e.TgZ(7,"div")(8,"button",5),e._uU(9," List Payments"),e.qZA(),e.YNc(10,D,3,1,"ng-container",0),e.qZA()(),e.TgZ(11,"div",6)(12,"div",7)(13,"input",8),e.NdJ("change",function(){return i.checkIfnvc()}),e.qZA(),e.TgZ(14,"label",9),e._uU(15,"Customer"),e.qZA()(),e.TgZ(16,"div",7)(17,"input",10),e.NdJ("change",function(){return i.checkIfnvc()}),e.qZA(),e.TgZ(18,"label",11),e._uU(19,"Lso/Lpo"),e.qZA()(),e.TgZ(20,"div",7)(21,"input",12),e.NdJ("change",function(){return i.checkIfnvc()}),e.qZA(),e.TgZ(22,"label",13),e._uU(23,"Supplier"),e.qZA()()(),e.YNc(24,R,5,2,"ng-container",0),e.YNc(25,W,5,2,"ng-container",0),e.YNc(26,$,4,1,"ng-container",0),e.TgZ(27,"div",14)(28,"div",15)(29,"div",6)(30,"label",16),e._uU(31,"Payment Date "),e.qZA(),e._UZ(32,"input",17),e.YNc(33,V,2,0,"div",18),e.qZA()(),e.TgZ(34,"div",15)(35,"div",6)(36,"label",16),e._uU(37,"Transaction Code "),e.qZA(),e._UZ(38,"input",19),e.YNc(39,ee,2,0,"div",18),e.qZA()()(),e.TgZ(40,"div",6)(41,"label",20),e._uU(42,"Mode Of Payment"),e.qZA(),e.TgZ(43,"select",21)(44,"option",22),e._uU(45,"Mpesa"),e.qZA(),e.TgZ(46,"option",23),e._uU(47,"Cash"),e.qZA(),e.TgZ(48,"option",24),e._uU(49,"Bank Deposit"),e.qZA(),e.TgZ(50,"option",25),e._uU(51,"Cheque"),e.qZA(),e.TgZ(52,"option",26),e._uU(53,"Paypal and Others"),e.qZA()()(),e.TgZ(54,"div",6)(55,"label",27),e._uU(56,"Description"),e.qZA(),e._UZ(57,"textarea",28),e.YNc(58,te,2,0,"div",18),e.qZA(),e.TgZ(59,"div",6)(60,"div",7)(61,"input",29),e.NdJ("change",function(){return i.checkIfprdServ()}),e.qZA(),e.TgZ(62,"label",30),e._uU(63,"Service"),e.qZA()(),e.TgZ(64,"div",7)(65,"input",31),e.NdJ("change",function(){return i.checkIfprdServ()}),e.qZA(),e.TgZ(66,"label",32),e._uU(67,"Products"),e.qZA()()(),e.YNc(68,ie,6,2,"ng-container",0),e.YNc(69,ae,6,2,"ng-container",0),e.YNc(70,re,5,1,"ng-container",33),e.YNc(71,ce,2,1,"ng-template",null,34,e.W1O),e.qZA()()),2&t){const a=e.MAs(72);let r,l,p,u,_,g,P,q;e.xp6(1),e.Q6J("ngIf",i.errorMessage),e.xp6(1),e.Q6J("formGroup",i.paymentForm),e.xp6(4),e.Oqu(i.title),e.xp6(4),e.Q6J("ngIf",i.paymentId),e.xp6(14),e.Q6J("ngIf","customer"===(null==(r=i.paymentForm.get("customeorinvoice"))?null:r.value)),e.xp6(1),e.Q6J("ngIf","invoice"===(null==(l=i.paymentForm.get("customeorinvoice"))?null:l.value)),e.xp6(1),e.Q6J("ngIf","recipient"===(null==(p=i.paymentForm.get("customeorinvoice"))?null:p.value)),e.xp6(7),e.Q6J("ngIf",(null==(u=i.paymentForm.get("paymentdate"))?null:u.invalid)&&(null==(u=i.paymentForm.get("paymentdate"))?null:u.touched)),e.xp6(6),e.Q6J("ngIf",(null==(_=i.paymentForm.get("transactioncode"))?null:_.invalid)&&(null==(_=i.paymentForm.get("transactioncode"))?null:_.touched)),e.xp6(19),e.Q6J("ngIf",(null==(g=i.paymentForm.get("description"))?null:g.invalid)&&(null==(g=i.paymentForm.get("description"))?null:g.touched)),e.xp6(10),e.Q6J("ngIf","service"===(null==(P=i.paymentForm.get("serviceorproduct"))?null:P.value)),e.xp6(1),e.Q6J("ngIf","product"===(null==(q=i.paymentForm.get("serviceorproduct"))?null:q.value)),e.xp6(1),e.Q6J("ngIf",i.paymentId)("ngIfElse",a)}},dependencies:[s.sg,s.O5,c._Y,c.YN,c.Kr,c.Fj,c.wV,c.EJ,c._,c.JJ,c.JL,c.sg,c.u,c.x0,c.CE,h.A,y.w9,y.jq,d.rH]}),n})();var le=m(7556);function me(n,o){1&n&&(e.ynx(0),e.TgZ(1,"div",8),e._UZ(2,"app-sul-loader"),e.qZA(),e.BQk())}function se(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"div",8),e._UZ(2,"app-error-occured",10),e.qZA(),e.BQk()),2&n){const t=e.oxw(2);e.xp6(2),e.Q6J("errorMessage",t.errorMessage)}}function de(n,o){if(1&n&&(e.ynx(0),e._uU(1),e.BQk()),2&n){const t=e.oxw(5);e.xp6(1),e.hij(" - ",t.detailPayment.customerid.companyName," ")}}function pe(n,o){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&n){const t=e.oxw(5);e.xp6(1),e.AsE(" ",t.detailPayment.customerid.address.state,", ",t.detailPayment.customerid.address.country," ")}}function ue(n,o){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&n){const t=e.oxw(5);e.xp6(1),e.hij(" ",t.detailPayment.customerid.email," ")}}function _e(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"div"),e._uU(2),e.YNc(3,de,2,1,"ng-container",21),e.qZA(),e.YNc(4,pe,2,2,"div",21),e.TgZ(5,"div",17),e._uU(6),e.qZA(),e.YNc(7,ue,2,1,"div",21),e.BQk()),2&n){const t=e.oxw(4);e.xp6(2),e.AsE(" ",t.detailPayment.customerid.firstName," ",t.detailPayment.customerid.lastName," "),e.xp6(1),e.Q6J("ngIf",t.detailPayment.customerid.companyName),e.xp6(1),e.Q6J("ngIf",t.detailPayment.customerid.address.country),e.xp6(2),e.hij(" ",t.detailPayment.customerid.phoneNumber," "),e.xp6(1),e.Q6J("ngIf",t.detailPayment.customerid.email)}}function ge(n,o){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&n){const t=e.oxw(4);e.xp6(1),e.hij(" ",t.detailPayment.recipient," ")}}function ye(n,o){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&n){const t=e.oxw(4);e.xp6(1),e.hij(" ",null==t.detailPayment||null==t.detailPayment.invoicelsoid?null:t.detailPayment.invoicelsoid.recipient," ")}}function ve(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"tr")(2,"td"),e._uU(3),e.qZA(),e.TgZ(4,"td",24),e._uU(5),e.qZA(),e.TgZ(6,"td",37),e._uU(7),e.ALo(8,"currency"),e.qZA()(),e.BQk()),2&n){const t=o.$implicit,i=o.index;e.xp6(3),e.Oqu(i+1),e.xp6(2),e.Oqu(t.name),e.xp6(2),e.Oqu(e.xi3(8,3,t.price,"Ksh. "))}}function fe(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"div",34)(2,"table",35)(3,"thead",36)(4,"tr")(5,"th"),e._uU(6,"#"),e.qZA(),e.TgZ(7,"th"),e._uU(8,"DESCRIPTION"),e.qZA(),e.TgZ(9,"th",37),e._uU(10,"AMOUNT"),e.qZA()()(),e.TgZ(11,"tbody"),e.YNc(12,ve,9,6,"ng-container",27),e.qZA()()(),e.BQk()),2&n){const t=e.oxw(4);e.xp6(12),e.Q6J("ngForOf",t.detailPayment.service)}}function he(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"tr")(2,"td"),e._uU(3),e.qZA(),e.TgZ(4,"td",24),e._uU(5),e.qZA(),e.TgZ(6,"td",37),e._uU(7),e.qZA(),e.TgZ(8,"td",37),e._uU(9),e.ALo(10,"currency"),e.qZA(),e.TgZ(11,"td",37),e._uU(12),e.ALo(13,"currency"),e.qZA()(),e.BQk()),2&n){const t=o.$implicit,i=o.index;e.xp6(3),e.Oqu(i+1),e.xp6(2),e.Oqu(t.name),e.xp6(2),e.Oqu(t.noOfitems),e.xp6(2),e.Oqu(e.xi3(10,5,t.unitprice,"Ksh. ")),e.xp6(3),e.hij(" ",e.xi3(13,8,t.noOfitems*t.unitprice,"Ksh. ")," ")}}function Ze(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"div",34)(2,"table",35)(3,"thead",36)(4,"tr")(5,"th"),e._uU(6,"#"),e.qZA(),e.TgZ(7,"th"),e._uU(8,"DESCRIPTION"),e.qZA(),e.TgZ(9,"th",37),e._uU(10,"QTY"),e.qZA(),e.TgZ(11,"th",37),e._uU(12,"UNIT PRICE"),e.qZA(),e.TgZ(13,"th",37),e._uU(14,"TOTAL"),e.qZA()()(),e.TgZ(15,"tbody"),e.YNc(16,he,14,11,"ng-container",27),e.qZA()()(),e.BQk()),2&n){const t=e.oxw(4);e.xp6(16),e.Q6J("ngForOf",t.detailPayment.products)}}function xe(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"div",38)(2,"div",29),e._uU(3),e.qZA(),e.TgZ(4,"div",30),e._uU(5),e.ALo(6,"currency"),e.qZA()(),e.BQk()),2&n){const t=o.$implicit;e.xp6(3),e.hij("",t.name,": "),e.xp6(2),e.Oqu(e.xi3(6,2,t.ammount,"Ksh. "))}}function Ae(n,o){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&n){const t=e.oxw(4);e.xp6(1),e.AsE(" ",t.detailPayment.customerid.firstName," ",t.detailPayment.customerid.lastName," ")}}function Te(n,o){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&n){const t=e.oxw(4);e.xp6(1),e.hij(" ",t.detailPayment.recipient," ")}}function Pe(n,o){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&n){const t=e.oxw(4);e.xp6(1),e.hij(" ",null==t.detailPayment||null==t.detailPayment.invoicelsoid?null:t.detailPayment.invoicelsoid.recipient," ")}}function qe(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"div",12)(2,"div",13)(3,"div",14)(4,"h2",15),e._uU(5,"Payment"),e.qZA()(),e.TgZ(6,"div",16)(7,"div"),e._uU(8),e.qZA(),e.TgZ(9,"div"),e._uU(10),e.qZA(),e.TgZ(11,"div",17),e._uU(12),e.qZA(),e.TgZ(13,"div"),e._uU(14),e.qZA()()()(),e.TgZ(15,"div",18)(16,"div",19),e._uU(17," Paid To: "),e.qZA(),e.TgZ(18,"div",20)(19,"div",14),e.YNc(20,_e,8,6,"ng-container",21),e.YNc(21,ge,2,1,"div",21),e.YNc(22,ye,2,1,"div",21),e.qZA(),e.TgZ(23,"div",14)(24,"div",1)(25,"div",22)(26,"div"),e._uU(27,"Payment #:"),e.qZA(),e.TgZ(28,"div"),e._uU(29,"Transaction Code:"),e.qZA(),e.TgZ(30,"div"),e._uU(31,"Payment Date:"),e.qZA(),e.TgZ(32,"div"),e._uU(33,"Mode Of Payment:"),e.qZA()(),e.TgZ(34,"div",23)(35,"div"),e._uU(36),e.qZA(),e.TgZ(37,"div"),e._uU(38),e.qZA(),e.TgZ(39,"div"),e._uU(40),e.ALo(41,"date"),e.qZA(),e.TgZ(42,"div",24),e._uU(43),e.qZA()()()()()(),e.YNc(44,fe,13,1,"ng-container",21),e.YNc(45,Ze,17,1,"ng-container",21),e.TgZ(46,"div",25)(47,"div",26),e.YNc(48,xe,7,5,"ng-container",27),e.TgZ(49,"div",28)(50,"div",29),e._uU(51,"TOTAL: "),e.qZA(),e.TgZ(52,"div",30),e._uU(53),e.ALo(54,"currency"),e.qZA()()()(),e.TgZ(55,"div",0)(56,"div",20)(57,"div",14)(58,"div",31),e._uU(59,"Supplier"),e.qZA(),e.YNc(60,Ae,2,2,"div",21),e.YNc(61,Te,2,1,"div",21),e.YNc(62,Pe,2,1,"div",21),e.TgZ(63,"div",32),e._uU(64," ........................................... "),e.qZA(),e.TgZ(65,"div"),e._uU(66),e.ALo(67,"date"),e.qZA()(),e.TgZ(68,"div",16)(69,"div",31),e._uU(70,"Issuer"),e.qZA(),e.TgZ(71,"div"),e._uU(72),e.qZA(),e.TgZ(73,"div",32),e._uU(74," ........................................... "),e.qZA(),e.TgZ(75,"div"),e._uU(76),e.ALo(77,"date"),e.qZA()()()(),e.TgZ(78,"div",0)(79,"div",33),e._uU(80,"Terms"),e.qZA(),e.TgZ(81,"div"),e._uU(82," The Payments can not be reversed once received "),e.qZA()(),e.BQk()),2&n){const t=e.oxw(3);e.xp6(8),e.hij(" ",t.currentUser.company.name," "),e.xp6(2),e.AsE(" ",t.currentUser.company.address.state,", ",t.currentUser.company.address.country," "),e.xp6(2),e.hij(" ",t.currentUser.company.phoneNumber," "),e.xp6(2),e.hij(" ",t.currentUser.company.email," "),e.xp6(6),e.Q6J("ngIf",null==t.detailPayment?null:t.detailPayment.customerid),e.xp6(1),e.Q6J("ngIf",null==t.detailPayment?null:t.detailPayment.recipient),e.xp6(1),e.Q6J("ngIf",null==t.detailPayment||null==t.detailPayment.invoicelsoid?null:t.detailPayment.invoicelsoid.recipient),e.xp6(14),e.hij("",t.detailPayment.uniqueNumber,"\xa0"),e.xp6(2),e.hij("",t.detailPayment.transactioncode,"\xa0"),e.xp6(2),e.hij("",e.lcZ(41,23,t.detailPayment.paymentdate),"\xa0"),e.xp6(3),e.hij("",t.detailPayment.modeofpay,"\xa0"),e.xp6(1),e.Q6J("ngIf",t.detailPayment.service&&t.detailPayment.service.length),e.xp6(1),e.Q6J("ngIf",t.detailPayment.products&&t.detailPayment.products.length),e.xp6(3),e.Q6J("ngForOf",t.operatingCost),e.xp6(5),e.Oqu(e.xi3(54,25,t.totalamount,"Ksh. ")),e.xp6(7),e.Q6J("ngIf",t.detailPayment.customerid),e.xp6(1),e.Q6J("ngIf",t.detailPayment.recipient),e.xp6(1),e.Q6J("ngIf",null==t.detailPayment||null==t.detailPayment.invoicelsoid?null:t.detailPayment.invoicelsoid.recipient),e.xp6(4),e.hij(" ",e.lcZ(67,28,t.today)," "),e.xp6(6),e.AsE(" ",t.currentUser.firstName," ",t.currentUser.lastName," "),e.xp6(4),e.hij(" ",e.lcZ(77,30,t.today)," ")}}function be(n,o){1&n&&e._UZ(0,"app-no-data-found",39),2&n&&e.Q6J("dataLabel","Payment")}function Ce(n,o){if(1&n&&(e.YNc(0,qe,83,32,"ng-container",6),e.YNc(1,be,1,1,"ng-template",null,11,e.W1O)),2&n){const t=e.MAs(2),i=e.oxw(2);e.Q6J("ngIf",i.detailPayment)("ngIfElse",t)}}function Ue(n,o){if(1&n&&(e.YNc(0,se,3,1,"ng-container",6),e.YNc(1,Ce,3,2,"ng-template",null,9,e.W1O)),2&n){const t=e.MAs(2),i=e.oxw();e.Q6J("ngIf",i.errorMessage)("ngIfElse",t)}}const Ne=[{path:"",component:w},{path:"add",component:T},{path:"edit/:id",component:T},{path:"view/:id",component:(()=>{class n{constructor(t,i,a){this.paymentService=t,this.route=i,this.authService=a,this.loading=!1,this.totalamount=0,this.today=new Date,this.operatingCost=[{name:"SUBTOTAL",ammount:0,incrme:!0},{name:"DISCOUNT",ammount:0,incrme:!1},{name:"TOTAL TAX",ammount:0,incrme:!0}]}ngOnInit(){this.paymentId=this.route.snapshot.paramMap.get("id"),this.paymentId&&this.getReceipt(this.paymentId),this.getCurrentUser()}getCurrentUser(){this.currentUser=JSON.parse(this.authService.getUseriInfo())}getReceipt(t){this.loading=!0,this.paymentService.getPaymentPrint(t).subscribe({next:i=>{this.detailPayment=i,this.detailPayment.products.length&&(this.totalamount=this.prdtotal(this.detailPayment.products)),this.detailPayment.service.length&&(this.totalamount=this.servtotal(this.detailPayment.service))},error:i=>{this.errorMessage=i,this.loading=!1},complete:()=>{this.loading=!1}})}prdtotal(t){let i=0;for(let a=0;a<t.length;a++){const r=t[a];i+=r.noOfitems*r.unitprice}return i}servtotal(t){let i=0;for(let a=0;a<t.length;a++)i+=t[a].price;return i}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(f.t),e.Y36(d.gz),e.Y36(le.e))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-details-payment"]],decls:13,vars:3,consts:[[1,"py-4"],[1,"d-flex"],[1,"flex-grow-1"],["routerLink","/accounts/payments",1,"btn","btn-outline-primary","btn-sm"],[1,"btn","btn-outline-success","btn-sm","ms-2"],[1,"btn","btn-outline-warning","btn-sm","ms-2",3,"routerLink"],[4,"ngIf","ngIfElse"],["loadedContent",""],[1,"py-3"],["noError",""],[3,"errorMessage"],["nodata",""],[1,"py-4","mt-2"],[1,"d-flex","align-items-center"],[1,"col-6"],[1,"detailsheader"],[1,"col-6","text-end"],[1,"mt-1"],[1,"my-4"],[1,"pb-1","text-secondary"],[1,"row"],[4,"ngIf"],[1,"flex-grow-1","text-end","text-dark"],[1,"text-end","ps-2"],[1,"text-capitalize"],[1,"row","justify-content-end"],[1,"col-lg-4","col-sm-8"],[4,"ngFor","ngForOf"],[1,"d-flex","operatingCost","fw-bold","mb-1","mt-2"],[1,"flex-grow-1","text-end"],[1,"ps-4","pe-2","text-end"],[1,""],[1,"pt-2"],[1,"fw-bold"],[1,"table-responsive"],[1,"table","table-bordered"],[1,"bg-light"],[1,"text-end"],[1,"d-flex","operatingCost","mb-1"],[3,"dataLabel"]],template:function(t,i){if(1&t&&(e.TgZ(0,"div",0)(1,"div",1),e._UZ(2,"div",2),e.TgZ(3,"div")(4,"button",3),e._uU(5," List Payment"),e.qZA(),e.TgZ(6,"button",4),e._uU(7," Print Payment"),e.qZA(),e.TgZ(8,"button",5),e._uU(9," Edit Payment "),e.qZA()()(),e.YNc(10,me,3,0,"ng-container",6),e.YNc(11,Ue,3,2,"ng-template",null,7,e.W1O),e.qZA()),2&t){const a=e.MAs(12);e.xp6(8),e.MGl("routerLink","/accounts/payments/edit/",i.paymentId,""),e.xp6(2),e.Q6J("ngIf",i.loading)("ngIfElse",a)}},dependencies:[s.sg,s.O5,x.S,A.i,h.A,d.rH,s.H9,s.uU]}),n})()},{path:"**",redirectTo:"",pathMatch:"full"}];let Ie=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[s.ez,c.u5,c.UX,b.C,v.JX,y.A0,d.Bz.forChild(Ne)]}),n})()}}]);
"use strict";(self.webpackChunkbiz_ke_frontend=self.webpackChunkbiz_ke_frontend||[]).push([[128],{8128:(dt,Z,d)=>{d.r(Z),d.d(Z,{ReceiptModule:()=>ct});var l=d(9808),m=d(1083),c=d(3075),f=d(7423),b=d(508),g=d(6856),_=d(7322),A=d(5245),v=d(7531),T=d(4107),x=d(7261),h=d(4376),P=d(6186),U=d(4586),C=d(5906),t=d(5e3),p=d(2340),R=d(520);let y=(()=>{class r{constructor(e){this._http=e}addReceipt(e){return this._http.post(p.N.apiUrl+"receipt/",e)}addOneReceipt(e){return this._http.post(p.N.apiUrl+"receipt/one/",e)}updatReceipt(e,i){return this._http.put(p.N.apiUrl+"receipt/"+i,e)}updatOneReceipt(e,i){return this._http.patch(p.N.apiUrl+"receipt/"+i,e)}delReceipt(e){return this._http.delete(p.N.apiUrl+"receipt/"+e)}delOneReceipt(e){return this._http.delete(p.N.apiUrl+"receipt/one/"+e)}getReceipt(e){return this._http.get(p.N.apiUrl+"receipt/"+e)}getReceipts(e){return this._http.get(p.N.apiUrl+"receipt/",{params:e})}getClients(e){return this._http.get(p.N.apiUrl+"clients/",{params:e})}getProducts(e){return this._http.get(p.N.apiUrl+"product/",{params:e})}}return r.\u0275fac=function(e){return new(e||r)(t.LFG(R.eN))},r.\u0275prov=t.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();function q(r,a){if(1&r&&(t.TgZ(0,"div",31),t._uU(1),t.qZA()),2&r){const e=t.oxw();t.xp6(1),t.hij(" ",e.errorMessage," ")}}function N(r,a){if(1&r&&(t.ynx(0),t.TgZ(1,"ng-option",32),t._uU(2),t.qZA(),t.BQk()),2&r){const e=a.$implicit;t.xp6(1),t.Q6J("value",1*e.id),t.xp6(1),t.hij(" ",e.fullname.toUpperCase(),"")}}function k(r,a){if(1&r&&(t.ynx(0),t.TgZ(1,"ng-option",11),t._uU(2,"Please Select A Client"),t.qZA(),t.YNc(3,N,3,2,"ng-container",12),t.BQk()),2&r){const e=t.oxw();t.xp6(3),t.Q6J("ngForOf",e.clients)}}function S(r,a){if(1&r&&(t.ynx(0),t.TgZ(1,"ng-option",32),t._uU(2),t.qZA(),t.BQk()),2&r){const e=a.$implicit;t.xp6(1),t.Q6J("value",1*e.value),t.xp6(1),t.hij(" ",e.name,"")}}function J(r,a){if(1&r&&(t.ynx(0),t.TgZ(1,"ng-option",32),t._uU(2),t.qZA(),t.BQk()),2&r){const e=a.$implicit;t.xp6(1),t.Q6J("value",1*e.id),t.xp6(1),t.HOy(" ",e.categoryname.toUpperCase()," - ",e.brand.toUpperCase()," - ",e.prdtype.toUpperCase()," - ",e.calibration.toUpperCase()," ")}}function I(r,a){if(1&r&&(t.ynx(0),t.TgZ(1,"ng-option",11),t._uU(2,"Please Select A Product"),t.qZA(),t.YNc(3,J,3,5,"ng-container",12),t.BQk()),2&r){const e=t.oxw(2);t.xp6(3),t.Q6J("ngForOf",e.products)}}function M(r,a){if(1&r){const e=t.EpF();t.TgZ(0,"div",33)(1,"div",34)(2,"div",35)(3,"div",13)(4,"div",36)(5,"ng-select",37),t.NdJ("change",function(){const o=t.CHM(e).index;return t.oxw().changeProduct(o)}),t.YNc(6,I,4,1,"ng-container",9),t.qZA()(),t.TgZ(7,"div",38)(8,"mat-form-field",14)(9,"mat-label"),t._uU(10," No Of Items"),t.qZA(),t.TgZ(11,"input",39),t.NdJ("keyup",function(n){const s=t.CHM(e).index;return t.oxw().noitmKeyUp(n.target,s)}),t.qZA()()(),t.TgZ(12,"div",38)(13,"mat-form-field",14)(14,"mat-label"),t._uU(15,"Unit Price"),t.qZA(),t.TgZ(16,"input",40),t.NdJ("keyup",function(n){const s=t.CHM(e).index;return t.oxw().unitKeyUp(n.target,s)}),t.qZA()()(),t.TgZ(17,"div",41)(18,"mat-form-field",14)(19,"mat-label"),t._uU(20,"Total Amount"),t.qZA(),t.TgZ(21,"input",42),t.NdJ("keyup",function(n){const s=t.CHM(e).index;return t.oxw().totlKeyup(n.target,s)}),t.qZA()()()()(),t.TgZ(22,"div",43)(23,"button",44),t.NdJ("click",function(){const o=t.CHM(e).index;return t.oxw().delProduct(o)}),t._UZ(24,"i",45),t.qZA()()()()}if(2&r){const e=a.index,i=t.oxw();t.Q6J("formGroupName",e),t.xp6(6),t.Q6J("ngIf",i.products),t.xp6(5),t.Q6J("errorStateMatcher",i.matcher),t.xp6(5),t.Q6J("errorStateMatcher",i.matcher),t.xp6(5),t.Q6J("errorStateMatcher",i.matcher),t.xp6(2),t.Q6J("disabled",0==e)}}function Q(r,a){1&r&&(t.ynx(0),t._UZ(1,"i",46),t.TgZ(2,"span",43),t._uU(3,"Loading..."),t.qZA(),t.BQk())}function F(r,a){1&r&&t._uU(0," Add Receipt ")}let E=(()=>{class r{constructor(e,i,n,o){this.receFb=e,this.router=i,this.snakBar=n,this.payServ=o,this.matcher=new C.n,this.loading=!1,this.today=new Date,this.modeOfPay=[{name:"CASH",value:1},{name:"MPESA",value:2},{name:"PAYPAL",value:3},{name:"CHEQUE",value:4}],this.receForm=this.receFb.group({clisupid:["",c.kI.required],modeofpay:["",c.kI.required],paymentdate:[this.today,c.kI.required],transactioncode:["",c.kI.required],products:this.receFb.array([]),details:[""]})}ngOnInit(){this.loadProd(),this.loadClients(),this.addProduct(),this.receForm.valueChanges.subscribe(()=>{this.errorMessage=!1})}get getProducts(){return this.receForm.get("products")}addProduct(){const e=this.receFb.group({productid:["",c.kI.required],noitems:[0,c.kI.required],unitprice:[0,c.kI.required],totalamount:[0,c.kI.required]});this.getProducts.push(e)}delProduct(e){this.getProducts.removeAt(e)}loadProd(){this.payServ.getProducts({page:1,pageSize:10}).subscribe({next:e=>this.products=e.results,error:e=>this.errorHandle(e)})}loadClients(){this.payServ.getClients({page:1,pageSize:10}).subscribe({next:e=>this.clients=e.results,error:e=>this.errorHandle(e)})}addReceipt(){this.loading=!0;let e=this.receForm.value;e.paymentdate=(0,l.p6)(e.paymentdate,"yyyy-MM-dd","en-US"),this.payServ.addReceipt(e).subscribe({next:i=>this.handleResp(i),error:i=>this.errorHandle(i)})}openSnakBar(e,i){this.snakBar.open(e,i,{duration:2500})}handleResp(e){this.loading=!1,this.openSnakBar(e.message,"Dismiss"),this.router.navigate(["/income/receipt"])}errorHandle(e){this.loading=!1,this.errorMessage=e}unitKeyUp(e,i){var n,o;const s=parseInt(null===(n=this.getProducts.at(i).get("noitems"))||void 0===n?void 0:n.value);null===(o=this.getProducts.at(i).get("totalamount"))||void 0===o||o.setValue(e.value*s)}totlKeyup(e,i){var n,o;const s=parseInt(null===(n=this.getProducts.at(i).get("noitems"))||void 0===n?void 0:n.value)||1;null===(o=this.getProducts.at(i).get("unitprice"))||void 0===o||o.setValue(e.value/s)}noitmKeyUp(e,i){var n,o;const s=parseInt(null===(n=this.getProducts.at(i).get("unitprice"))||void 0===n?void 0:n.value);null===(o=this.getProducts.at(i).get("totalamount"))||void 0===o||o.setValue(e.value*s)}changeProduct(e){var i,n;const o=null===(i=this.getProducts.at(e).get("productid"))||void 0===i?void 0:i.value,s=this.products.find(u=>u.id==o);null===(n=this.getProducts.at(e).get("unitprice"))||void 0===n||n.setValue(s.defsellprice)}}return r.\u0275fac=function(e){return new(e||r)(t.Y36(c.qu),t.Y36(m.F0),t.Y36(x.ux),t.Y36(y))},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-add-receipt"]],decls:48,vars:11,consts:[[1,"d-lg-flex","text-secondary","py-2"],[1,"flex-grow-1"],["type","button","routerLink","/income/receipt",1,"btn","btn-outline-success","btn-sm"],["aria-hidden","true",1,"fa","fa-chevron-left"],[3,"formGroup"],["class","alert alert-danger my-3",4,"ngIf"],[1,"row","pb-4"],[1,"col-lg-6"],["formControlName","clisupid"],[4,"ngIf"],["formControlName","modeofpay"],["value","","disabled",""],[4,"ngFor","ngForOf"],[1,"row"],["appearance","outline",1,"w-100"],["matInput","","placeholder","Enter Transaction code","formControlName","transactioncode",3,"errorStateMatcher"],["matInput","","formControlName","paymentdate",3,"matDatepicker"],["matSuffix","",3,"for"],["paydateid",""],[1,"col-lg-12"],["matInput","","formControlName","details"],["formArrayName","products"],[1,"pt-2","pb-1"],[1,"bg-secondary-light","py-2"],[3,"formGroupName",4,"ngFor","ngForOf"],[1,"text-end"],["type","button",1,"btn","btn-primary","my-2",3,"click"],[1,"fa","fa-plus"],["mat-flat-button","","color","primary","type","button",1,"me-3",3,"disabled","click"],[4,"ngIf","ngIfElse"],["notload",""],[1,"alert","alert-danger","my-3"],[3,"value"],[3,"formGroupName"],[1,"d-flex"],[1,"flex-grow-1","me-2"],[1,"col-lg-5","pt-1"],["formControlName","productid",3,"change"],[1,"col-lg-2"],["matInput","","placeholder","Enter No Of Items e.g. 50","formControlName","noitems",3,"errorStateMatcher","keyup"],["matInput","","placeholder","Enter Unit","formControlName","unitprice",3,"errorStateMatcher","keyup"],[1,"col-lg-3"],["matInput","","placeholder","Enter Total Amount","formControlName","totalamount",3,"errorStateMatcher","keyup"],[1,""],[1,"btn","btn-danger",3,"disabled","click"],[1,"fa","fa-trash"],[1,"fa","fa-spinner","fa-spin","fa-1x","me-2"]],template:function(e,i){if(1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"button",2),t._UZ(3,"i",3),t._uU(4," Back "),t.qZA()()(),t.TgZ(5,"form",4),t.YNc(6,q,2,1,"div",5),t.TgZ(7,"div",6)(8,"div",7)(9,"ng-select",8),t.YNc(10,k,4,1,"ng-container",9),t.qZA()(),t.TgZ(11,"div",7)(12,"ng-select",10)(13,"ng-option",11),t._uU(14,"Select Mode OF Payment"),t.qZA(),t.YNc(15,S,3,2,"ng-container",12),t.qZA()()(),t.TgZ(16,"div",13)(17,"div",7)(18,"mat-form-field",14)(19,"mat-label"),t._uU(20,"Transaction Code"),t.qZA(),t._UZ(21,"input",15),t.qZA()(),t.TgZ(22,"div",7)(23,"mat-form-field",14)(24,"mat-label"),t._uU(25,"Payment Date"),t.qZA(),t._UZ(26,"input",16)(27,"mat-datepicker-toggle",17)(28,"mat-datepicker",null,18),t.qZA()()(),t.TgZ(30,"div",13)(31,"div",19)(32,"mat-form-field",14)(33,"mat-label"),t._uU(34,"Payment Description"),t.qZA(),t._UZ(35,"textarea",20),t.qZA()()(),t.TgZ(36,"div",21)(37,"div",22),t._uU(38," Add Products"),t.qZA(),t.TgZ(39,"div",23),t.YNc(40,M,25,6,"div",24),t.qZA(),t.TgZ(41,"div",25)(42,"button",26),t.NdJ("click",function(){return i.addProduct()}),t._UZ(43,"i",27),t.qZA()()(),t.TgZ(44,"button",28),t.NdJ("click",function(){return i.addReceipt()}),t.YNc(45,Q,4,0,"ng-container",29),t.YNc(46,F,1,0,"ng-template",null,30,t.W1O),t.qZA()()),2&e){const n=t.MAs(29),o=t.MAs(47);t.xp6(5),t.Q6J("formGroup",i.receForm),t.xp6(1),t.Q6J("ngIf",i.errorMessage),t.xp6(4),t.Q6J("ngIf",i.clients),t.xp6(5),t.Q6J("ngForOf",i.modeOfPay),t.xp6(6),t.Q6J("errorStateMatcher",i.matcher),t.xp6(5),t.Q6J("matDatepicker",n),t.xp6(1),t.Q6J("for",n),t.xp6(13),t.Q6J("ngForOf",i.getProducts.controls),t.xp6(4),t.Q6J("disabled",i.receForm.invalid||i.errorMessage||i.loading),t.xp6(1),t.Q6J("ngIf",i.loading)("ngIfElse",o)}},directives:[m.rH,c._Y,c.JL,c.sg,l.O5,h.w9,c.JJ,c.u,h.jq,l.sg,_.KE,_.hX,v.Nt,c.Fj,g.hl,g.nW,_.R9,g.Mq,c.CE,c.x0,f.lW],styles:[".mat-form-field-flex>.mat-form-field-infix{padding:.5em 0!important}  .mat-form-field-label-wrapper{top:-1.4em}  .mat-form-field-appearance-outline.mat-form-field-can-float.mat-form-field-should-float .mat-form-field-label{transform:translateY(-1.1em) scale(.75);width:133.33333%}"]}),r})();function O(r,a){if(1&r&&(t.TgZ(0,"div",30),t._uU(1),t.qZA()),2&r){const e=t.oxw();t.xp6(1),t.hij(" ",e.errorMessage," ")}}function w(r,a){if(1&r&&(t.ynx(0),t.TgZ(1,"ng-option",31),t._uU(2),t.qZA(),t.BQk()),2&r){const e=a.$implicit;t.xp6(1),t.Q6J("value",1*e.id),t.xp6(1),t.hij(" ",e.fullname.toUpperCase(),"")}}function Y(r,a){if(1&r&&(t.ynx(0),t.TgZ(1,"ng-option",11),t._uU(2,"Please Select A Supplier"),t.qZA(),t.YNc(3,w,3,2,"ng-container",12),t.BQk()),2&r){const e=t.oxw();t.xp6(3),t.Q6J("ngForOf",e.clients)}}function H(r,a){if(1&r&&(t.ynx(0),t.TgZ(1,"ng-option",31),t._uU(2),t.qZA(),t.BQk()),2&r){const e=a.$implicit;t.xp6(1),t.Q6J("value",1*e.value),t.xp6(1),t.hij(" ",e.name,"")}}function L(r,a){if(1&r&&(t.ynx(0),t.TgZ(1,"ng-option",31),t._uU(2),t.qZA(),t.BQk()),2&r){const e=a.$implicit;t.xp6(1),t.Q6J("value",1*e.id),t.xp6(1),t.HOy(" ",e.categoryname.toUpperCase()," - ",e.brand.toUpperCase()," - ",e.prdtype.toUpperCase()," - ",e.calibration.toUpperCase()," ")}}function B(r,a){if(1&r&&(t.ynx(0),t.TgZ(1,"ng-option",11),t._uU(2,"Please Select A Product"),t.qZA(),t.YNc(3,L,3,5,"ng-container",12),t.BQk()),2&r){const e=t.oxw(2);t.xp6(3),t.Q6J("ngForOf",e.products)}}function D(r,a){if(1&r){const e=t.EpF();t.TgZ(0,"div",46)(1,"button",47),t.NdJ("click",function(){t.CHM(e);const n=t.oxw().index;return t.oxw().editSinglPay(n)}),t._UZ(2,"i",48),t.qZA()()}if(2&r){const e=t.oxw().index,i=t.oxw();t.xp6(1),t.Q6J("disabled",i.getProducts.at(e).pristine||i.getProducts.at(e).invalid)}}function K(r,a){if(1&r){const e=t.EpF();t.TgZ(0,"div",46)(1,"button",49),t.NdJ("click",function(){t.CHM(e);const n=t.oxw().index;return t.oxw().saveProduct(n)}),t._UZ(2,"i",27),t.qZA()()}if(2&r){const e=t.oxw().index,i=t.oxw();t.xp6(1),t.Q6J("disabled",i.getProducts.at(e).invalid)}}function j(r,a){if(1&r){const e=t.EpF();t.TgZ(0,"div",32)(1,"div",33)(2,"div",34)(3,"div",13)(4,"div",35)(5,"ng-select",36),t.NdJ("change",function(){const o=t.CHM(e).index;return t.oxw().changeProduct(o)}),t.YNc(6,B,4,1,"ng-container",9),t.qZA()(),t.TgZ(7,"div",37)(8,"mat-form-field",14)(9,"mat-label"),t._uU(10," No Of Items"),t.qZA(),t.TgZ(11,"input",38),t.NdJ("keyup",function(n){const s=t.CHM(e).index;return t.oxw().noitmKeyUp(n.target,s)}),t.qZA()()(),t.TgZ(12,"div",37)(13,"mat-form-field",14)(14,"mat-label"),t._uU(15,"Unit Price"),t.qZA(),t.TgZ(16,"input",39),t.NdJ("keyup",function(n){const s=t.CHM(e).index;return t.oxw().unitKeyUp(n.target,s)}),t.qZA()()(),t.TgZ(17,"div",40)(18,"mat-form-field",14)(19,"mat-label"),t._uU(20,"Total Amount"),t.qZA(),t.TgZ(21,"input",41),t.NdJ("keyup",function(n){const s=t.CHM(e).index;return t.oxw().totlKeyup(n.target,s)}),t.qZA()()()()(),t.TgZ(22,"div",42)(23,"div",33)(24,"div",42)(25,"button",43),t.NdJ("click",function(){const o=t.CHM(e).index;return t.oxw().delOnePrd(o)}),t._UZ(26,"i",44),t.qZA()(),t.YNc(27,D,3,1,"div",45),t.YNc(28,K,3,1,"div",45),t.qZA()()()()}if(2&r){const e=a.index,i=t.oxw();let n,o;t.Q6J("formGroupName",e),t.xp6(6),t.Q6J("ngIf",i.products),t.xp6(5),t.Q6J("errorStateMatcher",i.matcher),t.xp6(5),t.Q6J("errorStateMatcher",i.matcher),t.xp6(5),t.Q6J("errorStateMatcher",i.matcher),t.xp6(6),t.Q6J("ngIf",null==(n=i.getProducts.at(e).get("transacid"))?null:n.value),t.xp6(1),t.Q6J("ngIf",!(null!=(o=i.getProducts.at(e).get("transacid"))&&o.value))}}let z=(()=>{class r{constructor(e,i,n,o,s){this.receFb=e,this.router=i,this.snakBar=n,this.payServ=o,this.route=s,this.matcher=new C.n,this.loading=!1,this.today=new Date,this.modeOfPay=[{name:"CASH",value:1},{name:"MPESA",value:2},{name:"PAYPAL",value:3},{name:"CHEQUE",value:4}],this.receForm=this.receFb.group({clisupid:["",c.kI.required],modeofpay:["",c.kI.required],paymentdate:["",c.kI.required],transactioncode:["",c.kI.required],products:this.receFb.array([]),details:[""]})}ngOnInit(){this.loadProd(),this.loadClients(),this.unqpayids=this.route.snapshot.paramMap.get("id"),this.unqpayids&&this.loadPay(),this.receForm.valueChanges.subscribe(()=>{this.errorMessage=!1})}loadProd(){this.payServ.getProducts({page:1,pageSize:10}).subscribe({next:e=>this.products=e.results,error:e=>this.errorHandle(e)})}loadClients(){this.payServ.getClients({page:1,pageSize:10}).subscribe({next:e=>this.clients=e.results,error:e=>this.errorHandle(e)})}loadPay(){this.loading=!0,this.payServ.getReceipt(this.unqpayids).subscribe({next:e=>this.respPayment(e),error:e=>this.errorHandle(e)})}get getProducts(){return this.receForm.get("products")}addProduct(e,i,n,o){const s=this.receFb.group({productid:[e||"",c.kI.required],transacid:[i],noitems:[n||0,[c.kI.required,c.kI.min(1)]],unitprice:[o/n||0,c.kI.required],totalamount:[o||0,[c.kI.required,c.kI.min(1)]]});this.getProducts.push(s)}delOnePrd(e){var i;const n=parseInt(null===(i=this.getProducts.at(e).get("transacid"))||void 0===i?void 0:i.value);n?(this.loading=!0,this.payServ.delOneReceipt(n).subscribe({next:o=>this.respOneDel(o),error:o=>this.errorHandle(o)})):this.getProducts.removeAt(e)}saveProduct(e){let i=this.receForm.value,n={};n.clisupid=i.clisupid,n.modeofpay=i.modeofpay,n.transactioncode=i.transactioncode,n.paymentdate=(0,l.p6)(i.paymentdate,"yyyy-MM-dd","en-US"),n.details=i.details,n.transacid=this.unqpayids;const o=Object.assign(Object.assign({},this.getProducts.at(e).value),n);this.payServ.addOneReceipt(o).subscribe({next:s=>this.respOneDel(s),error:s=>this.errorHandle(s)})}editSinglPay(e){this.loading=!0;const i=this.getProducts.at(e).value,n=parseInt(i.transacid);this.payServ.updatOneReceipt(i,n).subscribe({next:o=>this.respOneDel(o),error:o=>this.errorHandle(o)})}editOverallPay(){this.loading=!0;let e=this.receForm.value;e.paymentdate=(0,l.p6)(e.paymentdate,"yyyy-MM-dd","en-US"),this.payServ.updatReceipt(e,this.unqpayids).subscribe({next:i=>this.handleResp(i),error:i=>this.errorHandle(i)})}delOverallPay(){this.loading=!0,this.payServ.delReceipt(this.unqpayids).subscribe({next:e=>this.handleResp(e),error:e=>this.errorHandle(e)})}openSnakBar(e,i){this.snakBar.open(e,i,{duration:2500})}handleResp(e){this.loading=!1,this.openSnakBar(e.message,"Dismiss"),this.router.navigate(["/income/receipt"])}respOneDel(e){this.loading=!1,this.loadPay()}errorHandle(e){this.loading=!1,this.errorMessage=e}respPayment(e){this.loading=!1,this.getProducts.clear(),0==e.length?this.router.navigate(["/income/receipt"]):(this.receForm.patchValue({clisupid:e[0].clisupid,modeofpay:e[0].modeofpay,transactioncode:e[0].transactioncode,paymentdate:e[0].paymentdate,details:e[0].details}),e.forEach(i=>{this.addProduct(i.productid,i.id,i.noitems,i.totalamount)}))}unitKeyUp(e,i){var n,o;const s=parseInt(null===(n=this.getProducts.at(i).get("noitems"))||void 0===n?void 0:n.value);null===(o=this.getProducts.at(i).get("totalamount"))||void 0===o||o.setValue(e.value*s)}totlKeyup(e,i){var n,o;const s=parseInt(null===(n=this.getProducts.at(i).get("noitems"))||void 0===n?void 0:n.value)||1;null===(o=this.getProducts.at(i).get("unitprice"))||void 0===o||o.setValue(e.value/s)}noitmKeyUp(e,i){var n,o;const s=parseInt(null===(n=this.getProducts.at(i).get("unitprice"))||void 0===n?void 0:n.value);null===(o=this.getProducts.at(i).get("totalamount"))||void 0===o||o.setValue(e.value*s)}changeProduct(e){var i,n;const o=null===(i=this.getProducts.at(e).get("productid"))||void 0===i?void 0:i.value,s=this.products.find(u=>u.id==o);null===(n=this.getProducts.at(e).get("unitprice"))||void 0===n||n.setValue(s.defsellprice)}}return r.\u0275fac=function(e){return new(e||r)(t.Y36(c.qu),t.Y36(m.F0),t.Y36(x.ux),t.Y36(y),t.Y36(m.gz))},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-edit-receipt"]],decls:48,vars:10,consts:[[1,"d-lg-flex","text-secondary","py-2"],[1,"flex-grow-1"],["type","button","routerLink","/income/receipt",1,"btn","btn-outline-success","btn-sm"],["aria-hidden","true",1,"fa","fa-chevron-left"],[3,"formGroup"],["class","alert alert-danger my-3",4,"ngIf"],[1,"row","pb-4"],[1,"col-lg-6"],["formControlName","clisupid"],[4,"ngIf"],["formControlName","modeofpay"],["value","","disabled",""],[4,"ngFor","ngForOf"],[1,"row"],["appearance","outline",1,"w-100"],["matInput","","placeholder","Enter Transaction code","formControlName","transactioncode",3,"errorStateMatcher"],["matInput","","formControlName","paymentdate",3,"matDatepicker"],["matSuffix","",3,"for"],["paydateid",""],[1,"col-lg-12"],["matInput","","formControlName","details"],["formArrayName","products"],[1,"pt-2","pb-1"],[1,"bg-secondary-light","py-2"],[3,"formGroupName",4,"ngFor","ngForOf"],[1,"text-end"],["type","button",1,"btn","btn-primary","my-2",3,"click"],[1,"fa","fa-plus"],["type","button","mat-flat-button","","color","warn",1,"me-2",3,"disabled","click"],["type","button","mat-flat-button","","color","primary",3,"disabled","click"],[1,"alert","alert-danger","my-3"],[3,"value"],[3,"formGroupName"],[1,"d-flex"],[1,"flex-grow-1","me-2"],[1,"col-lg-5","pt-1"],["formControlName","productid",3,"change"],[1,"col-lg-2"],["matInput","","placeholder","Enter No Of Items e.g. 50","formControlName","noitems",3,"errorStateMatcher","keyup"],["matInput","","placeholder","Enter Unit","formControlName","unitprice",3,"errorStateMatcher","keyup"],[1,"col-lg-3"],["matInput","","placeholder","Enter Total Amount","formControlName","totalamount",3,"errorStateMatcher","keyup"],[1,""],[1,"btn","btn-danger",3,"click"],[1,"fa","fa-trash"],["class","ms-1",4,"ngIf"],[1,"ms-1"],[1,"btn","btn-success",3,"disabled","click"],[1,"fa","fa-save"],[1,"btn","btn-primary",3,"disabled","click"]],template:function(e,i){if(1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"button",2),t._UZ(3,"i",3),t._uU(4," Back "),t.qZA()()(),t.TgZ(5,"form",4),t.YNc(6,O,2,1,"div",5),t.TgZ(7,"div",6)(8,"div",7)(9,"ng-select",8),t.YNc(10,Y,4,1,"ng-container",9),t.qZA()(),t.TgZ(11,"div",7)(12,"ng-select",10)(13,"ng-option",11),t._uU(14,"Select Mode OF Payment"),t.qZA(),t.YNc(15,H,3,2,"ng-container",12),t.qZA()()(),t.TgZ(16,"div",13)(17,"div",7)(18,"mat-form-field",14)(19,"mat-label"),t._uU(20,"Transaction Code"),t.qZA(),t._UZ(21,"input",15),t.qZA()(),t.TgZ(22,"div",7)(23,"mat-form-field",14)(24,"mat-label"),t._uU(25,"Payment Date"),t.qZA(),t._UZ(26,"input",16)(27,"mat-datepicker-toggle",17)(28,"mat-datepicker",null,18),t.qZA()()(),t.TgZ(30,"div",13)(31,"div",19)(32,"mat-form-field",14)(33,"mat-label"),t._uU(34,"Payment Description"),t.qZA(),t._UZ(35,"textarea",20),t.qZA()()(),t.TgZ(36,"div",21)(37,"div",22),t._uU(38," Products"),t.qZA(),t.TgZ(39,"div",23),t.YNc(40,j,29,7,"div",24),t.qZA(),t.TgZ(41,"div",25)(42,"button",26),t.NdJ("click",function(){return i.addProduct()}),t._UZ(43,"i",27),t.qZA()()(),t.TgZ(44,"button",28),t.NdJ("click",function(){return i.delOverallPay()}),t._uU(45,"Delete"),t.qZA(),t.TgZ(46,"button",29),t.NdJ("click",function(){return i.editOverallPay()}),t._uU(47,"Save Changes "),t.qZA()()),2&e){const n=t.MAs(29);t.xp6(5),t.Q6J("formGroup",i.receForm),t.xp6(1),t.Q6J("ngIf",i.errorMessage),t.xp6(4),t.Q6J("ngIf",i.clients),t.xp6(5),t.Q6J("ngForOf",i.modeOfPay),t.xp6(6),t.Q6J("errorStateMatcher",i.matcher),t.xp6(5),t.Q6J("matDatepicker",n),t.xp6(1),t.Q6J("for",n),t.xp6(13),t.Q6J("ngForOf",i.getProducts.controls),t.xp6(4),t.Q6J("disabled",i.errorMessage||i.loading),t.xp6(2),t.Q6J("disabled",i.receForm.invalid||i.receForm.pristine)}},directives:[m.rH,c._Y,c.JL,c.sg,l.O5,h.w9,c.JJ,c.u,h.jq,l.sg,_.KE,_.hX,v.Nt,c.Fj,g.hl,g.nW,_.R9,g.Mq,c.CE,c.x0,f.lW],styles:[".mat-form-field-flex>.mat-form-field-infix{padding:.5em 0!important}  .mat-form-field-label-wrapper{top:-1.4em}  .mat-form-field-appearance-outline.mat-form-field-can-float.mat-form-field-should-float .mat-form-field-label{transform:translateY(-1.1em) scale(.75);width:133.33333%}"]}),r})();var V=d(1990),G=d(5876),X=d(4701),W=d(2818);function $(r,a){if(1&r&&(t.TgZ(0,"div",5),t._uU(1),t.qZA()),2&r){const e=t.oxw();t.xp6(1),t.hij(" ",e.errorMessage," ")}}const tt=function(r){return["edit/",r]};function et(r,a){if(1&r&&(t.TgZ(0,"tr",12)(1,"td",13),t._uU(2),t.qZA(),t.TgZ(3,"td",13),t._uU(4),t.qZA(),t.TgZ(5,"td",13),t._uU(6),t.qZA(),t.TgZ(7,"td",13),t._uU(8),t.ALo(9,"modeofpay"),t.qZA(),t.TgZ(10,"td",13),t._uU(11),t.ALo(12,"currency"),t.qZA(),t.TgZ(13,"td",13),t._uU(14),t.ALo(15,"date"),t.qZA(),t.TgZ(16,"td",13),t._uU(17),t.qZA(),t.TgZ(18,"td",14),t.NdJ("click",function(i){return i.stopPropagation()}),t._UZ(19,"app-print-receipt-dialog",15),t.qZA()()),2&r){const e=a.$implicit,i=a.index,n=t.oxw(2);t.Q6J("routerLink",t.VKq(18,tt,e[0].uniqids)),t.xp6(2),t.Oqu(i+1),t.xp6(2),t.Oqu(e[0].suppliername),t.xp6(2),t.Oqu(e[0].transactioncode),t.xp6(2),t.Oqu(t.lcZ(9,11,e[0].modeofpay)),t.xp6(3),t.Oqu(t.xi3(12,13,n.totalAmountSum(e),"Ksh. ")),t.xp6(3),t.Oqu(t.lcZ(15,16,e[0].paymentdate)),t.xp6(3),t.Oqu(e[0].details),t.xp6(2),t.Q6J("tabledata",e)("labeldata",n.printitle)("printid",i)}}function it(r,a){if(1&r){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",6)(2,"table",7)(3,"tbody")(4,"tr",8)(5,"th",9),t._uU(6,"#"),t.qZA(),t.TgZ(7,"th",9),t._uU(8,"Client Name"),t.qZA(),t.TgZ(9,"th",9),t._uU(10,"Transaction Code"),t.qZA(),t.TgZ(11,"th",9),t._uU(12,"Mode Of Payment"),t.qZA(),t.TgZ(13,"th",9),t._uU(14,"Total Amount"),t.qZA(),t.TgZ(15,"th",9),t._uU(16,"Pay Date"),t.qZA(),t.TgZ(17,"th",9),t._uU(18,"Description"),t.qZA(),t.TgZ(19,"th",9),t._uU(20,"Print"),t.qZA()(),t.YNc(21,et,20,20,"tr",10),t.qZA()()(),t.TgZ(22,"app-paginator",11),t.NdJ("newItemEvent",function(n){return t.CHM(e),t.oxw().paginatedCall(n)}),t.qZA(),t.BQk()}if(2&r){const e=t.oxw();t.xp6(21),t.Q6J("ngForOf",e.receipts),t.xp6(1),t.Q6J("datafromdb",e.paginator)}}function nt(r,a){if(1&r&&(t.TgZ(0,"div",17),t._uU(1),t.qZA()),2&r){const e=t.oxw(2);t.xp6(1),t.Oqu(e.loadmessage)}}function rt(r,a){if(1&r&&t.YNc(0,nt,2,1,"div",16),2&r){const e=t.oxw();t.Q6J("ngIf",e.loading)}}let ot=(()=>{class r{constructor(e,i){this.payServ=e,this.router=i,this.loading=!0,this.loadmessage="loading ...",this.ifSearched=!1,this.printitle="RECEIPT",this.paginator={page:1,pageSize:10},this.options=[{searchName:"Transaction Code",searchParam:"transactioncode"},{searchName:"Mode Of Payment",searchParam:"modeofpay"},{searchName:"Transaction Date",searchParam:"paymentdate"}],this.labels={listname:"Receipt List",addBtname:"Add Receipt",searchPlaceholder:"Search Receipt"}}ngOnInit(){this.loadRecipts()}loadRecipts(){this.payServ.getReceipts(this.paginator).subscribe({next:e=>this.handleResp(e),error:e=>this.errorHandle(e)})}handleResp(e){this.loading=!1,this.receipts=e.results,this.ifSearched||(this.receiptStore=e),this.setPaginator(e)}errorHandle(e){this.loading=!1,this.errorMessage=e}paginatedCall(e){this.ifSearched=!1,this.setPaginator(this.receiptStore),this.paginator.page=e.page,this.loadRecipts()}searchFunction(e){this.setPaginator(this.receiptStore),this.errorMessage=null,this.ifSearched=!0,this.receipts=this.receiptStore.results,this.paginator[e.searchParam]=e.searchValue,this.receipts=this.receipts.filter(i=>{var n;let o=(null===(n=i[e.searchParam])||void 0===n?void 0:n.toString())||"";return new RegExp(e.searchValue,"i").test(o)}),0==this.receipts.length&&(this.paginator.page=1,this.loading=!0,this.loadmessage="Performing a Wider Search",this.loadRecipts())}closeSearchFunction(){this.receipts=this.receiptStore.results,this.errorMessage=null,this.setPaginator(this.receiptStore)}setPaginator(e){this.paginator={page:1,pageSize:10},this.paginator.page=e.currentPage,this.paginator.totalItems=e.totalItems,this.paginator.pageSize=e.pageSize}navigateAdd(){this.router.navigate(["/income/receipt/add"])}totalAmountSum(e){let i=0;return e.forEach(n=>{i+=n.totalamount}),i}}return r.\u0275fac=function(e){return new(e||r)(t.Y36(y),t.Y36(m.F0))},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-list-receipts"]],decls:6,vars:6,consts:[[1,"container-fluid","py-3"],[3,"labels","searchoptions","backenddata","searchEmit","closeEmit","navigateEmit"],["class","alert alert-danger my-3",4,"ngIf"],[4,"ngIf","ngIfElse"],["nodata",""],[1,"alert","alert-danger","my-3"],[1,"table-responsive"],[1,"table","table-striped","table-hover","table-bordered","text-nowrap"],[1,"blhead","rounded"],[1,"text-light"],["class","cursor",3,"routerLink",4,"ngFor","ngForOf"],[3,"datafromdb","newItemEvent"],[1,"cursor",3,"routerLink"],[1,"tpad"],[1,"tpad",3,"click"],[3,"tabledata","labeldata","printid"],["class","alert alert-warning text-danger my-3",4,"ngIf"],[1,"alert","alert-warning","text-danger","my-3"]],template:function(e,i){if(1&e&&(t.TgZ(0,"div",0)(1,"app-search-tab",1),t.NdJ("searchEmit",function(o){return i.searchFunction(o)})("closeEmit",function(){return i.closeSearchFunction()})("navigateEmit",function(){return i.navigateAdd()}),t.qZA(),t.YNc(2,$,2,1,"div",2),t.YNc(3,it,23,2,"ng-container",3),t.YNc(4,rt,1,1,"ng-template",null,4,t.W1O),t.qZA()),2&e){const n=t.MAs(5);t.xp6(1),t.Q6J("labels",i.labels)("searchoptions",i.options)("backenddata",i.receipts),t.xp6(1),t.Q6J("ngIf",i.errorMessage),t.xp6(1),t.Q6J("ngIf",i.receipts&&!i.loading&&!i.errorMessage)("ngIfElse",n)}},directives:[V.O,l.O5,l.sg,m.rH,G.P,X.J],pipes:[W.p,l.H9,l.uU],styles:[""]}),r})();var at=d(9744);const st=[{path:"",component:ot},{path:"add",component:E},{path:"edit/:id",component:z}];let ct=(()=>{class r{}return r.\u0275fac=function(e){return new(e||r)},r.\u0275mod=t.oAB({type:r}),r.\u0275inj=t.cJS({imports:[[l.ez,P.K,c.UX,h.A0,c.u5,x.ZX,_.lN,T.LD,v.c,A.Ps,f.ot,b.XK,g.FA,U.D,at.F,m.Bz.forChild(st)]]}),r})()}}]);
"use strict";(self.webpackChunkbiz_ke_frontend=self.webpackChunkbiz_ke_frontend||[]).push([[342],{5342:($,Z,l)=>{l.r(Z),l.d(Z,{OtherExpenseModule:()=>W});var p=l(9808),c=l(1083),t=l(5e3),m=l(2340),A=l(520);let f=(()=>{class n{constructor(e){this.http=e}addOtherExp(e){return this.http.post(m.N.apiUrl+"otherexp/",e)}addOneOtherExp(e){return this.http.post(m.N.apiUrl+"otherexp/one/",e)}updateOtherExp(e,r){return this.http.put(m.N.apiUrl+"otherexp/"+r,e)}updateOneOtherExp(e,r){return this.http.patch(m.N.apiUrl+"otherexp/"+r,e)}delOtherExp(e){return this.http.delete(m.N.apiUrl+"otherexp/"+e)}delOneOtherExp(e){return this.http.delete(m.N.apiUrl+"otherexp/one/"+e)}getOtherExp(e){return this.http.get(m.N.apiUrl+"otherexp/"+e)}getOtherExps(e){return this.http.get(m.N.apiUrl+"otherexp/",{params:e})}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(A.eN))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var T=l(1990),C=l(4701),P=l(2818);function U(n,s){if(1&n&&(t.TgZ(0,"div",5),t._uU(1),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.hij(" ",e.errorMessage," ")}}const q=function(n){return["edit/",n]};function N(n,s){if(1&n&&(t.TgZ(0,"tr",12)(1,"td",13),t._uU(2),t.qZA(),t.TgZ(3,"td",13),t._uU(4),t.qZA(),t.TgZ(5,"td",13),t._uU(6),t.qZA(),t.TgZ(7,"td",13),t._uU(8),t.ALo(9,"modeofpay"),t.qZA(),t.TgZ(10,"td",13),t._uU(11),t.ALo(12,"currency"),t.qZA(),t.TgZ(13,"td",13),t._uU(14),t.ALo(15,"date"),t.qZA(),t.TgZ(16,"td",13),t._uU(17),t.qZA()()),2&n){const e=s.$implicit,r=s.index;t.Q6J("routerLink",t.VKq(15,q,e.uniqids)),t.xp6(2),t.Oqu(r+1),t.xp6(2),t.Oqu(e.personname),t.xp6(2),t.Oqu(e.transactioncode),t.xp6(2),t.Oqu(t.lcZ(9,8,e.modeofpay)),t.xp6(3),t.Oqu(t.xi3(12,10,e.totalamount,"Ksh. ")),t.xp6(3),t.Oqu(t.lcZ(15,13,e.paymentdate)),t.xp6(3),t.Oqu(e.details)}}function S(n,s){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",6)(2,"table",7)(3,"tbody")(4,"tr",8)(5,"th",9),t._uU(6,"#"),t.qZA(),t.TgZ(7,"th",9),t._uU(8,"Supplier Name"),t.qZA(),t.TgZ(9,"th",9),t._uU(10,"Transaction Code"),t.qZA(),t.TgZ(11,"th",9),t._uU(12,"Mode Of Payment"),t.qZA(),t.TgZ(13,"th",9),t._uU(14,"Total Amount"),t.qZA(),t.TgZ(15,"th",9),t._uU(16,"Transaction Date"),t.qZA(),t.TgZ(17,"th",9),t._uU(18,"Description"),t.qZA()(),t.YNc(19,N,18,17,"tr",10),t.qZA()()(),t.TgZ(20,"app-paginator",11),t.NdJ("newItemEvent",function(a){return t.CHM(e),t.oxw().paginatedCall(a)}),t.qZA(),t.BQk()}if(2&n){const e=t.oxw();t.xp6(19),t.Q6J("ngForOf",e.otherExp),t.xp6(1),t.Q6J("datafromdb",e.paginator)}}function k(n,s){if(1&n&&(t.TgZ(0,"div",15),t._uU(1),t.qZA()),2&n){const e=t.oxw(2);t.xp6(1),t.hij(" ",e.loadmessage," ")}}function M(n,s){if(1&n&&t.YNc(0,k,2,1,"div",14),2&n){const e=t.oxw();t.Q6J("ngIf",e.loading)}}let I=(()=>{class n{constructor(e,r){this.payServ=e,this.router=r,this.loading=!0,this.loadmessage="loading ...",this.ifSearched=!1,this.paginator={page:1,pageSize:10},this.options=[{searchName:"Transaction Code",searchParam:"transactioncode"},{searchName:"Mode Of Payment",searchParam:"modeofpay"},{searchName:"Transaction Date",searchParam:"paymentdate"}],this.labels={listname:"Other Expense List",addBtname:"Add Expense",searchPlaceholder:"Search Expense"}}ngOnInit(){this.loadPayments()}loadPayments(){this.payServ.getOtherExps(this.paginator).subscribe({next:e=>this.handleResp(e),error:e=>this.errorHandle(e)})}handleResp(e){this.loading=!1,this.otherExp=e.results,this.ifSearched||(this.otherExpStore=e),this.setPaginator(e)}errorHandle(e){this.loading=!1,this.errorMessage=e}paginatedCall(e){this.ifSearched=!1,this.setPaginator(this.otherExpStore),this.paginator.page=e.page,this.loadPayments()}searchFunction(e){this.setPaginator(this.otherExpStore),this.errorMessage=null,this.ifSearched=!0,this.otherExp=this.otherExpStore.results,this.paginator[e.searchParam]=e.searchValue,this.otherExp=this.otherExp.filter(r=>{var a;let o=(null===(a=r[e.searchParam])||void 0===a?void 0:a.toString())||"";return new RegExp(e.searchValue,"i").test(o)}),0==this.otherExp.length&&(this.paginator.page=1,this.loading=!0,this.loadmessage="Performing a Wider Search",this.loadPayments())}closeSearchFunction(){this.otherExp=this.otherExpStore.results,this.errorMessage=null,this.setPaginator(this.otherExpStore)}setPaginator(e){this.paginator={page:1,pageSize:10},this.paginator.page=e.currentPage,this.paginator.totalItems=e.totalItems,this.paginator.pageSize=e.pageSize}navigateAdd(){this.router.navigate(["/expense/other/add"])}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(f),t.Y36(c.F0))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-list-other-expense"]],decls:6,vars:6,consts:[[1,"container-fluid","py-3"],[3,"labels","searchoptions","backenddata","searchEmit","closeEmit","navigateEmit"],["class","alert alert-danger my-3",4,"ngIf"],[4,"ngIf","ngIfElse"],["nodata",""],[1,"alert","alert-danger","my-3"],[1,"table-responsive"],[1,"table","table-striped","table-hover","table-bordered","text-nowrap"],[1,"blhead","rounded"],[1,"text-light"],["class","cursor",3,"routerLink",4,"ngFor","ngForOf"],[3,"datafromdb","newItemEvent"],[1,"cursor",3,"routerLink"],[1,"tpad"],["class","alert alert-warning text-danger my-3",4,"ngIf"],[1,"alert","alert-warning","text-danger","my-3"]],template:function(e,r){if(1&e&&(t.TgZ(0,"div",0)(1,"app-search-tab",1),t.NdJ("searchEmit",function(o){return r.searchFunction(o)})("closeEmit",function(){return r.closeSearchFunction()})("navigateEmit",function(){return r.navigateAdd()}),t.qZA(),t.YNc(2,U,2,1,"div",2),t.YNc(3,S,21,2,"ng-container",3),t.YNc(4,M,1,1,"ng-template",null,4,t.W1O),t.qZA()),2&e){const a=t.MAs(5);t.xp6(1),t.Q6J("labels",r.labels)("searchoptions",r.options)("backenddata",r.otherExp),t.xp6(1),t.Q6J("ngIf",r.errorMessage),t.xp6(1),t.Q6J("ngIf",r.otherExp&&!r.loading&&!r.errorMessage)("ngIfElse",a)}},directives:[T.O,p.O5,p.sg,c.rH,C.J],pipes:[P.p,p.H9,p.uU],styles:[""]}),n})();var i=l(3075),x=l(7423),E=l(508),u=l(6856),h=l(7322),J=l(5245),_=l(7531),b=l(4107),v=l(7261),y=l(4376),F=l(6186),Q=l(9744),w=l(4586),O=l(5906);function Y(n,s){if(1&n&&(t.TgZ(0,"div",29),t._uU(1),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.hij(" ",e.errorMessage," ")}}function H(n,s){if(1&n&&(t.ynx(0),t.TgZ(1,"ng-option",30),t._uU(2),t.qZA(),t.BQk()),2&n){const e=s.$implicit;t.xp6(1),t.Q6J("value",1*e.value),t.xp6(1),t.hij(" ",e.name,"")}}function L(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"div",45)(1,"button",46),t.NdJ("click",function(){t.CHM(e);const a=t.oxw().index;return t.oxw().editSinglPay(a)}),t._UZ(2,"i",47),t.qZA()()}if(2&n){const e=t.oxw().index,r=t.oxw();t.xp6(1),t.Q6J("disabled",r.getProducts.at(e).pristine||r.getProducts.at(e).invalid)}}function D(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"div",45)(1,"button",48),t.NdJ("click",function(){t.CHM(e);const a=t.oxw().index;return t.oxw().saveProduct(a)}),t._UZ(2,"i",26),t.qZA()()}if(2&n){const e=t.oxw().index,r=t.oxw();t.xp6(1),t.Q6J("disabled",r.getProducts.at(e).invalid)}}function K(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"div",31)(1,"div",32)(2,"div",33)(3,"div",13)(4,"div",34)(5,"mat-form-field",8)(6,"mat-label"),t._uU(7,"Product / Service"),t.qZA(),t._UZ(8,"input",35),t.qZA()(),t.TgZ(9,"div",36)(10,"mat-form-field",8)(11,"mat-label"),t._uU(12," No Of Items"),t.qZA(),t.TgZ(13,"input",37),t.NdJ("keyup",function(a){const d=t.CHM(e).index;return t.oxw().noitmKeyUp(a.target,d)}),t.qZA()()(),t.TgZ(14,"div",36)(15,"mat-form-field",8)(16,"mat-label"),t._uU(17,"Unit Price"),t.qZA(),t.TgZ(18,"input",38),t.NdJ("keyup",function(a){const d=t.CHM(e).index;return t.oxw().unitKeyUp(a.target,d)}),t.qZA()()(),t.TgZ(19,"div",39)(20,"mat-form-field",8)(21,"mat-label"),t._uU(22,"Total Amount"),t.qZA(),t.TgZ(23,"input",40),t.NdJ("keyup",function(a){const d=t.CHM(e).index;return t.oxw().totlKeyup(a.target,d)}),t.qZA()()()()(),t.TgZ(24,"div",41)(25,"div",32)(26,"div",41)(27,"button",42),t.NdJ("click",function(){const o=t.CHM(e).index;return t.oxw().delOnePrd(o)}),t._UZ(28,"i",43),t.qZA()(),t.YNc(29,L,3,1,"div",44),t.YNc(30,D,3,1,"div",44),t.qZA()()()()}if(2&n){const e=s.index,r=t.oxw();let a,o;t.Q6J("formGroupName",e),t.xp6(8),t.Q6J("errorStateMatcher",r.matcher),t.xp6(5),t.Q6J("errorStateMatcher",r.matcher),t.xp6(5),t.Q6J("errorStateMatcher",r.matcher),t.xp6(5),t.Q6J("errorStateMatcher",r.matcher),t.xp6(6),t.Q6J("ngIf",null==(a=r.getProducts.at(e).get("transacid"))?null:a.value),t.xp6(1),t.Q6J("ngIf",!(null!=(o=r.getProducts.at(e).get("transacid"))&&o.value))}}let B=(()=>{class n{constructor(e,r,a,o,d){this.payFb=e,this.router=r,this.snakBar=a,this.payServ=o,this.route=d,this.matcher=new O.n,this.loading=!1,this.today=new Date,this.modeOfPay=[{name:"CASH",value:1},{name:"MPESA",value:2},{name:"PAYPAL",value:3},{name:"CHEQUE",value:4}],this.payForm=this.payFb.group({personname:[""],modeofpay:["",i.kI.required],paymentdate:["",i.kI.required],transactioncode:["",i.kI.required],products:this.payFb.array([]),details:[""]})}ngOnInit(){this.unqpayids=this.route.snapshot.paramMap.get("id"),this.unqpayids&&this.loadPay(),this.payForm.valueChanges.subscribe(()=>{this.errorMessage=!1})}loadPay(){this.loading=!0,this.payServ.getOtherExp(this.unqpayids).subscribe({next:e=>this.respPayment(e),error:e=>this.errorHandle(e)})}get getProducts(){return this.payForm.get("products")}addProduct(e,r,a,o){const d=this.payFb.group({productsname:[e||"",i.kI.required],transacid:[r],noitems:[a||0,[i.kI.required,i.kI.min(1)]],unitprice:[o/a||0,i.kI.required],totalamount:[o||0,[i.kI.required,i.kI.min(1)]]});this.getProducts.push(d)}delOnePrd(e){var r;const a=parseInt(null===(r=this.getProducts.at(e).get("transacid"))||void 0===r?void 0:r.value);a?(this.loading=!0,this.payServ.delOneOtherExp(a).subscribe({next:o=>this.respOneDel(o),error:o=>this.errorHandle(o)})):this.getProducts.removeAt(e)}saveProduct(e){let r=this.payForm.value,a={};a.clisupid=r.clisupid,a.modeofpay=r.modeofpay,a.transactioncode=r.transactioncode,a.paymentdate=(0,p.p6)(r.paymentdate,"yyyy-MM-dd","en-US"),a.details=r.details,a.transacid=this.unqpayids,a.personname=r.personname;const o=Object.assign(Object.assign({},this.getProducts.at(e).value),a);this.payServ.addOneOtherExp(o).subscribe({next:d=>this.respOneDel(d),error:d=>this.errorHandle(d)})}editSinglPay(e){this.loading=!0;const r=this.getProducts.at(e).value,a=parseInt(r.transacid);this.payServ.updateOneOtherExp(r,a).subscribe({next:o=>this.respOneDel(o),error:o=>this.errorHandle(o)})}editOverallPay(){this.loading=!0;let e=this.payForm.value;e.paymentdate=(0,p.p6)(e.paymentdate,"yyyy-MM-dd","en-US"),this.payServ.updateOtherExp(e,this.unqpayids).subscribe({next:r=>this.handleResp(r),error:r=>this.errorHandle(r)})}delOverallPay(){this.loading=!0,this.payServ.delOtherExp(this.unqpayids).subscribe({next:e=>this.handleResp(e),error:e=>this.errorHandle(e)})}openSnakBar(e,r){this.snakBar.open(e,r,{duration:2500})}handleResp(e){this.loading=!1,this.openSnakBar(e.message,"Dismiss"),this.router.navigate(["/expense/other"])}respOneDel(e){this.loading=!1,this.loadPay()}errorHandle(e){this.loading=!1,this.errorMessage=e}respPayment(e){this.loading=!1,this.getProducts.clear(),0==e.length?this.router.navigate(["/expense/other"]):(this.payForm.patchValue({personname:e[0].personname,modeofpay:e[0].modeofpay,transactioncode:e[0].transactioncode,paymentdate:e[0].paymentdate,details:e[0].details}),e.forEach(r=>{this.addProduct(r.productsname,r.id,r.noitems,r.totalamount)}))}unitKeyUp(e,r){var a,o;const d=parseInt(null===(a=this.getProducts.at(r).get("noitems"))||void 0===a?void 0:a.value);null===(o=this.getProducts.at(r).get("totalamount"))||void 0===o||o.setValue(e.value*d)}totlKeyup(e,r){var a,o;const d=parseInt(null===(a=this.getProducts.at(r).get("noitems"))||void 0===a?void 0:a.value)||1;null===(o=this.getProducts.at(r).get("unitprice"))||void 0===o||o.setValue(e.value/d)}noitmKeyUp(e,r){var a,o;const d=parseInt(null===(a=this.getProducts.at(r).get("unitprice"))||void 0===a?void 0:a.value);null===(o=this.getProducts.at(r).get("totalamount"))||void 0===o||o.setValue(e.value*d)}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(i.qu),t.Y36(c.F0),t.Y36(v.ux),t.Y36(f),t.Y36(c.gz))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-edit-other-expense"]],decls:50,vars:10,consts:[[1,"d-lg-flex","text-secondary","py-2"],[1,"flex-grow-1"],["type","button","routerLink","/expense/other",1,"btn","btn-outline-success","btn-sm"],["aria-hidden","true",1,"fa","fa-chevron-left"],[3,"formGroup"],["class","alert alert-danger my-3",4,"ngIf"],[1,"row","pb-4"],[1,"col-lg-6"],["appearance","outline",1,"w-100"],["matInput","","placeholder","Enter Name","formControlName","personname",3,"errorStateMatcher"],["formControlName","modeofpay"],["value","","disabled",""],[4,"ngFor","ngForOf"],[1,"row"],["matInput","","placeholder","Enter Transaction code","formControlName","transactioncode",3,"errorStateMatcher"],["matInput","","formControlName","paymentdate",3,"matDatepicker"],["matSuffix","",3,"for"],["paydateid",""],[1,"col-lg-12"],["matInput","","formControlName","details"],["formArrayName","products"],[1,"pt-2","pb-1"],[1,"bg-secondary-light","py-2"],[3,"formGroupName",4,"ngFor","ngForOf"],[1,"text-end"],["type","button",1,"btn","btn-primary","my-2",3,"click"],[1,"fa","fa-plus"],["type","button","mat-flat-button","","color","warn",1,"me-2",3,"disabled","click"],["type","button","mat-flat-button","","color","primary",3,"disabled","click"],[1,"alert","alert-danger","my-3"],[3,"value"],[3,"formGroupName"],[1,"d-flex"],[1,"flex-grow-1","me-2"],[1,"col-lg-5"],["matInput","","placeholder","Enter Product / Service Name","formControlName","productsname",3,"errorStateMatcher"],[1,"col-lg-2"],["matInput","","placeholder","Enter No Of Items e.g. 50","formControlName","noitems",3,"errorStateMatcher","keyup"],["matInput","","placeholder","Enter Unit","formControlName","unitprice",3,"errorStateMatcher","keyup"],[1,"col-lg-3"],["matInput","","placeholder","Enter Total Amount","formControlName","totalamount",3,"errorStateMatcher","keyup"],[1,""],[1,"btn","btn-danger",3,"click"],[1,"fa","fa-trash"],["class","ms-1",4,"ngIf"],[1,"ms-1"],[1,"btn","btn-success",3,"disabled","click"],[1,"fa","fa-save"],[1,"btn","btn-primary",3,"disabled","click"]],template:function(e,r){if(1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"button",2),t._UZ(3,"i",3),t._uU(4," Back "),t.qZA()()(),t.TgZ(5,"form",4),t.YNc(6,Y,2,1,"div",5),t.TgZ(7,"div",6)(8,"div",7)(9,"mat-form-field",8)(10,"mat-label"),t._uU(11,"Name"),t.qZA(),t._UZ(12,"input",9),t.qZA()(),t.TgZ(13,"div",7)(14,"ng-select",10)(15,"ng-option",11),t._uU(16,"Select Mode OF Payment"),t.qZA(),t.YNc(17,H,3,2,"ng-container",12),t.qZA()()(),t.TgZ(18,"div",13)(19,"div",7)(20,"mat-form-field",8)(21,"mat-label"),t._uU(22,"Transaction Code"),t.qZA(),t._UZ(23,"input",14),t.qZA()(),t.TgZ(24,"div",7)(25,"mat-form-field",8)(26,"mat-label"),t._uU(27,"Payment Date"),t.qZA(),t._UZ(28,"input",15)(29,"mat-datepicker-toggle",16)(30,"mat-datepicker",null,17),t.qZA()()(),t.TgZ(32,"div",13)(33,"div",18)(34,"mat-form-field",8)(35,"mat-label"),t._uU(36,"Payment Description"),t.qZA(),t._UZ(37,"textarea",19),t.qZA()()(),t.TgZ(38,"div",20)(39,"div",21),t._uU(40," Products"),t.qZA(),t.TgZ(41,"div",22),t.YNc(42,K,31,7,"div",23),t.qZA(),t.TgZ(43,"div",24)(44,"button",25),t.NdJ("click",function(){return r.addProduct()}),t._UZ(45,"i",26),t.qZA()()(),t.TgZ(46,"button",27),t.NdJ("click",function(){return r.delOverallPay()}),t._uU(47,"Delete"),t.qZA(),t.TgZ(48,"button",28),t.NdJ("click",function(){return r.editOverallPay()}),t._uU(49,"Save Changes "),t.qZA()()),2&e){const a=t.MAs(31);t.xp6(5),t.Q6J("formGroup",r.payForm),t.xp6(1),t.Q6J("ngIf",r.errorMessage),t.xp6(6),t.Q6J("errorStateMatcher",r.matcher),t.xp6(5),t.Q6J("ngForOf",r.modeOfPay),t.xp6(6),t.Q6J("errorStateMatcher",r.matcher),t.xp6(5),t.Q6J("matDatepicker",a),t.xp6(1),t.Q6J("for",a),t.xp6(13),t.Q6J("ngForOf",r.getProducts.controls),t.xp6(4),t.Q6J("disabled",r.errorMessage||r.loading),t.xp6(2),t.Q6J("disabled",r.payForm.invalid||r.payForm.pristine)}},directives:[c.rH,i._Y,i.JL,i.sg,p.O5,h.KE,h.hX,_.Nt,i.Fj,i.JJ,i.u,y.w9,y.jq,p.sg,u.hl,u.nW,h.R9,u.Mq,i.CE,i.x0,x.lW],styles:[".mat-form-field-flex>.mat-form-field-infix{padding:.5em 0!important}  .mat-form-field-label-wrapper{top:-1.4em}  .mat-form-field-appearance-outline.mat-form-field-can-float.mat-form-field-should-float .mat-form-field-label{transform:translateY(-1.1em) scale(.75);width:133.33333%}"]}),n})();function j(n,s){if(1&n&&(t.TgZ(0,"div",28),t._uU(1),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.hij(" ",e.errorMessage," ")}}function G(n,s){if(1&n&&(t.ynx(0),t.TgZ(1,"mat-option",29),t._uU(2),t.qZA(),t.BQk()),2&n){const e=s.$implicit;t.xp6(1),t.Q6J("value",e.value),t.xp6(1),t.Oqu(e.name)}}function z(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"div",30)(1,"div",31)(2,"div",32)(3,"div",6)(4,"div",33)(5,"mat-form-field",8)(6,"mat-label"),t._uU(7,"Product / Service"),t.qZA(),t._UZ(8,"input",34),t.qZA()(),t.TgZ(9,"div",35)(10,"mat-form-field",8)(11,"mat-label"),t._uU(12," No Of Items"),t.qZA(),t.TgZ(13,"input",36),t.NdJ("keyup",function(a){const d=t.CHM(e).index;return t.oxw().noitmKeyUp(a.target,d)}),t.qZA()()(),t.TgZ(14,"div",35)(15,"mat-form-field",8)(16,"mat-label"),t._uU(17,"Unit Price"),t.qZA(),t.TgZ(18,"input",37),t.NdJ("keyup",function(a){const d=t.CHM(e).index;return t.oxw().unitKeyUp(a.target,d)}),t.qZA()()(),t.TgZ(19,"div",38)(20,"mat-form-field",8)(21,"mat-label"),t._uU(22,"Total Amount"),t.qZA(),t.TgZ(23,"input",39),t.NdJ("keyup",function(a){const d=t.CHM(e).index;return t.oxw().totlKeyup(a.target,d)}),t.qZA()()()()(),t.TgZ(24,"div",40)(25,"button",41),t.NdJ("click",function(){const o=t.CHM(e).index;return t.oxw().delProduct(o)}),t._UZ(26,"i",42),t.qZA()()()()}if(2&n){const e=s.index,r=t.oxw();t.Q6J("formGroupName",e),t.xp6(8),t.Q6J("errorStateMatcher",r.matcher),t.xp6(5),t.Q6J("errorStateMatcher",r.matcher),t.xp6(5),t.Q6J("errorStateMatcher",r.matcher),t.xp6(5),t.Q6J("errorStateMatcher",r.matcher),t.xp6(2),t.Q6J("disabled",0==e)}}function R(n,s){1&n&&(t.ynx(0),t._UZ(1,"i",43),t.TgZ(2,"span",40),t._uU(3,"Loading..."),t.qZA(),t.BQk())}function V(n,s){1&n&&t._uU(0," Add Payment ")}const X=[{path:"",component:I},{path:"add",component:(()=>{class n{constructor(e,r,a,o){this.payFb=e,this.router=r,this.snakBar=a,this.othExp=o,this.matcher=new O.n,this.loading=!1,this.today=new Date,this.modeOfPay=[{name:"CASH",value:1},{name:"MPESA",value:2},{name:"PAYPAL",value:3},{name:"CHEQUE",value:4}],this.payForm=this.payFb.group({personname:[""],modeofpay:["",i.kI.required],paymentdate:[this.today,i.kI.required],transactioncode:[""],products:this.payFb.array([]),details:[""]})}ngOnInit(){this.addProduct(),this.payForm.valueChanges.subscribe(()=>{this.errorMessage=!1})}get getProducts(){return this.payForm.get("products")}addProduct(){const e=this.payFb.group({productsname:["",i.kI.required],noitems:[0,i.kI.required],unitprice:[0,i.kI.required],totalamount:[0,i.kI.required]});this.getProducts.push(e)}delProduct(e){this.getProducts.removeAt(e)}addPay(){this.loading=!0;let e=this.payForm.value;e.paymentdate=(0,p.p6)(e.paymentdate,"yyyy-MM-dd","en-US"),this.othExp.addOtherExp(e).subscribe({next:r=>this.handleResp(r),error:r=>this.errorHandle(r)})}openSnakBar(e,r){this.snakBar.open(e,r,{duration:2500})}handleResp(e){this.loading=!1,this.openSnakBar(e.message,"Dismiss"),this.router.navigate(["/expense/other"])}errorHandle(e){this.loading=!1,this.errorMessage=e}unitKeyUp(e,r){var a,o;const d=parseInt(null===(a=this.getProducts.at(r).get("noitems"))||void 0===a?void 0:a.value);null===(o=this.getProducts.at(r).get("totalamount"))||void 0===o||o.setValue(e.value*d)}totlKeyup(e,r){var a,o;const d=parseInt(null===(a=this.getProducts.at(r).get("noitems"))||void 0===a?void 0:a.value)||1;null===(o=this.getProducts.at(r).get("unitprice"))||void 0===o||o.setValue(e.value/d)}noitmKeyUp(e,r){var a,o;const d=parseInt(null===(a=this.getProducts.at(r).get("unitprice"))||void 0===a?void 0:a.value);null===(o=this.getProducts.at(r).get("totalamount"))||void 0===o||o.setValue(e.value*d)}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(i.qu),t.Y36(c.F0),t.Y36(v.ux),t.Y36(f))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-add-other-expense"]],decls:51,vars:11,consts:[[1,"d-lg-flex","text-secondary","py-2"],[1,"flex-grow-1"],["type","button","routerLink","/expense/other",1,"btn","btn-outline-success","btn-sm"],["aria-hidden","true",1,"fa","fa-chevron-left"],[3,"formGroup"],["class","alert alert-danger my-3",4,"ngIf"],[1,"row"],[1,"col-lg-6"],["appearance","outline",1,"w-100"],["matInput","","placeholder","Enter Name","formControlName","personname",3,"errorStateMatcher"],["formControlName","modeofpay",1,"w-10"],[4,"ngFor","ngForOf"],["matInput","","placeholder","Enter Transaction code","formControlName","transactioncode",3,"errorStateMatcher"],["matInput","","formControlName","paymentdate",3,"matDatepicker"],["matSuffix","",3,"for"],["paydateid",""],[1,"col-lg-12"],["matInput","","formControlName","details"],["formArrayName","products"],[1,"pt-2","pb-1"],[1,"bg-secondary-light","py-2"],[3,"formGroupName",4,"ngFor","ngForOf"],[1,"text-end"],["type","button",1,"btn","btn-primary","my-2",3,"click"],[1,"fa","fa-plus"],["mat-flat-button","","color","primary","type","button",1,"me-3",3,"disabled","click"],[4,"ngIf","ngIfElse"],["notload",""],[1,"alert","alert-danger","my-3"],[3,"value"],[3,"formGroupName"],[1,"d-flex"],[1,"flex-grow-1","me-2"],[1,"col-lg-5"],["matInput","","placeholder","Enter Product / Service Name","formControlName","productsname",3,"errorStateMatcher"],[1,"col-lg-2"],["matInput","","placeholder","Enter No Of Items e.g. 50","formControlName","noitems",3,"errorStateMatcher","keyup"],["matInput","","placeholder","Enter Unit","formControlName","unitprice",3,"errorStateMatcher","keyup"],[1,"col-lg-3"],["matInput","","placeholder","Enter Total Amount","formControlName","totalamount",3,"errorStateMatcher","keyup"],[1,""],[1,"btn","btn-danger",3,"disabled","click"],[1,"fa","fa-trash"],[1,"fa","fa-spinner","fa-spin","fa-1x","me-2"]],template:function(e,r){if(1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"button",2),t._UZ(3,"i",3),t._uU(4," Back "),t.qZA()()(),t.TgZ(5,"form",4),t.YNc(6,j,2,1,"div",5),t.TgZ(7,"div",6)(8,"div",7)(9,"mat-form-field",8)(10,"mat-label"),t._uU(11,"Name"),t.qZA(),t._UZ(12,"input",9),t.qZA()(),t.TgZ(13,"div",7)(14,"mat-form-field",8)(15,"mat-label"),t._uU(16,"Mode Of Payment"),t.qZA(),t.TgZ(17,"mat-select",10),t.YNc(18,G,3,2,"ng-container",11),t.qZA()()()(),t.TgZ(19,"div",6)(20,"div",7)(21,"mat-form-field",8)(22,"mat-label"),t._uU(23,"Transaction Code"),t.qZA(),t._UZ(24,"input",12),t.qZA()(),t.TgZ(25,"div",7)(26,"mat-form-field",8)(27,"mat-label"),t._uU(28,"Payment Date"),t.qZA(),t._UZ(29,"input",13)(30,"mat-datepicker-toggle",14)(31,"mat-datepicker",null,15),t.qZA()()(),t.TgZ(33,"div",6)(34,"div",16)(35,"mat-form-field",8)(36,"mat-label"),t._uU(37,"Payment Description"),t.qZA(),t._UZ(38,"textarea",17),t.qZA()()(),t.TgZ(39,"div",18)(40,"div",19),t._uU(41," Add Products"),t.qZA(),t.TgZ(42,"div",20),t.YNc(43,z,27,6,"div",21),t.qZA(),t.TgZ(44,"div",22)(45,"button",23),t.NdJ("click",function(){return r.addProduct()}),t._UZ(46,"i",24),t.qZA()()(),t.TgZ(47,"button",25),t.NdJ("click",function(){return r.addPay()}),t.YNc(48,R,4,0,"ng-container",26),t.YNc(49,V,1,0,"ng-template",null,27,t.W1O),t.qZA()()),2&e){const a=t.MAs(32),o=t.MAs(50);t.xp6(5),t.Q6J("formGroup",r.payForm),t.xp6(1),t.Q6J("ngIf",r.errorMessage),t.xp6(6),t.Q6J("errorStateMatcher",r.matcher),t.xp6(6),t.Q6J("ngForOf",r.modeOfPay),t.xp6(6),t.Q6J("errorStateMatcher",r.matcher),t.xp6(5),t.Q6J("matDatepicker",a),t.xp6(1),t.Q6J("for",a),t.xp6(13),t.Q6J("ngForOf",r.getProducts.controls),t.xp6(4),t.Q6J("disabled",r.payForm.invalid||r.errorMessage||r.loading),t.xp6(1),t.Q6J("ngIf",r.loading)("ngIfElse",o)}},directives:[c.rH,i._Y,i.JL,i.sg,p.O5,h.KE,h.hX,_.Nt,i.Fj,i.JJ,i.u,b.gD,p.sg,E.ey,u.hl,u.nW,h.R9,u.Mq,i.CE,i.x0,x.lW],styles:[".mat-form-field-flex>.mat-form-field-infix{padding:.5em 0!important}  .mat-form-field-label-wrapper{top:-1.4em}  .mat-form-field-appearance-outline.mat-form-field-can-float.mat-form-field-should-float .mat-form-field-label{transform:translateY(-1.1em) scale(.75);width:133.33333%}"]}),n})()},{path:"edit/:id",component:B},{path:"**",redirectTo:"",pathMatch:"full"}];let W=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[p.ez,F.K,i.UX,y.A0,i.u5,v.ZX,h.lN,b.LD,_.c,J.Ps,x.ot,E.XK,u.FA,w.D,Q.F,c.Bz.forChild(X)]]}),n})()}}]);
"use strict";(self.webpackChunkbiz_ke_frontend=self.webpackChunkbiz_ke_frontend||[]).push([[541],{4541:(rt,b,p)=>{p.r(b),p.d(b,{LsolpoModule:()=>nt});var c=p(9808),g=p(1083),t=p(5e3),d=p(2340),L=p(520);let _=(()=>{class r{constructor(e){this.http=e}addLpoLso(e){return this.http.post(d.N.apiUrl+"lsolpo/",e)}addOneLsolpo(e){return this.http.post(d.N.apiUrl+"lsolpo/one/",e)}updateLpoLso(e,o){return this.http.put(d.N.apiUrl+"lsolpo/"+o,e)}updateOneLsoLpo(e,o){return this.http.patch(d.N.apiUrl+"lsolpo/"+o,e)}delLpoLso(e){return this.http.delete(d.N.apiUrl+"lsolpo/"+e)}delOneLsoLpo(e){return this.http.delete(d.N.apiUrl+"lsolpo/one/"+e)}getLpoLso(e){return this.http.get(d.N.apiUrl+"lsolpo/"+e)}getLpoLsos(e){return this.http.get(d.N.apiUrl+"lsolpo/",{params:e})}getSuppliers(e){return this.http.get(d.N.apiUrl+"supplier/",{params:e})}getProducts(e){return this.http.get(d.N.apiUrl+"product/",{params:e})}}return r.\u0275fac=function(e){return new(e||r)(t.LFG(L.eN))},r.\u0275prov=t.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();var Z=p(1990),C=p(4701);function T(r,i){if(1&r&&(t.TgZ(0,"div",5),t._uU(1),t.qZA()),2&r){const e=t.oxw();t.xp6(1),t.hij(" ",e.errorMessage," ")}}const A=function(r){return["edit/",r]};function P(r,i){if(1&r&&(t.TgZ(0,"tr",12)(1,"td",13),t._uU(2),t.qZA(),t.TgZ(3,"td",13),t._uU(4),t.qZA(),t.TgZ(5,"td",13),t._uU(6),t.ALo(7,"currency"),t.qZA(),t.TgZ(8,"td",13),t._uU(9),t.ALo(10,"date"),t.qZA(),t.TgZ(11,"td",13),t._uU(12),t.qZA()()),2&r){const e=i.$implicit,o=i.index,n=t.oxw(2);t.Q6J("routerLink",t.VKq(11,A,e[0].uniqids)),t.xp6(2),t.Oqu(o+1),t.xp6(2),t.Oqu(e[0].suppliername),t.xp6(2),t.Oqu(t.xi3(7,6,n.totalAmountSum(e),"Ksh. ")),t.xp6(3),t.Oqu(t.lcZ(10,9,e[0].paymentdate)),t.xp6(3),t.Oqu(e[0].details)}}function U(r,i){if(1&r){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",6)(2,"table",7)(3,"tbody")(4,"tr",8)(5,"th",9),t._uU(6,"#"),t.qZA(),t.TgZ(7,"th",9),t._uU(8,"Supplier Name"),t.qZA(),t.TgZ(9,"th",9),t._uU(10,"Total Amount"),t.qZA(),t.TgZ(11,"th",9),t._uU(12,"Transaction Date"),t.qZA(),t.TgZ(13,"th",9),t._uU(14,"Description"),t.qZA()(),t.YNc(15,P,13,13,"tr",10),t.qZA()()(),t.TgZ(16,"app-paginator",11),t.NdJ("newItemEvent",function(n){return t.CHM(e),t.oxw().paginatedCall(n)}),t.qZA(),t.BQk()}if(2&r){const e=t.oxw();t.xp6(15),t.Q6J("ngForOf",e.lsolpos),t.xp6(1),t.Q6J("datafromdb",e.paginator)}}function N(r,i){if(1&r&&(t.TgZ(0,"div",15),t._uU(1),t.qZA()),2&r){const e=t.oxw(2);t.xp6(1),t.Oqu(e.loadmessage)}}function S(r,i){if(1&r&&t.YNc(0,N,2,1,"div",14),2&r){const e=t.oxw();t.Q6J("ngIf",e.loading)}}let k=(()=>{class r{constructor(e,o){this.lsoServ=e,this.router=o,this.loading=!0,this.loadmessage="loading ...",this.ifSearched=!1,this.paginator={page:1,pageSize:10},this.options=[{searchName:"Transaction Date",searchParam:"paymentdate"}],this.labels={listname:"Lso/Lpo List",addBtname:"Add Lso/Lpo",searchPlaceholder:"Search Lso/Lpo"}}ngOnInit(){this.loadLsoLpos()}loadLsoLpos(){this.lsoServ.getLpoLsos(this.paginator).subscribe({next:e=>this.handleResp(e),error:e=>this.errorHandle(e)})}handleResp(e){this.loading=!1,this.lsolpos=e.results,this.ifSearched||(this.lsolpoStore=e),this.setPaginator(e)}errorHandle(e){this.loading=!1,this.errorMessage=e}paginatedCall(e){this.ifSearched=!1,this.setPaginator(this.lsolpoStore),this.paginator.page=e.page,this.loadLsoLpos()}searchFunction(e){this.setPaginator(this.lsolpoStore),this.errorMessage=null,this.ifSearched=!0,this.lsolpos=this.lsolpoStore.results,this.paginator[e.searchParam]=e.searchValue,this.lsolpos=this.lsolpos.filter(o=>{var n;let s=(null===(n=o[e.searchParam])||void 0===n?void 0:n.toString())||"";return new RegExp(e.searchValue,"i").test(s)}),0==this.lsolpos.length&&(this.paginator.page=1,this.loading=!0,this.loadmessage="Performing a Wider Search",this.loadLsoLpos())}closeSearchFunction(){this.lsolpos=this.lsolpoStore.results,this.errorMessage=null,this.setPaginator(this.lsolpoStore)}setPaginator(e){this.paginator={page:1,pageSize:10},this.paginator.page=e.currentPage,this.paginator.totalItems=e.totalItems,this.paginator.pageSize=e.pageSize}navigateAdd(){this.router.navigate(["/expense/lsolpo/add"])}totalAmountSum(e){let o=0;return e.forEach(n=>{o+=n.totalamount}),o}}return r.\u0275fac=function(e){return new(e||r)(t.Y36(_),t.Y36(g.F0))},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-list-lsolpos"]],decls:6,vars:6,consts:[[1,"container-fluid","py-3"],[3,"labels","searchoptions","backenddata","searchEmit","closeEmit","navigateEmit"],["class","alert alert-danger my-3",4,"ngIf"],[4,"ngIf","ngIfElse"],["nodata",""],[1,"alert","alert-danger","my-3"],[1,"table-responsive"],[1,"table","table-striped","table-hover","table-bordered","text-nowrap"],[1,"blhead","rounded"],[1,"text-light"],["class","cursor",3,"routerLink",4,"ngFor","ngForOf"],[3,"datafromdb","newItemEvent"],[1,"cursor",3,"routerLink"],[1,"tpad"],["class","alert alert-warning text-danger my-3",4,"ngIf"],[1,"alert","alert-warning","text-danger","my-3"]],template:function(e,o){if(1&e&&(t.TgZ(0,"div",0)(1,"app-search-tab",1),t.NdJ("searchEmit",function(s){return o.searchFunction(s)})("closeEmit",function(){return o.closeSearchFunction()})("navigateEmit",function(){return o.navigateAdd()}),t.qZA(),t.YNc(2,T,2,1,"div",2),t.YNc(3,U,17,2,"ng-container",3),t.YNc(4,S,1,1,"ng-template",null,4,t.W1O),t.qZA()),2&e){const n=t.MAs(5);t.xp6(1),t.Q6J("labels",o.labels)("searchoptions",o.options)("backenddata",o.lsolpos),t.xp6(1),t.Q6J("ngIf",o.errorMessage),t.xp6(1),t.Q6J("ngIf",o.lsolpos&&!o.loading&&!o.errorMessage)("ngIfElse",n)}},directives:[Z.O,c.O5,c.sg,g.rH,C.J],pipes:[c.H9,c.uU],styles:[""]}),r})();var l=p(3075),y=p(5906),f=p(7261),m=p(4376),h=p(7322),v=p(7531),x=p(7423);function q(r,i){if(1&r&&(t.TgZ(0,"div",22),t._uU(1),t.qZA()),2&r){const e=t.oxw();t.xp6(1),t.hij(" ",e.errorMessage," ")}}function J(r,i){if(1&r&&(t.ynx(0),t.TgZ(1,"ng-option",25),t._uU(2),t.qZA(),t.BQk()),2&r){const e=i.$implicit;t.xp6(1),t.Q6J("value",1*e.id),t.xp6(1),t.hij(" ",e.fullname.toUpperCase(),"")}}function I(r,i){if(1&r&&(t.ynx(0),t.TgZ(1,"ng-option",23),t._uU(2,"Please Select A Supplier"),t.qZA(),t.YNc(3,J,3,2,"ng-container",24),t.BQk()),2&r){const e=t.oxw();t.xp6(3),t.Q6J("ngForOf",e.suppliers)}}function F(r,i){if(1&r&&(t.ynx(0),t.TgZ(1,"ng-option",25),t._uU(2),t.qZA(),t.BQk()),2&r){const e=i.$implicit;t.xp6(1),t.Q6J("value",1*e.id),t.xp6(1),t.HOy(" ",e.categoryname.toUpperCase()," - ",e.brand.toUpperCase()," - ",e.prdtype.toUpperCase()," - ",e.calibration.toUpperCase()," ")}}function E(r,i){if(1&r&&(t.ynx(0),t.TgZ(1,"ng-option",23),t._uU(2,"Please Select A Product"),t.qZA(),t.YNc(3,F,3,5,"ng-container",24),t.BQk()),2&r){const e=t.oxw(2);t.xp6(3),t.Q6J("ngForOf",e.products)}}function Q(r,i){if(1&r){const e=t.EpF();t.TgZ(0,"div",40)(1,"button",41),t.NdJ("click",function(){t.CHM(e);const n=t.oxw().index;return t.oxw().editSinglPay(n)}),t._UZ(2,"i",42),t.qZA()()}if(2&r){const e=t.oxw().index,o=t.oxw();t.xp6(1),t.Q6J("disabled",o.getProducts.at(e).pristine||o.getProducts.at(e).invalid)}}function O(r,i){if(1&r){const e=t.EpF();t.TgZ(0,"div",40)(1,"button",43),t.NdJ("click",function(){t.CHM(e);const n=t.oxw().index;return t.oxw().saveProduct(n)}),t._UZ(2,"i",19),t.qZA()()}if(2&r){const e=t.oxw().index,o=t.oxw();t.xp6(1),t.Q6J("disabled",o.getProducts.at(e).invalid)}}function M(r,i){if(1&r){const e=t.EpF();t.TgZ(0,"div",26)(1,"div",27)(2,"div",28)(3,"div",10)(4,"div",29)(5,"ng-select",30),t.NdJ("change",function(){const s=t.CHM(e).index;return t.oxw().changeProduct(s)}),t.YNc(6,E,4,1,"ng-container",9),t.qZA()(),t.TgZ(7,"div",31)(8,"mat-form-field",11)(9,"mat-label"),t._uU(10," No Of Items"),t.qZA(),t.TgZ(11,"input",32),t.NdJ("keyup",function(n){const a=t.CHM(e).index;return t.oxw().noitmKeyUp(n.target,a)}),t.qZA()()(),t.TgZ(12,"div",31)(13,"mat-form-field",11)(14,"mat-label"),t._uU(15,"Unit Price"),t.qZA(),t.TgZ(16,"input",33),t.NdJ("keyup",function(n){const a=t.CHM(e).index;return t.oxw().unitKeyUp(n.target,a)}),t.qZA()()(),t.TgZ(17,"div",34)(18,"mat-form-field",11)(19,"mat-label"),t._uU(20,"Total Amount"),t.qZA(),t.TgZ(21,"input",35),t.NdJ("keyup",function(n){const a=t.CHM(e).index;return t.oxw().totlKeyup(n.target,a)}),t.qZA()()()()(),t.TgZ(22,"div",36)(23,"div",27)(24,"div",36)(25,"button",37),t.NdJ("click",function(){const s=t.CHM(e).index;return t.oxw().delOnePrd(s)}),t._UZ(26,"i",38),t.qZA()(),t.YNc(27,Q,3,1,"div",39),t.YNc(28,O,3,1,"div",39),t.qZA()()()()}if(2&r){const e=i.index,o=t.oxw();let n,s;t.Q6J("formGroupName",e),t.xp6(6),t.Q6J("ngIf",o.products),t.xp6(5),t.Q6J("errorStateMatcher",o.matcher),t.xp6(5),t.Q6J("errorStateMatcher",o.matcher),t.xp6(5),t.Q6J("errorStateMatcher",o.matcher),t.xp6(6),t.Q6J("ngIf",null==(n=o.getProducts.at(e).get("transacid"))?null:n.value),t.xp6(1),t.Q6J("ngIf",!(null!=(s=o.getProducts.at(e).get("transacid"))&&s.value))}}let w=(()=>{class r{constructor(e,o,n,s,a){this.payFb=e,this.router=o,this.snakBar=n,this.lsoServ=s,this.route=a,this.matcher=new y.n,this.loading=!1,this.lsolpoForm=this.payFb.group({clisupid:["",l.kI.required],products:this.payFb.array([]),details:[""]})}ngOnInit(){this.loadProd(),this.loadSuppl(),this.unqpayids=this.route.snapshot.paramMap.get("id"),this.unqpayids&&this.loadLsolpo(),this.lsolpoForm.valueChanges.subscribe(()=>{this.errorMessage=!1})}loadProd(){this.lsoServ.getProducts({page:1,pageSize:10}).subscribe({next:e=>this.products=e.results,error:e=>this.errorHandle(e)})}loadSuppl(){this.lsoServ.getSuppliers({page:1,pageSize:10}).subscribe({next:e=>this.suppliers=e.results,error:e=>this.errorHandle(e)})}loadLsolpo(){this.loading=!0,this.lsoServ.getLpoLso(this.unqpayids).subscribe({next:e=>this.respPayment(e),error:e=>this.errorHandle(e)})}get getProducts(){return this.lsolpoForm.get("products")}addProduct(e,o,n,s){const a=this.payFb.group({productid:[e||"",l.kI.required],transacid:[o],noitems:[n||0,[l.kI.required,l.kI.min(1)]],unitprice:[s/n||0,l.kI.required],totalamount:[s||0,[l.kI.required,l.kI.min(1)]]});this.getProducts.push(a)}delOnePrd(e){var o;const n=parseInt(null===(o=this.getProducts.at(e).get("transacid"))||void 0===o?void 0:o.value);n?(this.loading=!0,this.lsoServ.delOneLsoLpo(n).subscribe({next:s=>this.respOneDel(s),error:s=>this.errorHandle(s)})):this.getProducts.removeAt(e)}saveProduct(e){let o=this.lsolpoForm.value,n={};n.clisupid=o.clisupid,n.modeofpay=o.modeofpay,n.transactioncode=o.transactioncode,n.details=o.details,n.transacid=this.unqpayids;const s=Object.assign(Object.assign({},this.getProducts.at(e).value),n);this.lsoServ.addOneLsolpo(s).subscribe({next:a=>this.respOneDel(a),error:a=>this.errorHandle(a)})}editSinglPay(e){this.loading=!0;const o=this.getProducts.at(e).value,n=parseInt(o.transacid);this.lsoServ.updateOneLsoLpo(o,n).subscribe({next:s=>this.respOneDel(s),error:s=>this.errorHandle(s)})}editOverallPay(){this.loading=!0,this.lsoServ.updateLpoLso(this.lsolpoForm.value,this.unqpayids).subscribe({next:o=>this.handleResp(o),error:o=>this.errorHandle(o)})}delOverallPay(){this.loading=!0,this.lsoServ.delLpoLso(this.unqpayids).subscribe({next:e=>this.handleResp(e),error:e=>this.errorHandle(e)})}openSnakBar(e,o){this.snakBar.open(e,o,{duration:2500})}handleResp(e){this.loading=!1,this.openSnakBar(e.message,"Dismiss"),this.router.navigate(["/expense/lsolpo"])}respOneDel(e){this.loading=!1,this.loadLsolpo()}errorHandle(e){this.loading=!1,this.errorMessage=e}respPayment(e){this.loading=!1,this.getProducts.clear(),0==e.length?this.router.navigate(["/expense/lsolpo"]):(this.lsolpoForm.patchValue({clisupid:e[0].clisupid,modeofpay:e[0].modeofpay,transactioncode:e[0].transactioncode,paymentdate:e[0].paymentdate,details:e[0].details}),e.forEach(o=>{this.addProduct(o.productid,o.id,o.noitems,o.totalamount)}))}unitKeyUp(e,o){var n,s;const a=parseInt(null===(n=this.getProducts.at(o).get("noitems"))||void 0===n?void 0:n.value);null===(s=this.getProducts.at(o).get("totalamount"))||void 0===s||s.setValue(e.value*a)}totlKeyup(e,o){var n,s;const a=parseInt(null===(n=this.getProducts.at(o).get("noitems"))||void 0===n?void 0:n.value)||1;null===(s=this.getProducts.at(o).get("unitprice"))||void 0===s||s.setValue(e.value/a)}noitmKeyUp(e,o){var n,s;const a=parseInt(null===(n=this.getProducts.at(o).get("unitprice"))||void 0===n?void 0:n.value);null===(s=this.getProducts.at(o).get("totalamount"))||void 0===s||s.setValue(e.value*a)}changeProduct(e){var o,n;const s=null===(o=this.getProducts.at(e).get("productid"))||void 0===o?void 0:o.value,a=this.products.find(u=>u.id==s);null===(n=this.getProducts.at(e).get("unitprice"))||void 0===n||n.setValue(a.defbuyprice)}}return r.\u0275fac=function(e){return new(e||r)(t.Y36(l.qu),t.Y36(g.F0),t.Y36(f.ux),t.Y36(_),t.Y36(g.gz))},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-edit-lsolpo"]],decls:29,vars:6,consts:[[1,"d-lg-flex","text-secondary","py-2"],[1,"flex-grow-1"],["type","button","routerLink","/expense/lsolpo",1,"btn","btn-outline-success","btn-sm"],["aria-hidden","true",1,"fa","fa-chevron-left"],[3,"formGroup"],["class","alert alert-danger my-3",4,"ngIf"],[1,"row","pb-4"],[1,"col-lg-12"],["formControlName","clisupid"],[4,"ngIf"],[1,"row"],["appearance","outline",1,"w-100"],["matInput","","formControlName","details"],["formArrayName","products"],[1,"pt-2","pb-1"],[1,"bg-secondary-light","py-2"],[3,"formGroupName",4,"ngFor","ngForOf"],[1,"text-end"],["type","button",1,"btn","btn-primary","my-2",3,"click"],[1,"fa","fa-plus"],["type","button","mat-flat-button","","color","warn",1,"me-2",3,"disabled","click"],["type","button","mat-flat-button","","color","primary",3,"disabled","click"],[1,"alert","alert-danger","my-3"],["value","","disabled",""],[4,"ngFor","ngForOf"],[3,"value"],[3,"formGroupName"],[1,"d-flex"],[1,"flex-grow-1","me-2"],[1,"col-lg-5","pt-1"],["formControlName","productid",3,"change"],[1,"col-lg-2"],["matInput","","placeholder","Enter No Of Items e.g. 50","formControlName","noitems",3,"errorStateMatcher","keyup"],["matInput","","placeholder","Enter Unit","formControlName","unitprice",3,"errorStateMatcher","keyup"],[1,"col-lg-3"],["matInput","","placeholder","Enter Total Amount","formControlName","totalamount",3,"errorStateMatcher","keyup"],[1,""],[1,"btn","btn-danger",3,"click"],[1,"fa","fa-trash"],["class","ms-1",4,"ngIf"],[1,"ms-1"],[1,"btn","btn-success",3,"disabled","click"],[1,"fa","fa-save"],[1,"btn","btn-primary",3,"disabled","click"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"button",2),t._UZ(3,"i",3),t._uU(4," Back "),t.qZA()()(),t.TgZ(5,"form",4),t.YNc(6,q,2,1,"div",5),t.TgZ(7,"div",6)(8,"div",7)(9,"ng-select",8),t.YNc(10,I,4,1,"ng-container",9),t.qZA()()(),t.TgZ(11,"div",10)(12,"div",7)(13,"mat-form-field",11)(14,"mat-label"),t._uU(15,"Payment Description"),t.qZA(),t._UZ(16,"textarea",12),t.qZA()()(),t.TgZ(17,"div",13)(18,"div",14),t._uU(19," Products"),t.qZA(),t.TgZ(20,"div",15),t.YNc(21,M,29,7,"div",16),t.qZA(),t.TgZ(22,"div",17)(23,"button",18),t.NdJ("click",function(){return o.addProduct()}),t._UZ(24,"i",19),t.qZA()()(),t.TgZ(25,"button",20),t.NdJ("click",function(){return o.delOverallPay()}),t._uU(26,"Delete"),t.qZA(),t.TgZ(27,"button",21),t.NdJ("click",function(){return o.editOverallPay()}),t._uU(28,"Save Changes "),t.qZA()()),2&e&&(t.xp6(5),t.Q6J("formGroup",o.lsolpoForm),t.xp6(1),t.Q6J("ngIf",o.errorMessage),t.xp6(4),t.Q6J("ngIf",o.suppliers),t.xp6(11),t.Q6J("ngForOf",o.getProducts.controls),t.xp6(4),t.Q6J("disabled",o.errorMessage||o.loading),t.xp6(2),t.Q6J("disabled",o.lsolpoForm.invalid||o.lsolpoForm.pristine))},directives:[g.rH,l._Y,l.JL,l.sg,c.O5,m.w9,l.JJ,l.u,m.jq,c.sg,h.KE,h.hX,v.Nt,l.Fj,l.CE,l.x0,x.lW],styles:[".mat-form-field-flex>.mat-form-field-infix{padding:.5em 0!important}  .mat-form-field-label-wrapper{top:-1.4em}  .mat-form-field-appearance-outline.mat-form-field-can-float.mat-form-field-should-float .mat-form-field-label{transform:translateY(-1.1em) scale(.75);width:133.33333%}"]}),r})();var Y=p(508),H=p(6856),B=p(5245),K=p(4107),D=p(6186);function j(r,i){if(1&r&&(t.TgZ(0,"div",23),t._uU(1),t.qZA()),2&r){const e=t.oxw();t.xp6(1),t.hij(" ",e.errorMessage," ")}}function z(r,i){if(1&r&&(t.ynx(0),t.TgZ(1,"ng-option",26),t._uU(2),t.qZA(),t.BQk()),2&r){const e=i.$implicit;t.xp6(1),t.Q6J("value",1*e.id),t.xp6(1),t.hij(" ",e.fullname.toUpperCase(),"")}}function V(r,i){if(1&r&&(t.ynx(0),t.TgZ(1,"ng-option",24),t._uU(2,"Please Select A Supplier"),t.qZA(),t.YNc(3,z,3,2,"ng-container",25),t.BQk()),2&r){const e=t.oxw();t.xp6(3),t.Q6J("ngForOf",e.suppliers)}}function G(r,i){if(1&r&&(t.ynx(0),t.TgZ(1,"ng-option",26),t._uU(2),t.qZA(),t.BQk()),2&r){const e=i.$implicit;t.xp6(1),t.Q6J("value",1*e.id),t.xp6(1),t.HOy(" ",e.categoryname.toUpperCase()," - ",e.brand.toUpperCase()," - ",e.prdtype.toUpperCase()," - ",e.calibration.toUpperCase()," ")}}function R(r,i){if(1&r&&(t.ynx(0),t.TgZ(1,"ng-option",24),t._uU(2,"Please Select A Product"),t.qZA(),t.YNc(3,G,3,5,"ng-container",25),t.BQk()),2&r){const e=t.oxw(2);t.xp6(3),t.Q6J("ngForOf",e.products)}}function X(r,i){if(1&r){const e=t.EpF();t.TgZ(0,"div",27)(1,"div",28)(2,"div",29)(3,"div",10)(4,"div",30)(5,"ng-select",31),t.NdJ("change",function(){const s=t.CHM(e).index;return t.oxw().changeProduct(s)}),t.YNc(6,R,4,1,"ng-container",9),t.qZA()(),t.TgZ(7,"div",32)(8,"mat-form-field",11)(9,"mat-label"),t._uU(10," No Of Items"),t.qZA(),t.TgZ(11,"input",33),t.NdJ("keyup",function(n){const a=t.CHM(e).index;return t.oxw().noitmKeyUp(n.target,a)}),t.qZA()()(),t.TgZ(12,"div",32)(13,"mat-form-field",11)(14,"mat-label"),t._uU(15,"Unit Price"),t.qZA(),t.TgZ(16,"input",34),t.NdJ("keyup",function(n){const a=t.CHM(e).index;return t.oxw().unitKeyUp(n.target,a)}),t.qZA()()(),t.TgZ(17,"div",35)(18,"mat-form-field",11)(19,"mat-label"),t._uU(20,"Total Amount"),t.qZA(),t.TgZ(21,"input",36),t.NdJ("keyup",function(n){const a=t.CHM(e).index;return t.oxw().totlKeyup(n.target,a)}),t.qZA()()()()(),t.TgZ(22,"div",37)(23,"button",38),t.NdJ("click",function(){const s=t.CHM(e).index;return t.oxw().delProduct(s)}),t._UZ(24,"i",39),t.qZA()()()()}if(2&r){const e=i.index,o=t.oxw();t.Q6J("formGroupName",e),t.xp6(6),t.Q6J("ngIf",o.products),t.xp6(5),t.Q6J("errorStateMatcher",o.matcher),t.xp6(5),t.Q6J("errorStateMatcher",o.matcher),t.xp6(5),t.Q6J("errorStateMatcher",o.matcher),t.xp6(2),t.Q6J("disabled",0==e)}}function W(r,i){1&r&&(t.ynx(0),t._UZ(1,"i",40),t.TgZ(2,"span",37),t._uU(3,"Loading..."),t.qZA(),t.BQk())}function $(r,i){1&r&&t._uU(0," Add Lso/Lpo ")}let tt=(()=>{class r{constructor(e,o,n,s){this.payFb=e,this.router=o,this.snakBar=n,this.payServ=s,this.matcher=new y.n,this.loading=!1,this.today=new Date,this.lsolpoForm=this.payFb.group({clisupid:["",l.kI.required],products:this.payFb.array([]),details:[""]})}ngOnInit(){this.loadProd(),this.loadSuppl(),this.addProduct(),this.lsolpoForm.valueChanges.subscribe(()=>{this.errorMessage=!1})}get getProducts(){return this.lsolpoForm.get("products")}addProduct(){const e=this.payFb.group({productid:["",l.kI.required],noitems:[0,l.kI.required],unitprice:[0,l.kI.required],totalamount:[0,l.kI.required]});this.getProducts.push(e)}delProduct(e){this.getProducts.removeAt(e)}loadProd(){this.payServ.getProducts({page:1,pageSize:10}).subscribe({next:e=>this.products=e.results,error:e=>this.errorHandle(e)})}loadSuppl(){this.payServ.getSuppliers({page:1,pageSize:10}).subscribe({next:e=>this.suppliers=e.results,error:e=>this.errorHandle(e)})}addPay(){this.loading=!0,this.payServ.addLpoLso(this.lsolpoForm.value).subscribe({next:o=>this.handleResp(o),error:o=>this.errorHandle(o)})}openSnakBar(e,o){this.snakBar.open(e,o,{duration:2500})}handleResp(e){this.loading=!1,this.openSnakBar(e.message,"Dismiss"),this.router.navigate(["/expense/lsolpo"])}errorHandle(e){this.loading=!1,this.errorMessage=e}unitKeyUp(e,o){var n,s;const a=parseInt(null===(n=this.getProducts.at(o).get("noitems"))||void 0===n?void 0:n.value);null===(s=this.getProducts.at(o).get("totalamount"))||void 0===s||s.setValue(e.value*a)}totlKeyup(e,o){var n,s;const a=parseInt(null===(n=this.getProducts.at(o).get("noitems"))||void 0===n?void 0:n.value)||1;null===(s=this.getProducts.at(o).get("unitprice"))||void 0===s||s.setValue(e.value/a)}noitmKeyUp(e,o){var n,s;const a=parseInt(null===(n=this.getProducts.at(o).get("unitprice"))||void 0===n?void 0:n.value);null===(s=this.getProducts.at(o).get("totalamount"))||void 0===s||s.setValue(e.value*a)}changeProduct(e){var o,n;const s=null===(o=this.getProducts.at(e).get("productid"))||void 0===o?void 0:o.value,a=this.products.find(u=>u.id==s);null===(n=this.getProducts.at(e).get("unitprice"))||void 0===n||n.setValue(a.defbuyprice)}}return r.\u0275fac=function(e){return new(e||r)(t.Y36(l.qu),t.Y36(g.F0),t.Y36(f.ux),t.Y36(_))},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-add-lsolpo"]],decls:29,vars:7,consts:[[1,"d-lg-flex","text-secondary","py-2"],[1,"flex-grow-1"],["type","button","routerLink","/expense/lsolpo",1,"btn","btn-outline-success","btn-sm"],["aria-hidden","true",1,"fa","fa-chevron-left"],[3,"formGroup"],["class","alert alert-danger my-3",4,"ngIf"],[1,"row","pb-4"],[1,"col-lg-12"],["formControlName","clisupid"],[4,"ngIf"],[1,"row"],["appearance","outline",1,"w-100"],["matInput","","formControlName","details"],["formArrayName","products"],[1,"pt-2","pb-1"],[1,"bg-secondary-light","py-2"],[3,"formGroupName",4,"ngFor","ngForOf"],[1,"text-end"],["type","button",1,"btn","btn-primary","my-2",3,"click"],[1,"fa","fa-plus"],["mat-flat-button","","color","primary","type","button",1,"me-3",3,"disabled","click"],[4,"ngIf","ngIfElse"],["notload",""],[1,"alert","alert-danger","my-3"],["value","","disabled",""],[4,"ngFor","ngForOf"],[3,"value"],[3,"formGroupName"],[1,"d-flex"],[1,"flex-grow-1","me-2"],[1,"col-lg-5","pt-1"],["formControlName","productid",3,"change"],[1,"col-lg-2"],["matInput","","placeholder","Enter No Of Items e.g. 50","formControlName","noitems",3,"errorStateMatcher","keyup"],["matInput","","placeholder","Enter Unit","formControlName","unitprice",3,"errorStateMatcher","keyup"],[1,"col-lg-3"],["matInput","","placeholder","Enter Total Amount","formControlName","totalamount",3,"errorStateMatcher","keyup"],[1,""],[1,"btn","btn-danger",3,"disabled","click"],[1,"fa","fa-trash"],[1,"fa","fa-spinner","fa-spin","fa-1x","me-2"]],template:function(e,o){if(1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"button",2),t._UZ(3,"i",3),t._uU(4," Back "),t.qZA()()(),t.TgZ(5,"form",4),t.YNc(6,j,2,1,"div",5),t.TgZ(7,"div",6)(8,"div",7)(9,"ng-select",8),t.YNc(10,V,4,1,"ng-container",9),t.qZA()()(),t.TgZ(11,"div",10)(12,"div",7)(13,"mat-form-field",11)(14,"mat-label"),t._uU(15,"Payment Description"),t.qZA(),t._UZ(16,"textarea",12),t.qZA()()(),t.TgZ(17,"div",13)(18,"div",14),t._uU(19," Add Products"),t.qZA(),t.TgZ(20,"div",15),t.YNc(21,X,25,6,"div",16),t.qZA(),t.TgZ(22,"div",17)(23,"button",18),t.NdJ("click",function(){return o.addProduct()}),t._UZ(24,"i",19),t.qZA()()(),t.TgZ(25,"button",20),t.NdJ("click",function(){return o.addPay()}),t.YNc(26,W,4,0,"ng-container",21),t.YNc(27,$,1,0,"ng-template",null,22,t.W1O),t.qZA()()),2&e){const n=t.MAs(28);t.xp6(5),t.Q6J("formGroup",o.lsolpoForm),t.xp6(1),t.Q6J("ngIf",o.errorMessage),t.xp6(4),t.Q6J("ngIf",o.suppliers),t.xp6(11),t.Q6J("ngForOf",o.getProducts.controls),t.xp6(4),t.Q6J("disabled",o.lsolpoForm.invalid||o.errorMessage||o.loading),t.xp6(1),t.Q6J("ngIf",o.loading)("ngIfElse",n)}},directives:[g.rH,l._Y,l.JL,l.sg,c.O5,m.w9,l.JJ,l.u,m.jq,c.sg,h.KE,h.hX,v.Nt,l.Fj,l.CE,l.x0,x.lW],styles:[".mat-form-field-flex>.mat-form-field-infix{padding:.5em 0!important}  .mat-form-field-label-wrapper{top:-1.4em}  .mat-form-field-appearance-outline.mat-form-field-can-float.mat-form-field-should-float .mat-form-field-label{transform:translateY(-1.1em) scale(.75);width:133.33333%}"]}),r})();var et=p(9744);const ot=[{path:"",component:k},{path:"add",component:tt},{path:"edit/:id",component:w},{path:"**",redirectTo:"",pathMatch:"full"}];let nt=(()=>{class r{}return r.\u0275fac=function(e){return new(e||r)},r.\u0275mod=t.oAB({type:r}),r.\u0275inj=t.cJS({imports:[[c.ez,D.K,l.UX,m.A0,l.u5,f.ZX,h.lN,K.LD,v.c,B.Ps,x.ot,Y.XK,H.FA,et.F,g.Bz.forChild(ot)]]}),r})()}}]);
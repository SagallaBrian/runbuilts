"use strict";(self.webpackChunkbiz_ke_frontend=self.webpackChunkbiz_ke_frontend||[]).push([[230],{8230:(et,y,i)=>{i.r(y),i.d(y,{VoucherModule:()=>tt});var c=i(9808),u=i(1083),l=i(3075),S=i(5906),t=i(5e3),x=i(7261),d=i(2340),U=i(520);let Z=(()=>{class a{constructor(e){this.http=e}addVoucher(e){return this.http.post(d.N.apiUrl+"lsolpopay/",e)}updateVoucher(e,o){return this.http.put(d.N.apiUrl+"lsolpopay/"+o,e)}delVoucher(e){return this.http.delete(d.N.apiUrl+"lsolpopay/"+e)}getVoucher(e){return this.http.get(d.N.apiUrl+"lsolpopay/"+e)}getVouchers(e){return this.http.get(d.N.apiUrl+"lsolpopay/",{params:e})}getSuppliers(e){return this.http.get(d.N.apiUrl+"supplier/",{params:e})}getProducts(e){return this.http.get(d.N.apiUrl+"product/",{params:e})}getLpoLsos(e){return this.http.get(d.N.apiUrl+"lsolpo/",{params:e})}}return a.\u0275fac=function(e){return new(e||a)(t.LFG(U.eN))},a.\u0275prov=t.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})();var f=i(4376),p=i(7322),A=i(7531),m=i(6856),V=i(7423);function L(a,r){if(1&a&&(t.TgZ(0,"div",25),t._uU(1),t.qZA()),2&a){const e=t.oxw();t.xp6(1),t.hij(" ",e.errorMessage," ")}}function F(a,r){if(1&a&&(t.ynx(0),t.TgZ(1,"ng-option",26),t._uU(2),t.ALo(3,"number"),t.qZA(),t.BQk()),2&a){const e=r.$implicit;t.xp6(1),t.Q6J("value",1*e[0].id),t.xp6(1),t.hij(" LSOLPO NO. ",t.xi3(3,2,e[0].id,"3.0-0")," ")}}function I(a,r){if(1&a&&(t.ynx(0),t.TgZ(1,"ng-option",15),t._uU(2,"Please Select LsoLpo To Pay"),t.qZA(),t.YNc(3,F,4,5,"ng-container",16),t.BQk()),2&a){const e=t.oxw();t.xp6(3),t.Q6J("ngForOf",e.lsolpos)}}function N(a,r){if(1&a&&(t.ynx(0),t.TgZ(1,"ng-option",26),t._uU(2),t.qZA(),t.BQk()),2&a){const e=r.$implicit;t.xp6(1),t.Q6J("value",1*e.value),t.xp6(1),t.hij(" ",e.name,"")}}function E(a,r){if(1&a){const e=t.EpF();t.ynx(0),t.TgZ(1,"button",27),t.NdJ("click",function(){return t.CHM(e),t.oxw().delVoucher()}),t._uU(2,"Delete"),t.qZA(),t.TgZ(3,"button",28),t.NdJ("click",function(){return t.CHM(e),t.oxw().editVoucher()}),t._uU(4,"Save Changes "),t.qZA(),t.BQk()}if(2&a){const e=t.oxw();t.xp6(1),t.Q6J("disabled",e.errorMessage||e.loading),t.xp6(2),t.Q6J("disabled",e.voucherForm.invalid||e.voucherForm.pristine)}}function J(a,r){1&a&&(t.ynx(0),t._UZ(1,"i",31),t.TgZ(2,"span",32),t._uU(3,"Loading..."),t.qZA(),t.BQk())}function M(a,r){1&a&&t._uU(0," Add Payment ")}function q(a,r){if(1&a){const e=t.EpF();t.TgZ(0,"button",29),t.NdJ("click",function(){return t.CHM(e),t.oxw().addVoucher()}),t.YNc(1,J,4,0,"ng-container",23),t.YNc(2,M,1,0,"ng-template",null,30,t.W1O),t.qZA()}if(2&a){const e=t.MAs(3),o=t.oxw();t.Q6J("disabled",o.voucherForm.invalid||o.errorMessage||o.loading),t.xp6(1),t.Q6J("ngIf",o.loading)("ngIfElse",e)}}let T=(()=>{class a{constructor(e,o,n,s,g){this.payFb=e,this.router=o,this.snakBar=n,this.payServ=s,this.route=g,this.matcher=new S.n,this.loading=!1,this.today=new Date,this.modeOfPay=[{name:"CASH",value:1},{name:"MPESA",value:2},{name:"PAYPAL",value:3},{name:"CHEQUE",value:4}],this.voucherForm=this.payFb.group({lsolponvcid:["",l.kI.required],totalamount:[0,l.kI.required],totalpaid:[0,l.kI.required],modeofpay:["",l.kI.required],transactioncode:["",l.kI.required],paymentdate:[this.today,l.kI.required],details:[""]})}ngOnInit(){this.loadLsoLpo(),this.voucherId=this.route.snapshot.paramMap.get("id"),this.voucherId&&this.loadVoucher(),this.voucherForm.valueChanges.subscribe(()=>{this.errorMessage=!1})}loadLsoLpo(){this.payServ.getLpoLsos({page:1,pageSize:10}).subscribe({next:e=>this.lsolpos=e.results,error:e=>this.errorHandle(e)})}loadVoucher(){this.loading=!0,this.payServ.getVoucher(this.voucherId).subscribe({next:e=>this.respPay(e),error:e=>this.errorHandle(e)})}addVoucher(){this.loading=!0;let e=this.voucherForm.value;e.paymentdate=(0,c.p6)(e.paymentdate,"yyyy-MM-dd","en-US"),this.payServ.addVoucher(e).subscribe({next:o=>this.handleResp(o),error:o=>this.errorHandle(o)})}editVoucher(){this.loading=!0;let e=this.voucherForm.value;e.paymentdate=(0,c.p6)(e.paymentdate,"yyyy-MM-dd","en-US"),this.payServ.updateVoucher(e,this.voucherId).subscribe({next:o=>this.handleResp(o),error:o=>this.errorHandle(o)})}delVoucher(){this.loading=!0,this.payServ.delVoucher(this.voucherId).subscribe({next:e=>this.handleResp(e),error:e=>this.errorHandle(e)})}openSnakBar(e,o){this.snakBar.open(e,o,{duration:2500})}respPay(e){this.loading=!1,this.voucherForm.patchValue({lsolponvcid:e.nvclsolpoid,totalamount:e.totalamount,modeofpay:e.modeofpay,transactioncode:e.transactioncode,paymentdate:e.paymentdate,details:e.details})}handleResp(e){this.loading=!1,this.openSnakBar(e.message,"Dismiss"),this.router.navigate(["/expense/voucher"])}handlCateg(e){this.suppliers=e.results}errorHandle(e){this.loading=!1,this.errorMessage=e}unitKeyUp(e){var o,n;const s=parseInt(null===(o=this.voucherForm.get("noitems"))||void 0===o?void 0:o.value);null===(n=this.voucherForm.get("totalamount"))||void 0===n||n.setValue(e.value*s)}totlKeyup(e){var o,n;const s=parseInt(null===(o=this.voucherForm.get("noitems"))||void 0===o?void 0:o.value)||1;null===(n=this.voucherForm.get("unitprice"))||void 0===n||n.setValue(e.value/s)}noitmKeyUp(e){var o,n;const s=parseInt(null===(o=this.voucherForm.get("unitprice"))||void 0===o?void 0:o.value);null===(n=this.voucherForm.get("totalamount"))||void 0===n||n.setValue(e.value*s)}changeLsoLpo(){var e,o,n;const s=null===(e=this.voucherForm.get("lsolponvcid"))||void 0===e?void 0:e.value;let g=[];for(let h=0;h<this.lsolpos.length;h++){const v=this.lsolpos[h];for(let _=0;_<v.length;_++)if(v[_].id==s){g=v;break}}let b=0,C=0;g.forEach(h=>{b+=h.totalamount,C+=h.nvclsopaidamount}),null===(o=this.voucherForm.get("totalamount"))||void 0===o||o.setValue(b),null===(n=this.voucherForm.get("totalpaid"))||void 0===n||n.setValue(C)}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(l.qu),t.Y36(u.F0),t.Y36(x.ux),t.Y36(Z),t.Y36(u.gz))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-add-edit-voucher"]],decls:45,vars:10,consts:[[1,"d-lg-flex","text-secondary","py-2"],[1,"flex-grow-1"],["type","button","routerLink","/expense/voucher",1,"btn","btn-outline-success","btn-sm"],["aria-hidden","true",1,"fa","fa-chevron-left"],[3,"formGroup"],["class","alert alert-danger my-3",4,"ngIf"],[1,"row","pb-4"],[1,"col-lg-12"],["formControlName","lsolponvcid",3,"change"],[4,"ngIf"],[1,"row"],["appearance","outline",1,"w-100"],["matInput","","placeholder","Enter Total Amount","formControlName","totalamount",3,"errorStateMatcher","keyup"],[1,"col-lg-12","pb-4"],["formControlName","modeofpay"],["value","","disabled",""],[4,"ngFor","ngForOf"],[1,"col-lg-6"],["matInput","","placeholder","Enter Transaction code","formControlName","transactioncode",3,"errorStateMatcher"],["matInput","","formControlName","paymentdate",3,"matDatepicker"],["matSuffix","",3,"for"],["paydateid",""],["matInput","","formControlName","details"],[4,"ngIf","ngIfElse"],["noVoucher",""],[1,"alert","alert-danger","my-3"],[3,"value"],["type","button","mat-flat-button","","color","warn",1,"me-2",3,"disabled","click"],["type","button","mat-flat-button","","color","primary",3,"disabled","click"],["mat-flat-button","","color","primary","type","button",1,"me-3",3,"disabled","click"],["notload",""],[1,"fa","fa-spinner","fa-spin","fa-1x","me-2"],[1,""]],template:function(e,o){if(1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"button",2),t._UZ(3,"i",3),t._uU(4," Back "),t.qZA()()(),t.TgZ(5,"form",4),t.YNc(6,L,2,1,"div",5),t.TgZ(7,"div",6)(8,"div",7)(9,"ng-select",8),t.NdJ("change",function(){return o.changeLsoLpo()}),t.YNc(10,I,4,1,"ng-container",9),t.qZA()()(),t.TgZ(11,"div",10)(12,"div",7)(13,"mat-form-field",11)(14,"mat-label"),t._uU(15,"Total Amount"),t.qZA(),t.TgZ(16,"input",12),t.NdJ("keyup",function(s){return o.totlKeyup(s.target)}),t.qZA()()()(),t.TgZ(17,"div",10)(18,"div",13)(19,"ng-select",14)(20,"ng-option",15),t._uU(21,"Select Mode OF Payment"),t.qZA(),t.YNc(22,N,3,2,"ng-container",16),t.qZA()(),t.TgZ(23,"div",17)(24,"mat-form-field",11)(25,"mat-label"),t._uU(26,"Transaction Code"),t.qZA(),t._UZ(27,"input",18),t.qZA()(),t.TgZ(28,"div",17)(29,"mat-form-field",11)(30,"mat-label"),t._uU(31,"Payment Date"),t.qZA(),t._UZ(32,"input",19)(33,"mat-datepicker-toggle",20)(34,"mat-datepicker",null,21),t.qZA()()(),t.TgZ(36,"div",10)(37,"div",7)(38,"mat-form-field",11)(39,"mat-label"),t._uU(40,"Payment Description"),t.qZA(),t._UZ(41,"textarea",22),t.qZA()()(),t.YNc(42,E,5,2,"ng-container",23),t.YNc(43,q,4,3,"ng-template",null,24,t.W1O),t.qZA()),2&e){const n=t.MAs(35),s=t.MAs(44);t.xp6(5),t.Q6J("formGroup",o.voucherForm),t.xp6(1),t.Q6J("ngIf",o.errorMessage),t.xp6(4),t.Q6J("ngIf",o.lsolpos),t.xp6(6),t.Q6J("errorStateMatcher",o.matcher),t.xp6(6),t.Q6J("ngForOf",o.modeOfPay),t.xp6(5),t.Q6J("errorStateMatcher",o.matcher),t.xp6(5),t.Q6J("matDatepicker",n),t.xp6(1),t.Q6J("for",n),t.xp6(9),t.Q6J("ngIf",o.voucherId)("ngIfElse",s)}},directives:[u.rH,l._Y,l.JL,l.sg,c.O5,f.w9,l.JJ,l.u,f.jq,c.sg,p.KE,p.hX,A.Nt,l.Fj,m.hl,m.nW,p.R9,m.Mq,V.lW],pipes:[c.JJ],styles:[".mat-form-field-flex>.mat-form-field-infix{padding:.5em 0!important}  .mat-form-field-label-wrapper{top:-1.4em}  .mat-form-field-appearance-outline.mat-form-field-can-float.mat-form-field-should-float .mat-form-field-label{transform:translateY(-1.1em) scale(.75);width:133.33333%}"]}),a})();var P=i(1990),O=i(4701),Q=i(2818);function k(a,r){if(1&a&&(t.TgZ(0,"div",5),t._uU(1),t.qZA()),2&a){const e=t.oxw();t.xp6(1),t.hij(" ",e.errorMessage," ")}}const Y=function(a){return["edit/",a]};function H(a,r){if(1&a&&(t.TgZ(0,"tr",12)(1,"td",13),t._uU(2),t.qZA(),t.TgZ(3,"td",13),t._uU(4),t.ALo(5,"number"),t.qZA(),t.TgZ(6,"td",13),t._uU(7),t.ALo(8,"modeofpay"),t.qZA(),t.TgZ(9,"td",13),t._uU(10),t.qZA(),t.TgZ(11,"td",13),t._uU(12),t.ALo(13,"currency"),t.qZA(),t.TgZ(14,"td",13),t._uU(15),t.ALo(16,"date"),t.qZA(),t.TgZ(17,"td",13),t._uU(18),t.qZA()()),2&a){const e=r.$implicit,o=r.index;t.Q6J("routerLink",t.VKq(18,Y,e.id)),t.xp6(2),t.Oqu(o+1),t.xp6(2),t.Oqu(t.xi3(5,8,e.nvclsolpoid,"3.0-0")),t.xp6(3),t.Oqu(t.lcZ(8,11,e.modeofpay)),t.xp6(3),t.Oqu(e.transactioncode),t.xp6(2),t.Oqu(t.xi3(13,13,e.totalamount,"Ksh. ")),t.xp6(3),t.Oqu(t.lcZ(16,16,e.paymentdate)),t.xp6(3),t.Oqu(e.details)}}function B(a,r){if(1&a){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",6)(2,"table",7)(3,"tbody")(4,"tr",8)(5,"th",9),t._uU(6,"#"),t.qZA(),t.TgZ(7,"th",9),t._uU(8,"LSOLPO No."),t.qZA(),t.TgZ(9,"th",9),t._uU(10,"Mode Of Payment"),t.qZA(),t.TgZ(11,"th",9),t._uU(12,"Transaction Code"),t.qZA(),t.TgZ(13,"th",9),t._uU(14,"Total Amount"),t.qZA(),t.TgZ(15,"th",9),t._uU(16,"Transaction Date"),t.qZA(),t.TgZ(17,"th",9),t._uU(18,"Description"),t.qZA()(),t.YNc(19,H,19,20,"tr",10),t.qZA()()(),t.TgZ(20,"app-paginator",11),t.NdJ("newItemEvent",function(n){return t.CHM(e),t.oxw().paginatedCall(n)}),t.qZA(),t.BQk()}if(2&a){const e=t.oxw();t.xp6(19),t.Q6J("ngForOf",e.vouchers),t.xp6(1),t.Q6J("datafromdb",e.paginator)}}function D(a,r){if(1&a&&(t.TgZ(0,"div",15),t._uU(1),t.qZA()),2&a){const e=t.oxw(2);t.xp6(1),t.hij(" ",e.loadmessage," ")}}function w(a,r){if(1&a&&t.YNc(0,D,2,1,"div",14),2&a){const e=t.oxw();t.Q6J("ngIf",e.loading)}}let z=(()=>{class a{constructor(e,o){this.payServ=e,this.router=o,this.loading=!0,this.loadmessage="loading ...",this.ifSearched=!1,this.paginator={page:1,pageSize:10},this.options=[{searchName:"Transaction Code",searchParam:"transactioncode"},{searchName:"Mode Of Payment",searchParam:"modeofpay"},{searchName:"Transaction Date",searchParam:"paymentdate"},{searchName:"Lso/Lpo Number ",searchParam:"nvclsolpoid"}],this.labels={listname:"Payment Voucher List",addBtname:"Add Voucher",searchPlaceholder:"Search Voucher"}}ngOnInit(){this.loadVouchers()}loadVouchers(){this.payServ.getVouchers(this.paginator).subscribe({next:e=>this.handleResp(e),error:e=>this.errorHandle(e)})}handleResp(e){this.loading=!1,this.vouchers=e.results,this.ifSearched||(this.voucherStore=e),this.setPaginator(e)}errorHandle(e){this.loading=!1,this.errorMessage=e}paginatedCall(e){this.ifSearched=!1,this.setPaginator(this.voucherStore),this.paginator.page=e.page,this.loadVouchers()}searchFunction(e){this.setPaginator(this.voucherStore),this.errorMessage=null,this.ifSearched=!0,this.vouchers=this.voucherStore.results,this.paginator[e.searchParam]=e.searchValue,this.vouchers=this.vouchers.filter(o=>{var n;let s=(null===(n=o[e.searchParam])||void 0===n?void 0:n.toString())||"";return new RegExp(e.searchValue,"i").test(s)}),0==this.vouchers.length&&(this.paginator.page=1,this.loading=!0,this.loadmessage="Performing a Wider Search",this.loadVouchers())}closeSearchFunction(){this.vouchers=this.voucherStore.results,this.errorMessage=null,this.setPaginator(this.voucherStore)}setPaginator(e){this.paginator={page:1,pageSize:10},this.paginator.page=e.currentPage,this.paginator.totalItems=e.totalItems,this.paginator.pageSize=e.pageSize}navigateAdd(){this.router.navigate(["/expense/voucher/add"])}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(Z),t.Y36(u.F0))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-list-vouchers"]],decls:6,vars:6,consts:[[1,"container-fluid","py-3"],[3,"labels","searchoptions","backenddata","searchEmit","closeEmit","navigateEmit"],["class","alert alert-danger my-3",4,"ngIf"],[4,"ngIf","ngIfElse"],["nodata",""],[1,"alert","alert-danger","my-3"],[1,"table-responsive"],[1,"table","table-striped","table-hover","table-bordered","text-nowrap"],[1,"blhead","rounded"],[1,"text-light"],["class","cursor",3,"routerLink",4,"ngFor","ngForOf"],[3,"datafromdb","newItemEvent"],[1,"cursor",3,"routerLink"],[1,"tpad"],["class","alert alert-warning text-danger my-3",4,"ngIf"],[1,"alert","alert-warning","text-danger","my-3"]],template:function(e,o){if(1&e&&(t.TgZ(0,"div",0)(1,"app-search-tab",1),t.NdJ("searchEmit",function(s){return o.searchFunction(s)})("closeEmit",function(){return o.closeSearchFunction()})("navigateEmit",function(){return o.navigateAdd()}),t.qZA(),t.YNc(2,k,2,1,"div",2),t.YNc(3,B,21,2,"ng-container",3),t.YNc(4,w,1,1,"ng-template",null,4,t.W1O),t.qZA()),2&e){const n=t.MAs(5);t.xp6(1),t.Q6J("labels",o.labels)("searchoptions",o.options)("backenddata",o.vouchers),t.xp6(1),t.Q6J("ngIf",o.errorMessage),t.xp6(1),t.Q6J("ngIf",o.vouchers&&!o.loading&&!o.errorMessage)("ngIfElse",n)}},directives:[P.O,c.O5,c.sg,u.rH,O.J],pipes:[c.JJ,Q.p,c.H9,c.uU],styles:[""]}),a})();var K=i(508),j=i(5245),R=i(4107),W=i(6186),X=i(4586),G=i(9744);const $=[{path:"",component:z},{path:"add",component:T},{path:"edit/:id",component:T},{path:"**",redirectTo:"",pathMatch:"full"}];let tt=(()=>{class a{}return a.\u0275fac=function(e){return new(e||a)},a.\u0275mod=t.oAB({type:a}),a.\u0275inj=t.cJS({imports:[[c.ez,W.K,l.UX,f.A0,l.u5,x.ZX,p.lN,R.LD,A.c,j.Ps,V.ot,K.XK,m.FA,X.D,G.F,u.Bz.forChild($)]]}),a})()}}]);
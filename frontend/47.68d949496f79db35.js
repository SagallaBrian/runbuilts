"use strict";(self.webpackChunksuluhi_admin_frontend=self.webpackChunksuluhi_admin_frontend||[]).push([[47],{4047:(W,Z,s)=>{s.r(Z),s.d(Z,{LoansModule:()=>K});var d=s(6895),u=s(8869),r=s(4006),f=s(4333),T=s(1213),h=s(8796),t=s(4650),x=s(2340),b=s(529);let v=(()=>{class e{constructor(n){this.http=n,this.apiUrl=`${x.N.apiUrl}loans`}createLoan(n){return this.http.post(this.apiUrl,n)}getLoan(n){return this.http.get(`${this.apiUrl}/${n}`)}updateLoan(n,o){return this.http.put(`${this.apiUrl}/${n}`,o)}deleteLoan(n){return this.http.delete(`${this.apiUrl}/${n}`)}getAllLoans(n,o,i){const l={currentPage:n,pageSize:o,...i};return this.http.get(this.apiUrl,{params:l})}}return e.\u0275fac=function(n){return new(n||e)(t.LFG(b.eN))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var C=s(583),A=s(8057);function q(e,a){if(1&e&&(t.ynx(0),t.TgZ(1,"div",25),t._UZ(2,"app-error-occured",26),t.qZA(),t.BQk()),2&e){const n=t.oxw();t.xp6(2),t.Q6J("errorMessage",n.errorMessage)}}function U(e,a){if(1&e&&(t.ynx(0),t.TgZ(1,"ng-option",30),t._uU(2),t.qZA(),t.BQk()),2&e){const n=a.$implicit;t.xp6(1),t.Q6J("value",n._id),t.xp6(1),t.AsE(" ",n.firstName," ",n.lastName," ")}}function I(e,a){if(1&e&&(t.ynx(0),t.TgZ(1,"ng-select",27)(2,"ng-option",28),t._uU(3,"Search Customer"),t.qZA(),t.YNc(4,U,3,3,"ng-container",29),t.qZA(),t.BQk()),2&e){const n=t.oxw();t.xp6(4),t.Q6J("ngForOf",n.clients.results)}}function y(e,a){1&e&&(t.TgZ(0,"div",31),t._uU(1," Customer is required. "),t.qZA())}function E(e,a){1&e&&(t.TgZ(0,"div",31),t._uU(1," Amount is required. "),t.qZA())}function F(e,a){1&e&&(t.TgZ(0,"div",31),t._uU(1," Phone Number is required. "),t.qZA())}function N(e,a){1&e&&(t.TgZ(0,"div",31),t._uU(1," Company Name is required. "),t.qZA())}function J(e,a){1&e&&(t.TgZ(0,"div",31),t._uU(1," Department is required. "),t.qZA())}function Q(e,a){1&e&&(t.TgZ(0,"div",31),t._uU(1," Description is required. "),t.qZA())}function D(e,a){if(1&e){const n=t.EpF();t.ynx(0),t.TgZ(1,"button",32),t.NdJ("click",function(){t.CHM(n);const i=t.oxw();return t.KtG(i.deleteLoan())}),t._uU(2,"Delete Loan"),t.qZA(),t.TgZ(3,"button",33),t.NdJ("click",function(){t.CHM(n);const i=t.oxw();return t.KtG(i.updateLoan())}),t._uU(4,"Edit Loan"),t.qZA(),t.BQk()}if(2&e){const n=t.oxw();t.xp6(1),t.Q6J("disabled",n.loanForm.invalid),t.xp6(2),t.Q6J("disabled",n.loanForm.invalid)}}function S(e,a){if(1&e){const n=t.EpF();t.TgZ(0,"button",34),t.NdJ("click",function(){t.CHM(n);const i=t.oxw();return t.KtG(i.addLoan())}),t._uU(1,"Add Loan"),t.qZA()}if(2&e){const n=t.oxw();t.Q6J("disabled",n.loanForm.invalid)}}let L=(()=>{class e{constructor(n,o,i,l,c){this.formBuilder=n,this.router=o,this.loanService=i,this.clientService=l,this.route=c,this.title="Add Loan",this.submiting=!1,this.loading=!1,this.loadingclients=!1}ngOnInit(){this.loadClients({}),this.loanForm=this.formBuilder.group({customerid:["",r.kI.required],amount:["",r.kI.required],interestRate:["",r.kI.required],startDate:[""],endDate:[""],loanstatus:["approved"],description:[""]}),this.loanId=this.route.snapshot.paramMap.get("id"),this.loanId&&(this.title="Edit Loans",this.getLoan(this.loanId))}getLoan(n){this.loading=!0,this.loanService.getLoan(n).subscribe({next:o=>{const i=new Date(o.startDate).toISOString().substring(0,10),l=new Date(o.endDate).toISOString().substring(0,10);o.startDate=i,o.endDate=l,this.loanForm.patchValue(o)},error:o=>{this.errorMessage=o,this.loading=!1},complete:()=>{this.loading=!1}})}addLoan(){this.loanForm.valid&&(this.submiting=!0,this.loanService.createLoan(this.loanForm.value).subscribe({next:o=>{this.loanForm.reset(),this.router.navigate(["/accounts/loans"])},error:o=>{this.errorMessage=o,this.submiting=!1},complete:()=>{this.submiting=!1}}))}updateLoan(){const n=this.loanForm.value;this.submiting=!0,this.loanService.updateLoan(this.loanId,n).subscribe({next:o=>{this.router.navigate(["/accounts/loans"])},error:o=>{this.errorMessage=o,this.submiting=!1},complete:()=>{this.submiting=!1}})}deleteLoan(){this.submiting=!0,this.loanService.deleteLoan(this.loanId).subscribe({next:n=>{this.router.navigate(["/accounts/loans"])},error:n=>{this.errorMessage=n,this.submiting=!1},complete:()=>{this.submiting=!1}})}loadClients(n){this.loadingclients=!0,this.clientService.getAllClientSuppliers(1,100,n).subscribe({next:o=>{this.clients=o},error:o=>{this.errorMessage=o,this.loadingclients=!1},complete:()=>{this.loadingclients=!1}})}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(r.qu),t.Y36(u.F0),t.Y36(v),t.Y36(C.y),t.Y36(u.gz))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-add-edit-loans"]],decls:60,vars:12,consts:[[4,"ngIf"],[1,"my-4",3,"formGroup"],[1,"d-flex"],[1,"flex-grow-1"],[1,"fw-normal"],["routerLink","/accounts/loans",1,"btn","btn-outline-secondary","btn-sm"],[1,"mb-3"],["class","invalid-feedback",4,"ngIf"],[1,"row"],[1,"col-lg-6"],["for","title",1,"form-label"],["type","number","id","title","formControlName","amount","placeholder","Enter Amount",1,"form-control"],["type","number","id","title","formControlName","interestRate","placeholder","Enter Interest Rate",1,"form-control"],["type","date","id","title","formControlName","startDate",1,"form-control"],["type","date","id","title","formControlName","endDate",1,"form-control"],["for","projectlink",1,"form-label"],["aria-label","Default select example","formControlName","loanstatus",1,"form-select"],["value","pending"],["value","approved"],["value","rejected"],["value","paid"],["for","description",1,"form-label"],["id","description","formControlName","description","placeholder","Enter Description",1,"form-control"],[4,"ngIf","ngIfElse"],["adding",""],[1,"py-3"],[3,"errorMessage"],["formControlName","customerid"],["value","","disabled",""],[4,"ngFor","ngForOf"],[3,"value"],[1,"invalid-feedback"],["type","submit",1,"btn","btn-danger","btn-sm","me-2",3,"disabled","click"],["type","submit",1,"btn","btn-primary","btn-sm",3,"disabled","click"],["type","submit",1,"btn","btn-success","btn-sm",3,"disabled","click"]],template:function(n,o){if(1&n&&(t.TgZ(0,"div"),t.YNc(1,q,3,1,"ng-container",0),t.TgZ(2,"form",1)(3,"div",2)(4,"div",3)(5,"h2",4),t._uU(6),t.qZA()(),t.TgZ(7,"div")(8,"button",5),t._uU(9," List Loans"),t.qZA()()(),t.TgZ(10,"div",6)(11,"div"),t.YNc(12,I,5,1,"ng-container",0),t.qZA(),t.YNc(13,y,2,0,"div",7),t.qZA(),t.TgZ(14,"div",8)(15,"div",9)(16,"div",6)(17,"label",10),t._uU(18,"Amount"),t.qZA(),t._UZ(19,"input",11),t.YNc(20,E,2,0,"div",7),t.qZA()(),t.TgZ(21,"div",9)(22,"div",6)(23,"label",10),t._uU(24,"Interest Rate"),t.qZA(),t._UZ(25,"input",12),t.YNc(26,F,2,0,"div",7),t.qZA()()(),t.TgZ(27,"div",8)(28,"div",9)(29,"div",6)(30,"label",10),t._uU(31,"Start Date"),t.qZA(),t._UZ(32,"input",13),t.YNc(33,N,2,0,"div",7),t.qZA()(),t.TgZ(34,"div",9)(35,"div",6)(36,"label",10),t._uU(37,"End Date"),t.qZA(),t._UZ(38,"input",14),t.YNc(39,J,2,0,"div",7),t.qZA()()(),t.TgZ(40,"div",6)(41,"label",15),t._uU(42,"Loan Status"),t.qZA(),t.TgZ(43,"select",16)(44,"option",17),t._uU(45,"Pending"),t.qZA(),t.TgZ(46,"option",18),t._uU(47,"Approved"),t.qZA(),t.TgZ(48,"option",19),t._uU(49,"Rejected"),t.qZA(),t.TgZ(50,"option",20),t._uU(51,"Paid"),t.qZA()()(),t.TgZ(52,"div",6)(53,"label",21),t._uU(54,"Description"),t.qZA(),t._UZ(55,"textarea",22),t.YNc(56,Q,2,0,"div",7),t.qZA(),t.YNc(57,D,5,2,"ng-container",23),t.YNc(58,S,2,1,"ng-template",null,24,t.W1O),t.qZA()()),2&n){const i=t.MAs(59);let l,c,p,m,g,_;t.xp6(1),t.Q6J("ngIf",o.errorMessage),t.xp6(1),t.Q6J("formGroup",o.loanForm),t.xp6(4),t.Oqu(o.title),t.xp6(6),t.Q6J("ngIf",o.clients&&o.clients.results.length),t.xp6(1),t.Q6J("ngIf",(null==(l=o.loanForm.get("customerid"))?null:l.invalid)&&(null==(l=o.loanForm.get("customerid"))?null:l.touched)),t.xp6(7),t.Q6J("ngIf",(null==(c=o.loanForm.get("amount"))?null:c.invalid)&&(null==(c=o.loanForm.get("amount"))?null:c.touched)),t.xp6(6),t.Q6J("ngIf",(null==(p=o.loanForm.get("interestRate"))?null:p.invalid)&&(null==(p=o.loanForm.get("interestRate"))?null:p.touched)),t.xp6(7),t.Q6J("ngIf",(null==(m=o.loanForm.get("startDate"))?null:m.invalid)&&(null==(m=o.loanForm.get("startDate"))?null:m.touched)),t.xp6(6),t.Q6J("ngIf",(null==(g=o.loanForm.get("endDate"))?null:g.invalid)&&(null==(g=o.loanForm.get("endDate"))?null:g.touched)),t.xp6(17),t.Q6J("ngIf",(null==(_=o.loanForm.get("description"))?null:_.invalid)&&(null==(_=o.loanForm.get("description"))?null:_.touched)),t.xp6(1),t.Q6J("ngIf",o.loanId)("ngIfElse",i)}},dependencies:[d.sg,d.O5,r._Y,r.YN,r.Kr,r.Fj,r.wV,r.EJ,r.JJ,r.JL,r.sg,r.u,A.A,h.w9,h.jq,u.rH]}),e})();var M=s(7997),Y=s(5511),k=s(295);function O(e,a){1&e&&(t.ynx(0),t.TgZ(1,"div",8),t._UZ(2,"app-sul-loader"),t.qZA(),t.BQk())}function B(e,a){if(1&e&&(t.ynx(0),t.TgZ(1,"div",8),t._UZ(2,"app-error-occured",10),t.qZA(),t.BQk()),2&e){const n=t.oxw(2);t.xp6(2),t.Q6J("errorMessage",n.errorMessage)}}const P=function(e){return["edit",e]};function w(e,a){if(1&e&&(t.ynx(0),t.TgZ(1,"tr",16)(2,"td"),t._uU(3),t.qZA(),t.TgZ(4,"td"),t._uU(5),t.ALo(6,"currency"),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.qZA(),t.TgZ(9,"td"),t._uU(10),t.ALo(11,"date"),t.qZA(),t.TgZ(12,"td"),t._uU(13),t.ALo(14,"date"),t.qZA(),t.TgZ(15,"td",17),t._uU(16),t.qZA()(),t.BQk()),2&e){const n=a.$implicit,o=a.index;t.xp6(1),t.Q6J("routerLink",t.VKq(14,P,n._id)),t.xp6(2),t.Oqu(o+1),t.xp6(2),t.Oqu(t.xi3(6,7,n.amount,"ksh. ")),t.xp6(3),t.hij("",n.interestRate,"% "),t.xp6(2),t.Oqu(t.lcZ(11,10,n.startDate)),t.xp6(3),t.Oqu(t.lcZ(14,12,n.endDate)),t.xp6(3),t.Oqu(n.loanstatus)}}const j=function(e,a,n){return{itemsPerPage:e,currentPage:a,totalItems:n}};function R(e,a){if(1&e){const n=t.EpF();t.ynx(0),t.TgZ(1,"table",12)(2,"thead")(3,"tr")(4,"th"),t._uU(5,"#"),t.qZA(),t.TgZ(6,"th"),t._uU(7,"Amount"),t.qZA(),t.TgZ(8,"th"),t._uU(9,"Interest Rate"),t.qZA(),t.TgZ(10,"th"),t._uU(11,"Issue Date"),t.qZA(),t.TgZ(12,"th"),t._uU(13,"Due Date"),t.qZA(),t.TgZ(14,"th"),t._uU(15,"Status"),t.qZA()()(),t.TgZ(16,"tbody"),t.YNc(17,w,17,16,"ng-container",13),t.ALo(18,"paginate"),t.qZA()(),t.TgZ(19,"div",14)(20,"pagination-controls",15),t.NdJ("pageChange",function(i){t.CHM(n);const l=t.oxw(3);return t.KtG(l.onPageChange(i))}),t.qZA()(),t.BQk()}if(2&e){const n=t.oxw(3);t.xp6(17),t.Q6J("ngForOf",t.xi3(18,1,n.loans.results,t.kEZ(4,j,n.loans.pageSize,n.currentPage,n.loans.totalItems)))}}function $(e,a){1&e&&t._UZ(0,"app-no-data-found",18),2&e&&t.Q6J("dataLabel","Task")}function z(e,a){if(1&e&&(t.YNc(0,R,21,8,"ng-container",6),t.YNc(1,$,1,1,"ng-template",null,11,t.W1O)),2&e){const n=t.MAs(2),o=t.oxw(2);t.Q6J("ngIf",o.loans&&o.loans.results.length)("ngIfElse",n)}}function G(e,a){if(1&e&&(t.YNc(0,B,3,1,"ng-container",6),t.YNc(1,z,3,2,"ng-template",null,9,t.W1O)),2&e){const n=t.MAs(2),o=t.oxw();t.Q6J("ngIf",o.errorMessage)("ngIfElse",n)}}const H=[{path:"",component:(()=>{class e{constructor(n){this.loanService=n,this.loading=!0,this.currentPage=1,this.pageSize=10,this.options=[{name:"Customer Title",formname:"title",type:"text"},{name:"Status",formname:"loanstatus",type:"select",selectoptions:[{val:"pending",name:"Pending"},{val:"approved",name:"Approved"},{val:"rejected",name:"Rejected"}]}]}ngOnInit(){this.loadTasks({})}loadTasks(n){this.loading=!0,this.loanService.getAllLoans(this.currentPage,this.pageSize,n).subscribe({next:o=>{this.loans=o},error:o=>{this.errorMessage=o,this.loading=!1},complete:()=>{this.loading=!1}})}searchFunction(n){this.loadTasks(n)}onPageChange(n){this.currentPage=n,this.loadTasks({})}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(v))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-list-loans"]],decls:13,vars:4,consts:[[1,"py-4"],[1,"d-flex"],[1,"flex-grow-1"],[1,"text-secondary","fw-normal","mb-1"],[3,"searchlabel","searchOptions","searchEmit"],["routerLink","/accounts/loans/add",1,"btn","btn-outline-primary","btn-sm"],[4,"ngIf","ngIfElse"],["loadedContent",""],[1,"py-3"],["noError",""],[3,"errorMessage"],["nodata",""],[1,"table","table-bordered","table-striped"],[4,"ngFor","ngForOf"],[1,"d-flex","justify-content-end"],[1,"my-pagination",3,"pageChange"],[1,"cursor-pointer",3,"routerLink"],[1,"text-capitalize"],[3,"dataLabel"]],template:function(n,o){if(1&n&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2",3),t._uU(4,"Loans"),t.qZA()(),t.ynx(5),t.TgZ(6,"app-search-tab",4),t.NdJ("searchEmit",function(l){return o.searchFunction(l)}),t.qZA(),t.BQk(),t.TgZ(7,"div")(8,"button",5),t._uU(9," Add Loan"),t.qZA()()(),t.YNc(10,O,3,0,"ng-container",6),t.YNc(11,G,3,2,"ng-template",null,7,t.W1O),t.qZA()),2&n){const i=t.MAs(12);t.xp6(6),t.Q6J("searchlabel","Search Loan")("searchOptions",o.options),t.xp6(4),t.Q6J("ngIf",o.loading)("ngIfElse",i)}},dependencies:[d.sg,d.O5,M.S,Y.i,A.A,k.O,f.LS,u.rH,d.H9,d.uU,f._s]}),e})()},{path:"add",component:L},{path:"edit/:id",component:L},{path:"**",redirectTo:"",pathMatch:"full"}];let K=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[d.ez,r.u5,r.UX,T.C,f.JX,h.A0,u.Bz.forChild(H)]}),e})()}}]);
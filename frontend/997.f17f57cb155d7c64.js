"use strict";(self.webpackChunkbiz_ke_frontend=self.webpackChunkbiz_ke_frontend||[]).push([[997],{3997:(z,h,a)=>{a.r(h),a.d(h,{CountiesModule:()=>B});var d=a(9808),s=a(3075),t=a(5e3),c=a(2340),v=a(520);let g=(()=>{class e{constructor(n){this.http=n}addCounty(n){return this.http.post(c.N.apiUrl+"county/",n)}updateCounty(n,o){return this.http.put(c.N.apiUrl+"county/"+o,n)}delCounty(n){return this.http.delete(c.N.apiUrl+"county/"+n)}getCounty(n){return this.http.get(c.N.apiUrl+"county/"+n)}getCounties(n){return this.http.get(c.N.apiUrl+"county/",{params:n})}}return e.\u0275fac=function(n){return new(n||e)(t.LFG(v.eN))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var l=a(1083),x=a(1990),b=a(4701);function Z(e,r){if(1&e&&(t.TgZ(0,"div",5),t._uU(1),t.qZA()),2&e){const n=t.oxw();t.xp6(1),t.hij(" ",n.errorMessage," ")}}const A=function(e){return["edit/",e]};function T(e,r){if(1&e&&(t.TgZ(0,"tr",13)(1,"td",14),t._uU(2),t.qZA(),t.TgZ(3,"td",14),t._uU(4),t.qZA(),t.TgZ(5,"td",14),t._uU(6),t.qZA(),t.TgZ(7,"td",14),t._uU(8),t.qZA()()),2&e){const n=r.$implicit,o=r.index;t.Q6J("routerLink",t.VKq(5,A,n.id)),t.xp6(2),t.Oqu(o+1),t.xp6(2),t.Oqu(n.code),t.xp6(2),t.Oqu(n.name),t.xp6(2),t.Oqu(n.hq)}}function I(e,r){if(1&e&&(t.ynx(0),t.YNc(1,T,9,7,"tr",12),t.BQk()),2&e){const n=t.oxw(2);t.xp6(1),t.Q6J("ngForOf",n.counties)}}function N(e,r){if(1&e){const n=t.EpF();t.ynx(0),t.TgZ(1,"div",6)(2,"table",7)(3,"tbody")(4,"tr",8)(5,"th",9),t._uU(6,"#"),t.qZA(),t.TgZ(7,"th",9),t._uU(8,"Code"),t.qZA(),t.TgZ(9,"th",9),t._uU(10,"Name"),t.qZA(),t.TgZ(11,"th",9),t._uU(12,"County Captal"),t.qZA()(),t.YNc(13,I,2,1,"ng-container",10),t.qZA()()(),t.TgZ(14,"app-paginator",11),t.NdJ("newItemEvent",function(i){return t.CHM(n),t.oxw().paginatedCall(i)}),t.qZA(),t.BQk()}if(2&e){const n=t.oxw();t.xp6(13),t.Q6J("ngIf",n.counties),t.xp6(1),t.Q6J("datafromdb",n.paginator)}}function F(e,r){if(1&e&&(t.TgZ(0,"div",16),t._uU(1),t.qZA()),2&e){const n=t.oxw(2);t.xp6(1),t.hij(" ",n.loadmessage," ")}}function q(e,r){if(1&e&&t.YNc(0,F,2,1,"div",15),2&e){const n=t.oxw();t.Q6J("ngIf",n.loading)}}let S=(()=>{class e{constructor(n,o){this.cserv=n,this.router=o,this.loading=!0,this.loadmessage="loading ...",this.ifSearched=!1,this.paginator={page:1,pageSize:10},this.options=[{searchName:"County Name",searchParam:"name"},{searchName:"Headquaters",searchParam:"hq"},{searchName:"County Code",searchParam:"code"}],this.labels={listname:"County List",addBtname:"Add County",searchPlaceholder:"Search County"}}ngOnInit(){this.loadCounties()}loadCounties(){this.cserv.getCounties(this.paginator).subscribe({next:this.respHandle.bind(this),error:this.errorHandle.bind(this)})}respHandle(n){this.loading=!1,this.counties=n.results,this.ifSearched||(this.countiestore=n),this.setPaginator(n)}errorHandle(n){this.loading=!1,this.errorMessage=n}paginatedCall(n){this.ifSearched=!1,this.setPaginator(this.countiestore),this.paginator.page=n.page,this.loadCounties()}searchFunction(n){this.setPaginator(this.countiestore),this.errorMessage=null,this.ifSearched=!0,this.counties=this.countiestore.results,this.paginator[n.searchParam]=n.searchValue,this.counties=this.counties.filter(o=>{var i;let u=(null===(i=o[n.searchParam])||void 0===i?void 0:i.toString())||"";return new RegExp(n.searchValue,"i").test(u)}),0==this.counties.length&&(this.paginator.page=1,this.loading=!0,this.loadmessage="Performing a Wider Search",this.loadCounties())}closeSearchFunction(){this.counties=this.countiestore.results,this.errorMessage=null,this.setPaginator(this.countiestore)}navigateAdd(){this.router.navigate(["/admin/counties/add"])}setPaginator(n){this.paginator={page:1,pageSize:10},this.paginator.page=n.currentPage,this.paginator.totalItems=n.totalItems,this.paginator.pageSize=n.pageSize}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(g),t.Y36(l.F0))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-list-county"]],decls:6,vars:6,consts:[[1,"container-fluid","py-3"],[3,"labels","searchoptions","backenddata","searchEmit","closeEmit","navigateEmit"],["class","alert alert-danger my-3",4,"ngIf"],[4,"ngIf","ngIfElse"],["nodata",""],[1,"alert","alert-danger","my-3"],[1,"table-responsive"],[1,"table","table-striped","table-hover","table-bordered","text-nowrap"],[1,"blhead","rounded"],[1,"text-light"],[4,"ngIf"],[3,"datafromdb","newItemEvent"],["class","cursor",3,"routerLink",4,"ngFor","ngForOf"],[1,"cursor",3,"routerLink"],[1,"tpad"],["class","alert alert-warning text-danger my-3",4,"ngIf"],[1,"alert","alert-warning","text-danger","my-3"]],template:function(n,o){if(1&n&&(t.TgZ(0,"div",0)(1,"app-search-tab",1),t.NdJ("searchEmit",function(u){return o.searchFunction(u)})("closeEmit",function(){return o.closeSearchFunction()})("navigateEmit",function(){return o.navigateAdd()}),t.qZA(),t.YNc(2,Z,2,1,"div",2),t.YNc(3,N,15,2,"ng-container",3),t.YNc(4,q,1,1,"ng-template",null,4,t.W1O),t.qZA()),2&n){const i=t.MAs(5);t.xp6(1),t.Q6J("labels",o.labels)("searchoptions",o.options)("backenddata",o.counties),t.xp6(1),t.Q6J("ngIf",o.errorMessage),t.xp6(1),t.Q6J("ngIf",o.counties&&!o.loading&&!o.errorMessage)("ngIfElse",i)}},directives:[x.O,d.O5,d.sg,l.rH,b.J],styles:[""]}),e})();var U=a(5906),f=a(7261),m=a(7322),y=a(7531),C=a(7423);function J(e,r){if(1&e&&(t.TgZ(0,"div",14),t._uU(1),t.qZA()),2&e){const n=t.oxw();t.xp6(1),t.hij(" ",n.errMessage," ")}}function M(e,r){if(1&e&&(t.TgZ(0,"mat-error"),t._uU(1),t.qZA()),2&e){const n=t.oxw();t.xp6(1),t.hij(" ",n.errorNameControl()," ")}}function E(e,r){if(1&e&&(t.TgZ(0,"mat-error"),t._uU(1),t.qZA()),2&e){const n=t.oxw();t.xp6(1),t.hij(" ",n.errorHqControl()," ")}}function Y(e,r){if(1&e){const n=t.EpF();t.ynx(0),t.TgZ(1,"button",15),t.NdJ("click",function(){return t.CHM(n),t.oxw().deleteCounty()}),t._uU(2,"Delete"),t.qZA(),t.TgZ(3,"button",16),t.NdJ("click",function(){return t.CHM(n),t.oxw().editCounty()}),t._uU(4,"Save Changes "),t.qZA(),t.BQk()}if(2&e){const n=t.oxw();t.xp6(1),t.Q6J("disabled",n.errMessage||n.loading),t.xp6(2),t.Q6J("disabled",n.countyForm.invalid||n.countyForm.pristine)}}function L(e,r){1&e&&(t.ynx(0),t._UZ(1,"i",19),t.TgZ(2,"span",20),t._uU(3,"Loading..."),t.qZA(),t.BQk())}function k(e,r){1&e&&t._uU(0," Add County ")}function Q(e,r){if(1&e){const n=t.EpF();t.TgZ(0,"button",17),t.NdJ("click",function(){return t.CHM(n),t.oxw().addCounty()}),t.YNc(1,L,4,0,"ng-container",12),t.YNc(2,k,1,0,"ng-template",null,18,t.W1O),t.qZA()}if(2&e){const n=t.MAs(3),o=t.oxw();t.Q6J("disabled",o.countyForm.invalid||o.errMessage||o.loading),t.xp6(1),t.Q6J("ngIf",o.loading)("ngIfElse",n)}}let _=(()=>{class e{constructor(n,o,i,u,p){this.countyFb=n,this.router=o,this.snakBar=i,this.contyServ=u,this.route=p,this.matcher=new U.n,this.loading=!1,this.countyForm=this.countyFb.group({code:["",[s.kI.required,s.kI.minLength(2)]],name:["",[s.kI.required,s.kI.minLength(2)]],hq:["",[s.kI.required,s.kI.minLength(2)]]}),this.title="Add County"}ngOnInit(){this.countyId=this.route.snapshot.paramMap.get("id"),this.countyId&&(this.title="Edit County",this.loadCounty()),this.countyForm.valueChanges.subscribe(()=>{this.errMessage=!1})}loadCounty(){this.loading=!0,this.contyServ.getCounty(this.countyId).subscribe(n=>{this.loading=!1,this.countyForm.patchValue({code:n.code,name:n.name,hq:n.hq})})}addCounty(){this.loading=!0,this.contyServ.addCounty(this.countyForm.value).subscribe({next:this.respHandle.bind(this),error:this.errorHandle.bind(this)})}editCounty(){this.loading=!0,this.contyServ.updateCounty(this.countyForm.value,this.countyId).subscribe({next:this.respHandle.bind(this),error:this.errorHandle.bind(this)})}deleteCounty(){this.loading=!0,this.contyServ.delCounty(this.countyId).subscribe({next:this.respHandle.bind(this),error:this.errorHandle.bind(this)})}respHandle(n){this.loading=!1,console.log(n),this.openSnakBar("County ******* Successfully","Dismiss"),this.router.navigate(["/admin/counties"])}errorHandle(n){this.errMessage=n,this.loading=!1}errorNameControl(){var n,o;return(null===(n=this.countyForm.get("name"))||void 0===n?void 0:n.hasError("required"))?"You must provide a value":(null===(o=this.countyForm.get("name"))||void 0===o?void 0:o.hasError("minlength"))?"You must provide atleast 2 characters":""}errorHqControl(){var n,o;return(null===(n=this.countyForm.get("hq"))||void 0===n?void 0:n.hasError("required"))?"You must provide a value":(null===(o=this.countyForm.get("hq"))||void 0===o?void 0:o.hasError("minlength"))?"You must provide atleast 2 characters":""}openSnakBar(n,o){this.snakBar.open(n,o,{duration:1e3})}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(s.qu),t.Y36(l.F0),t.Y36(f.ux),t.Y36(g),t.Y36(l.gz))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-add-county"]],decls:23,vars:8,consts:[[1,"d-lg-flex","text-secondary","py-2"],[1,"flex-grow-1"],["type","button","routerLink","/admin/counties",1,"btn","btn-outline-success","btn-sm"],["aria-hidden","true",1,"fa","fa-chevron-left"],["class","alert alert-danger my-3 py-2",4,"ngIf"],[3,"formGroup"],[1,"row"],[1,"col-lg-12"],["appearance","outline",1,"w-100"],["matInput","","placeholder","Enter County Name","formControlName","name",3,"errorStateMatcher"],[4,"ngIf"],["matInput","","placeholder","Enter County Capital","formControlName","hq",3,"errorStateMatcher"],[4,"ngIf","ngIfElse"],["noStore",""],[1,"alert","alert-danger","my-3","py-2"],["type","button","mat-flat-button","","color","warn",1,"me-2",3,"disabled","click"],["type","button","mat-flat-button","","color","primary",3,"disabled","click"],["mat-flat-button","","color","primary","type","button",1,"me-3",3,"disabled","click"],["notload",""],[1,"fa","fa-spinner","fa-spin","fa-1x","me-2"],[1,""]],template:function(n,o){if(1&n&&(t.TgZ(0,"div",0)(1,"div",1)(2,"button",2),t._UZ(3,"i",3),t._uU(4," Back "),t.qZA()()(),t.YNc(5,J,2,1,"div",4),t.TgZ(6,"form",5)(7,"div",6)(8,"div",7)(9,"mat-form-field",8)(10,"mat-label"),t._uU(11,"Name"),t.qZA(),t._UZ(12,"input",9),t.YNc(13,M,2,1,"mat-error",10),t.qZA()(),t.TgZ(14,"div",7)(15,"mat-form-field",8)(16,"mat-label"),t._uU(17,"County Capital"),t.qZA(),t._UZ(18,"input",11),t.YNc(19,E,2,1,"mat-error",10),t.qZA()()(),t.YNc(20,Y,5,2,"ng-container",12),t.YNc(21,Q,4,3,"ng-template",null,13,t.W1O),t.qZA()),2&n){const i=t.MAs(22);let u,p;t.xp6(5),t.Q6J("ngIf",o.errMessage),t.xp6(1),t.Q6J("formGroup",o.countyForm),t.xp6(6),t.Q6J("errorStateMatcher",o.matcher),t.xp6(1),t.Q6J("ngIf",null==(u=o.countyForm.get("name"))?null:u.invalid),t.xp6(5),t.Q6J("errorStateMatcher",o.matcher),t.xp6(1),t.Q6J("ngIf",null==(p=o.countyForm.get("hq"))?null:p.invalid),t.xp6(1),t.Q6J("ngIf",o.countyId)("ngIfElse",i)}},directives:[l.rH,d.O5,s._Y,s.JL,s.sg,m.KE,m.hX,y.Nt,s.Fj,s.JJ,s.u,m.TO,C.lW],styles:[".mat-form-field-flex>.mat-form-field-infix{padding:.5em 0!important}  .mat-form-field-label-wrapper{top:-1.4em}  .mat-form-field-appearance-outline.mat-form-field-can-float.mat-form-field-should-float .mat-form-field-label{transform:translateY(-1.1em) scale(.75);width:133.33333%}"]}),e})();var H=a(5245),w=a(4107),O=a(9744);const P=[{path:"",component:S},{path:"add",component:_},{path:"edit/:id",component:_}];let B=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[d.ez,s.UX,f.ZX,m.lN,w.LD,y.c,H.Ps,C.ot,O.F,l.Bz.forChild(P)]]}),e})()}}]);